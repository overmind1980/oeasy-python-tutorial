---
show: step
version: 1.0
enable_checker: true
---

# è®¾ç½®æ®µè½

## å›å¿†

- ä¸Šæ¬¡
	- ä» è®¾ç½®ä¸­æ–‡æ–‡æœ¬ å­—ä½“å¼€å§‹
	- è§‚å¯Ÿåˆ°äº† docxçš„ ç»“æ„
- docx 
	- æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªzipå‹ç¼©åŒ…
	- å¯ä»¥ è§£å‹å‡º ç›¸å…³æ–‡ä»¶å¤¹å’Œæ–‡ä»¶

| æ–‡ä»¶| ä½œç”¨ |
|---|---|	
|word/document.xml | æ–‡æ¡£å†…å®¹|
|word/styles.xml | è´Ÿè´£æ ·å¼ | 

- æˆ‘ä»¬
	- å¯ä»¥è§£å‹docx
	- ä¹Ÿå¯ä»¥ç¼–è¾‘xmlæ–‡ä»¶ 
		- ç„¶åå‹ç¼©è¿›å…¥docx
- ç›®å‰å­¦ä¹ åˆ°çš„æ ·å¼
	- éƒ½æ˜¯ ä»¥å­—ä½“ä¸ºåŸºç¡€çš„
- èƒ½å¦ æœ‰ä»¥æ®µè½ä¸ºåŸºç¡€çš„æ ·å¼ å‘¢ï¼Ÿ

### æ€è·¯

- æ®µè½æ ·å¼
	- åº”è¯¥ ç®—æ˜¯æ®µè½çš„ ä¸€ç§å±æ€§
	- æ®µè½ éƒ½æœ‰å•¥å±æ€§
	- å»æ¸¸ä¹åœºè¯•è¯•

```
from docx import Document
doc = Document()
paragraph = doc.add_paragraph("oeasy")
paragraph.
```

- è§‚å¯Ÿåˆ°æœ‰ä¸ª
	- alignment
	- å¯¹é½

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240330-1711771290160)

### æŸ¥è¯¢æ–‡æ¡£

- åœ¨æ–‡æ¡£æœç´¢alignment
	- https://python-docx.readthedocs.io/en/latest/dev/analysis/features/text/paragraph-format.html?highlight=alignment

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240330-1711771459350)

- å‘ç°alignmentçš„å€¼æ˜¯
	- WD_ALGIN_PARAGRAPH.RIGHT
- è¿™ä¸ªä¸œè¥¿æ€ä¹ˆæ¥çš„å‘¢ï¼Ÿ
	- ç»§ç»­æœç´¢

### å¯¹é½æ–¹å¼

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240330-1711771582394)

- https://python-docx.readthedocs.io/en/latest/api/enum/WdAlignParagraph.html?highlight=WD_ALIGN_PARAGRAPH#wd-paragraph-alignment

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240330-1711771850969)

- çœ‹èµ·æ¥æ˜¯ä¸€ä¸ª
	- enum
	- æšä¸¾ç±»å‹
	- å¯ä»¥éå† ç€ä¸ªæšä¸¾ç±»å‹å—ï¼Ÿ

### éå†enum

```python
for align in WD_ALIGN_PARAGRAPH:
    print(align)
```

- è¾“å‡ºå¯¹é½æ–¹å¼

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240330-1711771914213)

### å°è¯•ä½¿ç”¨

```
from docx import Document
from docx.enum.text import WD_ALIGN_PARAGRAPH

doc = Document()
paragraph = doc.add_paragraph("oeasy")
paragraph.alignment = WD_ALIGN_PARAGRAPH.CENTER
doc.save("oeasy.docx")
```

- ç»“æœ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240330-1711772159278)

- å®ç°å±…ä¸­å¯¹é½
- é™¤äº† å±…ä¸­å¯¹é½ ä¹‹å¤–çš„ 
	- æ®µå‰ã€æ®µå
	- æ®µå·¦ã€æ®µå³
	- è¡Œé—´è·å‘¢ï¼Ÿ

### è§‚å¯Ÿ

- åœ¨è½¯ä»¶ä¸­ 
	- æ‰¾åˆ° Paragraphå¯¹è¯æ¡†
	- æ‰¾åˆ°Indents & Spacingé€‰é¡¹å¡
	- å¯ä»¥è§‚å¯Ÿåˆ°

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240330-1711772371679)

- å„ç§æ®µè½ å±æ€§
	- æ®µå‰ã€æ®µå
	- æ®µå·¦ã€æ®µå³
	- è¡Œé—´è·å‘¢ï¼Ÿ

### å…·ä½“ä½ç½®

```
from docx import Document
doc = Document()
paragraph = doc.add_paragraph("oeasy")
paragraph.paragraph_format.
```

- æŸ¥çœ‹å¯¹è±¡å†…å®¹

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240330-1711772845653)

### è¡Œè·ç»†èŠ‚

- https://python-docx.readthedocs.io/en/latest/dev/analysis/features/text/paragraph-format.html?highlight=alignment

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240330-1711773065458)

- è¡Œå†…è·æœ‰ä¸¤ç§
	- ä¸€ç§æ˜¯ å…·ä½“çš„æ•°å€¼
	- å¦ä¸€ç§æ˜¯ è¡Œé«˜(æ–‡å­—å¤§å°) çš„å€æ•°

### å°è¯•è®¾ç½®

```
from docx import Document
from docx.enum.text import WD_ALIGN_PARAGRAPH

doc = Document()
paragraph = doc.add_paragraph("Line spacing can be specified either as a specific length or as a multiple of the line height (font size). Line spacing is specified by the combination of values in w:spacing/@w:line and w:spacing/@w:lineRule. The ParagraphFormat.line_spacing property determines which method to use based on whether the assigned value is an instance of Length.")
paragraph.paragraph_format.line_spacing = 2
print("line_spacing: ",paragraph.paragraph_format.line_spacing)
print("line_spacing_rule: ",paragraph.paragraph_format.line_spacing_rule)
doc.save("oeasy.docx")
```

- æ‰§è¡Œç»“æœ
	- è§„åˆ™ä¸º DOUBLE(2)
	- å¤šå€è¡Œè·

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240330-1711773393898)

- è§‚å¯Ÿæ•ˆæœ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240330-1711773417055)

### æ®µå‰å’Œæ®µå

- è§‚å¯Ÿ å±æ€§
	- æ®µå‰è· space_before
	- æ®µåè· space_after

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240330-1711773936682)

- å…·ä½“æ€ä¹ˆè®¾ç½®å‘¢ï¼Ÿ

### æ®µå‰æ®µåä»£ç 

```
from docx import Document
from docx.shared import Pt
from docx.enum.text import WD_ALIGN_PARAGRAPH

doc = Document()
paragraph1 = doc.add_paragraph("Line spacing can be specified either as a specific length or as a multiple of the line height (font size). Line spacing is specified by the combination of values in w:spacing/@w:line and w:spacing/@w:lineRule. The ParagraphFormat.line_spacing property determines which method to use based on whether the assigned value is an instance of Length.")
paragraph2 = doc.add_paragraph("Spacing between subsequent paragraphs is controlled by the paragraph spacing attributes. Spacing can be applied either before the paragraph, after it, or both. The concept is similar to that of padding or margin in CSS. WordprocessingML supports paragraph spacing specified as either a length value or as a multiple of the line height; however only a length value is supported via the Word UI. Inter-paragraph spacing â€œoverlapsâ€, such that the rendered spacing between two paragraphs is the maximum of the space after the first paragraph and the space before the second.")
paragraph1.paragraph_format.line_spacing = 1
paragraph1.paragraph_format.space_before = Pt(12)
paragraph1.paragraph_format.space_after = Pt(24)
paragraph2.paragraph_format.line_spacing = 1
paragraph2.paragraph_format.space_before = Pt(12)
paragraph2.paragraph_format.space_after = Pt(24)
doc.save("oeasy.docx")
```

- æ•ˆæœ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240330-1711786286459)

- ç¬¬ä¸€æ®µçš„æ®µå 
	- å’Œ ç¬¬äºŒæ®µ æ€ä¹ˆç›´æ¥æŒ¨ä¸Šäº†å‘¢ï¼Ÿ

### æ®µè½ä¸­çš„å¡Œé™·

- æ®µè½ä¸­çš„è·ç¦»
	- ä¼šäº§ç”Ÿ å¡Œé™·

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240330-1711786516673)
	
- ç¬¬ä¸€äºŒæ®µé—´çš„è·ç¦»	æ¯”è¾ƒ 
	- ç¬¬ä¸€æ®µ çš„æ®µå 
	- ç¬¬äºŒæ®µ çš„æ®µå‰
	- æ‰¾åˆ° å…¶ä¸­ è¾ƒå¤§è€…
	-  Pt(24)
-  æ®µå·¦ã€æ®µå³ æ˜¯å¦‚ä½•è®¾è®¡çš„å‘¢ï¼Ÿ

### æ‰¾åˆ° å±æ€§

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240330-1711786850061)

- å‡†å¤‡ç¼–å†™ä»£ç 

### æ®µè½å››å‘¨ä»£ç 

```python
from docx import Document
from docx.shared import Pt
from docx.enum.text import WD_ALIGN_PARAGRAPH

doc = Document()
paragraph1 = doc.add_paragraph("Line spacing can be specified either as a specific length or as a multiple of the line height (font size). Line spacing is specified by the combination of values in w:spacing/@w:line and w:spacing/@w:lineRule. The ParagraphFormat.line_spacing property determines which method to use based on whether the assigned value is an instance of Length.")
paragraph2 = doc.add_paragraph("Spacing between subsequent paragraphs is controlled by the paragraph spacing attributes. Spacing can be applied either before the paragraph, after it, or both. The concept is similar to that of padding or margin in CSS. WordprocessingML supports paragraph spacing specified as either a length value or as a multiple of the line height; however only a length value is supported via the Word UI. Inter-paragraph spacing â€œoverlapsâ€, such that the rendered spacing between two paragraphs is the maximum of the space after the first paragraph and the space before the second.")
paragraph1.paragraph_format.line_spacing = 1
paragraph1.paragraph_format.space_before = Pt(12)
paragraph1.paragraph_format.space_after = Pt(24)
paragraph1.paragraph_format.left_indent = Pt(36)
paragraph1.paragraph_format.right_indent = Pt(48)
doc.save("oeasy.docx")
```

- æ®µè½å››é¢éƒ½æœ‰äº†è·ç¦»

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240330-1711786919933)

- First line æŒ‡çš„æ˜¯
	- é¦–è¡Œç¼©è¿›å—ï¼Ÿ

### åŠ¨æ‰‹è¯•è¯•

- è®¾ç½® 
	- é¦–è¡Œç¼©è¿›
	- First Line Indent
	- ä¸¤å­—ç¬¦(2ch)

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240330-1711787051158)

- è¿™ä¸ªæ•°å€¼ è¯»å‡ºæ¥ä¼šæ˜¯å¤šå°‘å‘¢ï¼Ÿ

### è¯»å– é¦–è¡Œç¼©è¿›

```
from docx import Document
from docx.shared import Pt
doc = Document("oeasy.docx")
paragraph = doc.paragraphs[0]
print(paragraph.paragraph_format.first_line_indent)
```

- è¯»å–åˆ° 2å­—ç¬¦ å¤§æ¦‚å¯¹åº” Pt(21)

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240330-1711788189487)

- å¦‚æœæƒ³è¦ç”¨ç¨‹åºè®¾ç½®å‘¢ï¼Ÿ

### æ‚¬æŒ‚ç¼©è¿›2å­—ç¬¦

```
from docx import Document
from docx.shared import Pt
from docx.enum.text import WD_ALIGN_PARAGRAPH

doc = Document()
paragraph1 = doc.add_paragraph("Line spacing can be specified either as a specific length or as a multiple of the line height (font size). Line spacing is specified by the combination of values in w:spacing/@w:line and w:spacing/@w:lineRule. The ParagraphFormat.line_spacing property determines which method to use based on whether the assigned value is an instance of Length.")
paragraph2 = doc.add_paragraph("Spacing between subsequent paragraphs is controlled by the paragraph spacing attributes. Spacing can be applied either before the paragraph, after it, or both. The concept is similar to that of padding or margin in CSS. WordprocessingML supports paragraph spacing specified as either a length value or as a multiple of the line height; however only a length value is supported via the Word UI. Inter-paragraph spacing â€œoverlapsâ€, such that the rendered spacing between two paragraphs is the maximum of the space after the first paragraph and the space before the second.")
paragraph1.paragraph_format.line_spacing = 1
paragraph1.paragraph_format.space_before = Pt(12)
paragraph1.paragraph_format.space_after = Pt(24)
paragraph1.paragraph_format.left_indent = Pt(36)
paragraph1.paragraph_format.right_indent = Pt(48)
paragraph1.paragraph_format.first_line_indent = Pt(-21)
doc.save("oeasy.docx")
```

- æ‚¬æŒ‚ç¼©è¿› 2å­—ç¬¦

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240330-1711788241306)

- é¦–è¡Œç¼©è¿› ä»€ä¹ˆæ—¶å€™å¼€å§‹æœ‰çš„å‘¢ï¼Ÿ

### å¤ä»£çš„é¦–è¡Œç¼©è¿›

- å¤ä»£ç®€ç‰å¹´ä»£
	- ä¸ºå¾ˆæ—©çš„é¦–è¡Œç¼©è¿›
	- æ§åˆ¶ æ–‡ç« çš„é˜…è¯»ä¹ æƒ¯
- ä»Šå¤©çš„ python
	- éœ€è¦ç¼©è¿›
	- æ§åˆ¶é€»è¾‘å€Ÿå£

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240307-1709776333746)


- è¿˜æœ‰ä¸€äº›å±æ€§æ˜¯å¹²ä»€ä¹ˆç”¨çš„å‘¢ï¼Ÿ

### æ®µè½æ§åˆ¶

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240330-1711788515398)

- æ®µè½æ§åˆ¶

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240330-1711788529048)

- è¿™äº›å¯ä»¥è®¾ç½®ä¸ºæ®µè½çš„æ ·å¼å—ï¼Ÿ

### æ®µè½æ ·å¼

```
from docx import Document
from docx.shared import Pt
from docx.enum.text import WD_ALIGN_PARAGRAPH
from docx.enum.style import WD_STYLE_TYPE
doc = Document()
paragraph1 = doc.add_paragraph("Line spacing can be specified either as a specific length or as a multiple of the line height (font size). Line spacing is specified by the combination of values in w:spacing/@w:line and w:spacing/@w:lineRule. The ParagraphFormat.line_spacing property determines which method to use based on whether the assigned value is an instance of Length.")
paragraph2 = doc.add_paragraph("Spacing between subsequent paragraphs is controlled by the paragraph spacing attributes. Spacing can be applied either before the paragraph, after it, or both. The concept is similar to that of padding or margin in CSS. WordprocessingML supports paragraph spacing specified as either a length value or as a multiple of the line height; however only a length value is supported via the Word UI. Inter-paragraph spacing â€œoverlapsâ€, such that the rendered spacing between two paragraphs is the maximum of the space after the first paragraph and the space before the second.")
styles = doc.styles
style = styles.add_style('oeasyp', WD_STYLE_TYPE.PARAGRAPH)
style.paragraph_format.line_spacing = 1
style.paragraph_format.space_before = Pt(12)
style.paragraph_format.space_after = Pt(24)
style.paragraph_format.left_indent = Pt(36)
style.paragraph_format.right_indent = Pt(48)
style.paragraph_format.first_line_indent = Pt(21)
paragraph1.style = style
paragraph2.style = style
doc.save("oeasy.docx")
```

- æ‰“å¼€æ•ˆæœ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240330-1711788990685)

- ä¸¤ä¸ªæ®µè½
	- ç¡®å® éƒ½å·²ç» 
	- æŒ‰ç…§oeasypæ ·å¼è®¾ç½®äº†

- å¦‚æœåŒæ—¶æœ‰
	- æ®µè½æ ¼å¼
	- æ®µè½æ ·å¼
	- ä¼šå¦‚ä½•å‘¢ï¼Ÿ

### æ®µè½æ ¼å¼ä¸æ ·å¼

```
from docx import Document
from docx.shared import Pt
from docx.enum.text import WD_ALIGN_PARAGRAPH
from docx.enum.style import WD_STYLE_TYPE
doc = Document()
paragraph1 = doc.add_paragraph("Line spacing can be specified either as a specific length or as a multiple of the line height (font size). Line spacing is specified by the combination of values in w:spacing/@w:line and w:spacing/@w:lineRule. The ParagraphFormat.line_spacing property determines which method to use based on whether the assigned value is an instance of Length.")
paragraph2 = doc.add_paragraph("Spacing between subsequent paragraphs is controlled by the paragraph spacing attributes. Spacing can be applied either before the paragraph, after it, or both. The concept is similar to that of padding or margin in CSS. WordprocessingML supports paragraph spacing specified as either a length value or as a multiple of the line height; however only a length value is supported via the Word UI. Inter-paragraph spacing â€œoverlapsâ€, such that the rendered spacing between two paragraphs is the maximum of the space after the first paragraph and the space before the second.")
styles = doc.styles
style = styles.add_style('oeasyp', WD_STYLE_TYPE.PARAGRAPH)
style.paragraph_format.line_spacing = 1
style.paragraph_format.space_before = Pt(12)
style.paragraph_format.space_after = Pt(24)
style.paragraph_format.left_indent = Pt(36)
style.paragraph_format.right_indent = Pt(48)
style.paragraph_format.first_line_indent = Pt(21)
paragraph1.style = style
paragraph1.paragraph_format.left_indent = Pt(0)
paragraph2.style = style
doc.save("oeasy.docx")
```

- å’Œ æ–‡å­—æ ¼å¼æ ·å¼ä¸€æ ·
	- æ®µè½ æ ¼å¼ ä¼š
	- è¦†ç›– æ®µè½æ ·å¼

- æƒ³è§£å‹åçœ‹çœ‹
	- document.xml
	- style.xml 
	- å¯ä»¥å—ï¼Ÿ

### æŸ¥çœ‹æ•ˆæœ

```
yes | unzip -d oeasyp oeasy.docx
cd oeasyp/word
firefox styles.xml document.xml
```

- æŸ¥çœ‹æ•ˆæœ
	- ç¡®å®æ–°å»ºäº† oeasyp è¿™ä¸ªstyle

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240330-1711789347394)

- style ä¸­åŒ…å«
	- æ®µå‰æ®µå
	- æ®µå·¦æ®µå³
	- é¦–è¡Œç¼©è¿›
	- è¡Œé«˜

### æŸ¥çœ‹æ–‡æ¡£

- ä¸¤æ®µè½ ç¡®å®åº”ç”¨äº†
	- oeasypæ ·å¼
- ç¬¬ä¸€æ®µä¸­ è®¾ç½®äº† 
	- æ®µè½ æ ¼å¼
	- æ®µå·¦è·ç¦»ä¸º0
- æ®µè½ å’Œ æ–‡å­—ä¸€æ ·
	- å…·ä½“æ ¼å¼ ä¼šè¦†ç›–
	- æ ·å¼ 

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240330-1711802919287)

- æ–‡æ¡£æœ€åçš„ä¸œè¥¿æ˜¯ä»€ä¹ˆï¼Ÿ
	- å¥½åƒä¹Ÿæ˜¯ä¸ªä¸Šä¸‹å·¦å³

## æ€»ç»“ğŸ¤”

- è¿™æ¬¡æˆ‘ä»¬äº†è§£äº†
	- æ®µè½çš„æ ¼å¼å’Œæ ·å¼
- æ®µè½çš„æ ¼å¼ å±æ€§
	- æ®µå‰ æ®µå 
	- æ®µå·¦ æ®µå³
	- è¡Œé—´è·
	- é¦–è¡Œç¼©è¿›
	- ...
- æ®µè½çš„æ ¼å¼ ä¼šè¦†ç›– æ®µè½çš„æ ·å¼
- document.xmlä¸­æœ€åçš„ä¸œè¥¿ æ˜¯ä»€ä¹ˆï¼Ÿ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240330-1711803426264)

- å¥½åƒ å’Œçº¸å¼ æœ‰å…³
	- å…·ä½“æ€ä¹ˆç©çš„å‘¢ï¼Ÿ
- æˆ‘ä»¬ä¸‹æ¬¡å†è¯´ï¼ğŸ‘‹ğŸ»