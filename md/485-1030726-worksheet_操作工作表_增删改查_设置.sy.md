---
show: step
version: 1.0
enable_checker: true
---

#  åŸºç¡€å·¥ä½œæµ_workflow_è¯»å†™å•å…ƒæ ¼ 

## å›å¿†

- ä¸Šæ¬¡ç ”ç©¶äº†
	- excelæ–‡ä»¶çš„å»ºç«‹
	- ä¹Ÿå°±æ˜¯excel å·¥ä½œç°¿çš„ç®€å†
- æ˜ç¡®äº†excelæ–‡ä»¶çš„ç»“æ„
	- æ•´ä½“çš„excelæ˜¯ä¸€ä¸ªå·¥ä½œç°¿
		- workbook
	- å·¥ä½œç°¿ä¸­æœ‰ä¸€ä¸ªä¸ªçš„å·¥ä½œè¡¨
		- worksheet

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230713-1689241445262)

- å¯ä»¥é€šè¿‡ä»£ç çš„æ–¹å¼
	- å¯¹å·¥ä½œè¡¨è¿›è¡Œå¢åˆ æ”¹çš„æ“ä½œå—ï¼Ÿ
- å…ˆçœ‹çœ‹ åœ¨è½¯ä»¶(calcä¸­) å¦‚æœæ“ä½œå·¥ä½œè¡¨

### å·¥ä½œè¡¨æ”¹å

- åŒå‡»å·¥ä½œè¡¨åç§°å¯ä»¥ä¿®æ”¹

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230809-1691547570393)

- å¯ä»¥å°†å·¥ä½œè¡¨åç§°
	- ä¿®æ”¹ä¸º æ˜¥

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230809-1691547645873)

- å¦‚ä½• åˆ›å»ºå·¥ä½œè¡¨å‘¢ï¼Ÿ

### åˆ›å»º å·¥ä½œè¡¨

- åœ¨ `æ˜¥`è¿™ä¸ªå·¥ä½œè¡¨æ ‡ç­¾çš„ä½ç½® 
	- å³é”® å¼¹å‡º ä¸Šä¸‹æ–‡èœå•

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230809-1691547723822)

- ç‚¹å‡» Insert Sheet 
	- æ’å…¥å·¥ä½œè¡¨

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230809-1691547784698)

- ä¿®æ”¹å·¥ä½œè¡¨åç§°
	- å¹¶ç‚¹å‡» OK

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230809-1691547838412)

- ä½†æ˜¯æ¬¡åºæœ‰é—®é¢˜

### è°ƒæ•´å·¥ä½œè¡¨ä½ç½®

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230809-1691547838412)

- æŒ‰ä½ å¤æ ‡ç­¾ 
	- å¹¶ä¸” å‘å³æ‹–åŠ¨
		- åœ¨ æ˜¥æ ‡ç­¾ çš„å³è¾¹ æ¾æ‰‹

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230809-1691547965169)

- å®Œæˆè°ƒæ•´ä½ç½®æ“ä½œ

### æ‹·è´ å·¥ä½œè¡¨

- å³é”®å•å‡» å¤æ ‡ç­¾
	- ç‚¹å‡» Move or Copy Sheet
	- ç§»åŠ¨æˆ–æ‹·è´ å·¥ä½œè¡¨

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230809-1691548071883)

- æ‰€æœ‰ å’Œå·¥ä½œè¡¨ç›¸å…³çš„ æ“ä½œ
	- éƒ½åœ¨å³é”®çš„ ä¸Šä¸‹æ–‡ èœå•ä¸­
		- åŒ…æ‹¬ 
			- åˆ é™¤ 
			- éšè—
			- ä¿æŠ¤
			- ...

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230809-1691548376249)

- è®¾ç½®å¥½ä¹‹åç‚¹å‡»ok

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230809-1691548457425)

- æˆåŠŸå»ºç«‹æ–°å·¥ä½œè¡¨

### å†åˆ›å»ºå·¥ä½œè¡¨

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230809-1691548646590)

- ç‚¹å‡»å·¥ä½œç°¿å‰é¢çš„åŠ å·

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230809-1691548670013)

- ç›´æ¥æ·»åŠ äº†æ–°å·¥ä½œè¡¨
	- sheet4
- åŒå‡» sheet4 æ ‡ç­¾

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230809-1691548705187)

- ä¿®æ”¹ å·¥ä½œè¡¨åç§° 
	- ä¸º å†¬

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230809-1691548751049)

- å¯ä»¥è®¾ç½® å·¥ä½œè¡¨æ ‡ç­¾ çš„é¢œè‰² å—ï¼Ÿ

### è®¾ç½® å·¥ä½œè¡¨ æ ‡ç­¾é¢œè‰²

- æ‰€æœ‰ å’Œå·¥ä½œè¡¨ç›¸å…³çš„ æ“ä½œ
	- éƒ½åœ¨å³é”®çš„ ä¸Šä¸‹æ–‡ èœå•ä¸­
		- å°±åœ¨ å…¶ä¸­æ‰¾ å·¥ä½œè¡¨é¢œè‰²
		
![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230809-1691548815286)

- å³é”®å•å‡» æ˜¥æ ‡ç­¾é¡µ
	- å¼¹å‡º ä¸Šä¸‹æ–‡èœå• 
		- ç‚¹å‡» tab color 
			- è®¾ç½® æ ‡ç­¾é¡µé¢œè‰²

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230809-1691548892502)

- é€‰æ‹©Greenç»¿è‰²
	- å¹¶ç‚¹å‡» OK

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230809-1691548927399)

- è®¾ç½®äº† æ˜¥æ ‡ç­¾çš„é¢œè‰²

### æ›´å¤šæ ‡ç­¾é¢œè‰²

- ä¾æ¬¡è®¾ç½®å…¶ä»–æ ‡ç­¾é¡µé¢œè‰²

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230809-1691548997666)

- å¯ä»¥é€šè¿‡ pythonä»£ç 
	- å®ç° ä»¥ä¸Šçš„åŠŸèƒ½å—ï¼Ÿ

### æœç´¢ çº¿ç´¢

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230809-1691550662961)

- ç‚¹å‡» é“¾æ¥

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230809-1691550719897)

- ä½¿ç”¨
	- ws1 = wb.create_sheet("Mysheet")
- å…¶ä¸­
	- wb æ˜¯ Workbook
	- ws1 æ˜¯ Worksheet

### å†æœç´¢

- å†åœ¨openxylä¸­ æœç´¢create_sheet
	- https://openpyxl.readthedocs.io/en/stable/search.html?q=create_sheet&check_keywords=yes&area=default

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230809-1691550896824)

- è¿™æ˜¯workbook æ¨¡å—ä¸­çš„
	- ä¸€ä¸ªå‡½æ•°
- å·¥ä½œè¡¨ æ˜¯ç”± 
	- å·¥ä½œç°¿å¯¹è±¡ æ¥åˆ›å»ºçš„

### æ·±å…¥ç ”ç©¶

- å·¥ä½œç°¿åŒ…(workbook package)ä¸­çš„
	- å·¥ä½œç°¿æ¨¡å—(workbook module) 

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230809-1691551057062)

- é‡Œé¢å…·ä½“éƒ½æœ‰ä»€ä¹ˆå‘¢ï¼Ÿ

### æœç´¢

- åœ¨æ­¤é¡µé¢ä¸­æœç´¢
	- _sheet

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230809-1691551365380)

- æ‰¾åˆ°ä¸¤ä¸ªå‡½æ•°
	- éƒ½æ˜¯å’Œå·¥ä½œè¡¨åç›¸å…³çš„
		1. é€šè¿‡è¡¨åå¾—åˆ°å·¥ä½œè¡¨
			- ä¸æ¨èä½¿ç”¨
				- ws_spring = wb.get_sheet_by_name("æ˜¥")
			- æ¨èä½¿ç”¨ä¸‹æ ‡æ–¹å¼
				- ws_spring = wb["æ˜¥"]
		2. å¾—åˆ°æ‰€æœ‰è¡¨ååˆ—è¡¨
			- ä¸æ¨èä½¿ç”¨
				- l_names = wb.get_sheet_names()
			- æ¨èä½¿ç”¨
				- l_names = wb.sheetnames 

### ç§»åŠ¨å’Œåˆ é™¤

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230809-1691551727424)

- ç§»åŠ¨æŸä¸ªå·¥ä½œæŠ¥è¡¨çš„ä½ç½®

```
#å‘å‰ç§»åŠ¨ä¸€ä¸ªä½ç½®ï¼Œæ­£æ•°å¾€åï¼Œè´Ÿæ•°å¾€å‰
wb.move_sheet("my_sheet111", -1)
#è§‚å¯Ÿç»“æœ
print(wb.sheetnames)
```

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230809-1691551776594)

- ä»å·¥ä½œç°¿åˆ é™¤å·¥ä½œè¡¨

### å†™ä»£ç 

```
from openpyxl import Workbook
wb = Workbook()
ws = wb.create_sheet("æ˜¥")
wb.save("test.xlsx")
```

- ä¿å­˜å¹¶è¿è¡Œ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230809-1691553197088)

### æ£€æŸ¥ç»“æœ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230809-1691553185351)

- æ‰“å¼€æ–‡ä»¶

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230809-1691553256551)

- ç¡®å®å‡ºç°äº†

### å°è¯•åˆ é™¤
```
from openpyxl import Workbook
wb = Workbook()
ws = wb["Sheet"]
wb.remove(ws)
ws = wb.create_sheet("æ˜¥")
wb.save("test.xlsx")
```

- reload

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230809-1691553777300)

- åˆ é™¤æˆåŠŸ

### ç»§ç»­æ·»åŠ 

- æ·»åŠ  å¤ã€ç§‹ ä¸¤ä¸ªå·¥ä½œè¡¨

```
from openpyxl import Workbook
wb = Workbook()
ws = wb["Sheet"]
wb.remove(ws)
ws1 = wb.create_sheet("æ˜¥")
ws2 = wb.create_sheet("å¤")
ws3 = wb.create_sheet("ç§‹")
wb.save("test.xlsx")
```

- æ‰§è¡Œç»“æœ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230809-1691554705784)

### å·¥ä½œè¡¨ å¤åˆ¶ æ”¹å

1. å°† æ˜¥æ ‡ç­¾ å¤åˆ¶
2. å°†å¤åˆ¶æ ‡ç­¾æ”¹å ä¸º å†¬æ ‡ç­¾

```
from openpyxl import Workbook
wb = Workbook()
ws = wb["Sheet"]
wb.remove(ws)
ws1 = wb.create_sheet("æ˜¥")
ws2 = wb.create_sheet("å¤")
ws3 = wb.create_sheet("ç§‹")
ws_spring = wb["æ˜¥"]
ws_winter = wb.copy_worksheet(ws_spring)
ws_winter.title = "å†¬"
wb.save("test.xlsx")
```

- è¿è¡Œç»“æœ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230809-1691554989801)

## æ€»ç»“
- è¿™ä¸€æ¬¡ä½¿ç”¨openpyxlæ“ä½œäº†å·¥ä½œè¡¨
	- æ‰¾åˆ°æ‰€æœ‰å·¥ä½œè¡¨åå­— 
		- wb.sheetnames
	- é€šè¿‡åå­—æ‰¾åˆ°å·¥ä½œè¡¨ 
		- wb["æ˜¥"]
	- åˆ é™¤å·¥ä½œè¡¨ 
		- wb.remove(ws)
	- ç§»åŠ¨å·¥ä½œè¡¨ä½ç½® 
		- b.move_sheet("æ˜¥", -1) 
	- å¤åˆ¶å·¥ä½œè¡¨
		- cp_sheet = wb.copy_worksheet(ws1)
	- å·¥ä½œè¡¨æ”¹å 
		- ws1.title = "å†¬"

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230809-1691553911873)


- å¯ä»¥ä¿®æ”¹ å·¥ä½œè¡¨æ ‡ç­¾çš„é¢œè‰²å—ï¼Ÿ
- ä¸‹æ¬¡å†è¯´ï¼ğŸ‘‹ğŸ»
