---
show: step
version: 1.0
enable_checker: true
---

# opencv

## å›å¿†


- ä¸Šæ¬¡æˆ‘ä»¬ç ”ç©¶äº†æ»šåŠ¨æ¡
- å¯ä»¥æ§åˆ¶ç”»é¢ä¸åŒçš„
	- æ–‡æœ¬å†…å®¹
	- æ–‡æœ¬ä½ç½®
	- å…·ä½“é¢œè‰²
- è¿˜å¯ä»¥æœ‰ä»€ä¹ˆæ ·å…·ä½“çš„åº”ç”¨å—ï¼Ÿ

### è‰²å½©æ¨¡å¼è½¬åŒ–
```
import cv2                                                                    
image = cv2.imread("/home/shiyanlou/gourd.png")
cv2.imshow("image",image)
hsv_image = cv2.cvtColor(image,cv2.COLOR_BGR2HSV)
cv2.imshow("hsv_image",hsv_image)
print(hsv_image)
cv2.waitKey()
cv2.destroyAllWindows()
```

- è¿è¡Œç»“æœ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240106-1704533070919)

- çœ‹èµ·æ¥HSVçš„ç°å®ç»“æœå¾ˆæ··ä¹±
- ç©¶ç«Ÿä»€ä¹ˆæ˜¯HSVï¼Ÿ

### åˆ†é€šé“æ˜¾ç¤ºhsv
```
import cv2
image = cv2.imread("/home/shiyanlou/gourd.png")
cv2.imshow("image",image)
hsv_image = cv2.cvtColor(image,cv2.COLOR_BGR2HSV)
h,s,v = cv2.split(hsv_image)
cv2.imshow("hue",h)
cv2.imshow("saturation",s)
cv2.imshow("velocity",v)
cv2.waitKey()                                                       
cv2.destroyAllWindows()
```

- æ˜¾ç¤ºç»“æœ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240106-1704533177052)

| ç®€å†™ | åç§° | å«ä¹‰ |
| ---| --- | --- |
| H | Hue |è‰²ç›¸ |
| S | Saturation |é¥±å’Œåº¦ |
| V | Value | äº®åº¦  |

### è½¬åŒ–è‰²ç›¸hue

```
import cv2
image = cv2.imread("/home/shiyanlou/gourd.png")
cv2.imshow("image",image)
hsv_image = cv2.cvtColor(image,cv2.COLOR_BGR2HSV)
h,s,v = cv2.split(hsv_image)
h[:,:] = 180
hsv = cv2.merge([h,s,v])
new_image = cv2.cvtColor(hsv,cv2.COLOR_HSV2BGR)
cv2.imshow("new_image",new_image)
cv2.waitKey()
cv2.destroyAllWindows()
```

- è®¾ç½®è‰²ç›¸ä¸º180

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240106-1704534584176)

### è®¾ç½®è‰²ç›¸

```
import cv2                   
image = cv2.imread("/home/shiyanlou/gourd.png")
cv2.imshow("image",image)    
hsv_image = cv2.cvtColor(image,cv2.COLOR_BGR2HSV)
h,s,v = cv2.split(hsv_image) 
print(h)                     
h[:,:] = (h[:,:] + 90) % 180
hsv = cv2.merge([h,s,v])     
new_image = cv2.cvtColor(hsv,cv2.COLOR_HSV2BGR)
cv2.imshow("new_image",new_image)
cv2.waitKey()                
cv2.destroyAllWindows()
```

- è®¾ç½®è‰²ç›¸ä¸º180åº¦ååç›¸

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240106-1704535180652)

- é¥±å’Œåº¦saturationå¯ä»¥æ§åˆ¶å—ï¼Ÿ

### è½¬åŒ–é¥±å’Œåº¦saturation
```
import cv2
image = cv2.imread("/home/shiyanlou/gourd.png")
cv2.imshow("image",image)
hsv_image = cv2.cvtColor(image,cv2.COLOR_BGR2HSV)
h,s,v = cv2.split(hsv_image)
s[:,:] = 100
hsv = cv2.merge([h,s,v])
new_image = cv2.cvtColor(hsv,cv2.COLOR_HSV2BGR)
cv2.imshow("s = 100,new_image)
h,s,v = cv2.split(hsv_image)
s[:,:] = 0
hsv = cv2.merge([h,s,v])
new_image = cv2.cvtColor(hsv,cv2.COLOR_HSV2BGR)
cv2.imshow("s = 0",new_image)
cv2.waitKey()
cv2.destroyAllWindows()
```

- ç»“æœ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240106-1704535404027)

- æ˜åº¦å¯ä»¥è½¬åŒ–å—ï¼Ÿ

### è½¬åŒ–æ˜åº¦velocity
```
import cv2 
image = cv2.imread("/home/shiyanlou/gourd.png")
cv2.imshow("image",image)
hsv_image = cv2.cvtColor(image,cv2.COLOR_BGR2HSV)
h,s,v = cv2.split(hsv_image)
v[:,:] = 255
hsv = cv2.merge([h,s,v])                                            
new_image = cv2.cvtColor(hsv,cv2.COLOR_HSV2BGR)
cv2.imshow("new_image",new_image)
cv2.waitKey()
cv2.destroyAllWindows()
```

### æ ¹æ®æ»‘æ†æ§åˆ¶HSV

```
import cv2
import numpy as np

#trackbar callback fucntion to update HSV value
def callback(x):
    S = cv2.getTrackbarPos('S','controls')
    print("S========",type(S),S)
    #read source image
    img = cv2.imread("/home/shiyanlou/gourd.png")
    #convert sourece image to HSC color mode
    hsv = cv2.cvtColor(img, cv2.COLOR_BGR2HSV)
    h,s,v = cv2.split(hsv)
    s[:,:] = S
    cv2.imshow('img',img)
    hsv = cv2.merge([h,s,v])
    new_image = cv2.cvtColor(hsv,cv2.COLOR_HSV2BGR)
    cv2.imshow('controls',new_image)

#create a seperate window named 'controls' for trackbar
cv2.namedWindow('controls',2)
cv2.resizeWindow("controls", 550,200);

#create trackbars for high,low H,S,V
cv2.createTrackbar('S','controls',0,255,callback)

while(True):

    #waitfor the user to press escape and break the while loop
    k = cv2.waitKey(1) & 0xFF
    if k == 27:
        break
#destroys all window
cv2.destroyAllWindows()
```

- è¿è¡Œç»“æœ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240106-1704537277128)

### æ ¹æ®HSVæ§åˆ¶é€‰åŒºèŒƒå›´
```
import cv2
import numpy as np

#trackbar callback fucntion to update HSV value
def callback(x):
    global H_low,H_high,S_low,S_high,V_low,V_high
    H_low = cv2.getTrackbarPos('low H','controls')
    H_high = cv2.getTrackbarPos('high H','controls')
    S_low = cv2.getTrackbarPos('low S','controls')
    S_high = cv2.getTrackbarPos('high S','controls')
    V_low = cv2.getTrackbarPos('low V','controls')
    V_high = cv2.getTrackbarPos('high V','controls')


#create a seperate window named 'controls' for trackbar
cv2.namedWindow('controls',2)
cv2.resizeWindow("controls", 550,200);

#global variable
H_low = 0
H_high = 179
S_low= 0
S_high = 255
V_low= 0
V_high = 255

#create trackbars for high,low H,S,V
cv2.createTrackbar('low H','controls',0,179,callback)
cv2.createTrackbar('high H','controls',179,179,callback)

cv2.createTrackbar('low S','controls',0,255,callback)
cv2.createTrackbar('high S','controls',255,255,callback)

cv2.createTrackbar('low V','controls',0,255,callback)
cv2.createTrackbar('high V','controls',255,255,callback)


while(1):
    #read source image
    img = cv2.imread("/home/shiyanlou/gourd.png")
    #convert sourece image to HSC color mode
    hsv = cv2.cvtColor(img, cv2.COLOR_BGR2HSV)

    #
    hsv_low = np.array([H_low, S_low, V_low], np.uint8)
    hsv_high = np.array([H_high, S_high, V_high], np.uint8)

    #making mask for hsv range
    mask = cv2.inRange(hsv, hsv_low, hsv_high)
    print (mask)
    #masking HSV value selected color becomes black
    res = cv2.bitwise_and(img, img, mask=mask)

    #show image
    cv2.imshow('mask',mask)
    cv2.imshow('res',res)

    #waitfor the user to press escape and break the while loop
    k = cv2.waitKey(1) & 0xFF
    if k == 27:
        break
#destroys all window
cv2.destroyAllWindows()
```

- æœ€ç»ˆæ•ˆæœ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240106-1704536102058)

### æ€»ç»“ 

- è¿™æ¬¡ç ”ç©¶çš„æ˜¯HSV
- HSVæ˜¯ä¸€ç§è‰²å½©æ¨¡å¼

| ç®€å†™ | åç§° | å«ä¹‰ |
| ---| --- | --- |
| H | Hue |è‰²ç›¸ |
| S | Saturation |é¥±å’Œåº¦ |
| V | Value | äº®åº¦  |

- å¯ä»¥é€šè¿‡æ»‘å—å¯¹äºHSVçš„å›¾åƒè¿›è¡Œæ§åˆ¶
- è¿˜æœ‰ä»€ä¹ˆå¯ä»¥ç©çš„ä¸œè¥¿å—ï¼ŸğŸ¤”
- æˆ‘ä»¬ä¸‹æ¬¡å†è¯´	ğŸ‘‹


