---
show: step
version: 1.0 
enable_checker: true
---


# python_blender

## å¼€å§‹

- ä¸Šæ¬¡ æˆ‘ä»¬ 
	- è®¾ç½®äº† å…³é”®å¸§
	- åˆ¶ä½œäº† åŠ¨ç”» 
	- å¹¶ä¸”æ¸²æŸ“å‡ºäº† åŠ¨ç”»åºåˆ—
- æˆ‘ä»¬å¯ä»¥è®¾ç½®å˜åŒ–çš„ç¯å…‰å—?ğŸ¤”

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240530-1717030676820)

### æ·±å…¥å…³é”®å¸§å˜åŒ–

- æ‰§è¡Œä»£ç å
	- åœ¨åœºæ™¯ä¸­æ’­æ”¾

```
import bpy
import datetime

def handler(scene):
    print(datetime.datetime.now())

bpy.ops.object.select_all(action="SELECT") 
bpy.ops.object.delete() 
bpy.app.handlers.frame_change_pre.clear()
bpy.app.handlers.frame_change_pre.append(handler)
```

- é€‰ä¸­Layoutå·¥ä½œåŒº
	- å°†æ—¶é—´è½´æ’­æ”¾å¤´é€‰ä¸­ç¬¬6å¸§
	- è§‚å¯Ÿç»ˆç«¯é‡Œé¢çš„å˜åŒ–


- æ¯æ¬¡ åœ¨è¿›å…¥ æ–°å¸§ä¹‹å‰
	- ä¼šåœ¨consoleä¸­
	- è¾“å‡ºå½“å‰æ—¶é—´

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240606-1717637623836)

- å¯ä»¥è¾“å‡ºå½“å‰å¸§å·å—?

### è¾“å‡ºå¸§å·

```
import bpy

def handler(scene):
    current_frame = bpy.context.scene.frame_current
    print("frame:", current_frame)

bpy.app.handlers.frame_change_pre.clear()
bpy.app.handlers.frame_change_pre.append(handler)
print(bpy.app.handlers.frame_change_pre)
```

- è¿è¡Œè„šæœ¬
	- æ’­æ”¾åœºæ™¯

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240530-1717033922466)

- å¯ä»¥æŠŠå¸§å·æ”¾åˆ°åœºæ™¯é‡Œå—?

### ä»åœºæ™¯è¾“å‡ºå¸§å·


```python
import bpy

def handler(scene):
    current = bpy.context.scene.frame_current
    bpy.data.objects["Text"].data.body = "Frame:" + str(current)

bpy.ops.object.select_all(action="SELECT")
bpy.ops.object.delete()
bpy.ops.object.text_add()
bpy.app.handlers.frame_change_pre.clear()
bpy.app.handlers.frame_change_pre.append(handler)
print(bpy.app.handlers.frame_change_pre)
```

- æ’­æ”¾åœºæ™¯å
	- æ¯ä¸€å¸§éƒ½å¯ä»¥è¾“å‡ºåˆ°åœºæ™¯ä¸­

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240606-1717643770701)

- æƒ³è¦æ ¹æ®è¿™ä¸ªå¸§å·
	- ç§»åŠ¨æ–¹å— æœ‰å¯èƒ½å—?

### æŒ‰å¸§å·ç§»åŠ¨

```
import bpy

def handler(scene):
    current = bpy.context.scene.frame_current
    bpy.data.objects["Icosphere"].location[1] = -0.2*current
    bpy.data.objects["Text"].data.body = "Frame:" + str(current)

bpy.ops.object.select_all(action="SELECT")
bpy.ops.object.delete()
bpy.ops.object.text_add()
bpy.ops.mesh.primitive_ico_sphere_add()
bpy.app.handlers.frame_change_pre.clear()
bpy.app.handlers.frame_change_pre.append(handler)
```

- æ•ˆæœ
	- ä¸€å»ä¸å¤è¿”

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240606-1717667171254)

- å¯ä»¥ æ¥å› ç§»åŠ¨ å—?

### æ¥å›ç§»åŠ¨

```python
import bpy

def frame_handler(scene):
    current = bpy.context.scene.frame_current
    temp = current % 20
    if temp < 10:
        distance = -0.2 * temp
        bpy.data.objects["Icosphere"].location[1] = -0.2*temp
    else:
        distance = 0.2 * (temp - 10) - 2
        bpy.data.objects["Icosphere"].location[1] = distance
    str_dis = "{:.1f}".format(distance)
    bpy.data.objects["Text"].data.body = "Frame:" + str(current) + "\n"\
                                       + "Dis:" + str_dis

def init():
    bpy.ops.object.select_all(action="SELECT")
    bpy.ops.object.delete()
    bpy.ops.object.text_add()
    bpy.context.object.location[1] = 2
    bpy.ops.mesh.primitive_ico_sphere_add()
    bpy.app.handlers.frame_change_pre.clear()
    bpy.app.handlers.frame_change_pre.append(frame_handler)

init()
```

- åˆ‡åˆ°layoutå·¥ä½œåŒº
	- æ’­æ”¾è§‚å¯Ÿæ•ˆæœ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240610-1717987604757)

- å¯ä»¥ç›´æ¥æ¸²æŸ“å‡ºæ¥å—?

### ç›´æ¥æ¸²æŸ“

```
import bpy

def frame_handler(scene):
    current = bpy.context.scene.frame_current
    temp = current % 20
    if temp < 10:
        distance = -0.2 * temp
        bpy.data.objects["Icosphere"].location[1] = -0.2*temp
    else:
        distance = 0.2 * (temp - 10) - 2
        bpy.data.objects["Icosphere"].location[1] = distance
    str_dis = "{:.1f}".format(distance)
    bpy.data.objects["Text"].data.body = "Frame:" + str(current) + "\n"\
                                       + "Dis:" + str_dis

def init():
    bpy.ops.object.select_all(action="SELECT")
    bpy.ops.object.delete()
    bpy.ops.object.text_add()
    bpy.context.object.location[1] = 2
    bpy.ops.mesh.primitive_ico_sphere_add()
    camera = bpy.data.cameras.new('Camera')
    camera_obj = bpy.data.objects.new('Camera', camera)
    bpy.data.collections["Collection"].objects.link(camera_obj)
    camera.lens = 50  # Focal length in millimeters
    camera.sensor_width = 36  # Sensor width in millimeters
    camera.sensor_height = 24  # Sensor height in millimeters
    camera_obj.location = (0,-5,40)  # X, Y, Z coordinates
    camera_obj.rotation_euler = (0,0,0)
    bpy.context.scene.camera = camera_obj
    bpy.app.handlers.frame_change_pre.clear()
    bpy.app.handlers.frame_change_pre.append(frame_handler)

def render():
    bpy.context.scene.frame_end = 20
    bpy.context.scene.render.resolution_x = 200
    bpy.context.scene.render.resolution_y = 150
    bpy.context.scene.render.engine = 'CYCLES'
    bpy.context.scene.render.filepath = "/home/shiyanlou/Code/o"
    bpy.ops.render.render(animation=True)

init()
render()
```

- ç”¨fehè§‚å¯ŸåŠ¨ç”»æ•ˆæœ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240610-1717988980300)

- å‡†å¤‡åŠ 
	- ä¸€ç›ç¯
	- æ‘„å½±æœº
	- èƒŒæ™¯æ¿

### ä»£ç 

```import bpy

def frame_handler(scene):
    current = bpy.context.scene.frame_current
    temp = current % 20
    if temp < 10:
        distance = -0.2 * temp
        bpy.data.objects["Icosphere"].location[1] = -0.2*temp
    else:
        distance = 0.2 * (temp - 10) - 2
        bpy.data.objects["Icosphere"].location[1] = distance
    str_dis = "{:.1f}".format(distance)
    bpy.data.objects["Text"].data.body = "Frame:" + str(current) + "\n"\
                                       + "Dis:" + str_dis

def init():
    bpy.ops.object.select_all(action="SELECT")
    bpy.ops.object.delete()

    bpy.ops.object.text_add()
    bpy.context.object.data.size = 4
    mat = bpy.data.materials.new('mat_text')
    color = (0, 0, 0, 1)
    mat.diffuse_color = color
    bpy.context.object.data.materials.append(mat)

    bpy.ops.mesh.primitive_plane_add(size=20)
    mat = bpy.data.materials.new('mat_plane')
    color = (0, 1, 0, 1)
    mat.diffuse_color = color
    bpy.context.object.data.materials.append(mat)
    bpy.context.object.location = (0,0,-0.5)
    bpy.context.object.scale = (10,10,1)

    bpy.ops.mesh.primitive_ico_sphere_add()
    mat = bpy.data.materials.new('mat_text')
    color = (1, 0, 0, 1)
    mat.diffuse_color = color
    bpy.context.object.data.materials.append(mat)
    bpy.context.object.location = (0,10,0)

    bpy.ops.object.light_add(type='SPOT', radius=1)
    bpy.context.object.data.energy = 20000
    bpy.context.object.location = (0,0,35)

    camera = bpy.data.cameras.new('Camera')
    camera_obj = bpy.data.objects.new('Camera', camera)
    bpy.data.collections["Collection"].objects.link(camera_obj)
    camera.lens = 50  # Focal length in millimeters
    camera.sensor_width = 36  # Sensor width in millimeters
    camera.sensor_height = 24  # Sensor height in millimeters
    camera_obj.location = (0,-5,40)  # X, Y, Z coordinates
    camera_obj.rotation_euler = (0,0,0)
    bpy.context.scene.camera = camera_obj
    bpy.app.handlers.frame_change_pre.clear()
    bpy.app.handlers.frame_change_pre.append(frame_handler)

def render():
    bpy.context.scene.frame_end = 20
    bpy.context.scene.render.resolution_x = 200
    bpy.context.scene.render.resolution_y = 150
    bpy.context.scene.render.engine = 'CYCLES'
    bpy.context.scene.render.filepath = "/tmp/o"
    bpy.ops.render.render(animation=True)

init()
render()
```

- æ’­æ”¾æ•ˆæœ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240610-1717991699107)

- è¿™ç§æ¯å¸§è®¾ç½®å…·ä½“å‚æ•°çš„æ–¹å¼
- å’Œè®¾ç½®å¼€å§‹ã€ç»“æŸå…³é”®å¸§çš„æ–¹å¼
- æœ‰ä»€ä¹ˆåŒºåˆ«å—?

### å¯¹æ¯”å‚ç…§

```
import bpy

def frame_handler(scene):
    current = bpy.context.scene.frame_current
    distance = - current
    bpy.data.objects["red_ball"].location[1] = distance
    str_dis = "{:.2f}".format(distance)
    bpy.data.objects["red_text"].data.body = "Frm:" + str(current) + "\n"\
                                       + "Dis:" + str_dis
    str_dis = "{:.2f}".format(bpy.data.objects["blue_ball"].location[1])
    bpy.data.objects["blue_text"].data.body = "Frm:" + str(current) + "\n"\
                                       + "Dis:" + str_dis

def init():
    bpy.ops.object.select_all(action="SELECT")
    bpy.ops.object.delete()

    bpy.ops.object.text_add()
    bpy.context.object.data.size = 3
    bpy.context.object.name = "red_text"
    mat = bpy.data.materials.new('red_text')
    color = (0.5, 0, 0, 1)
    mat.diffuse_color = color
    bpy.context.object.data.materials.append(mat)

    bpy.ops.mesh.primitive_plane_add(size=20)
    mat = bpy.data.materials.new('mat_plane')
    color = (0, 1, 0, 1)
    mat.diffuse_color = color
    bpy.context.object.data.materials.append(mat)
    bpy.context.object.location = (0,0,-0.5)
    bpy.context.object.scale = (10,10,1)

    bpy.ops.mesh.primitive_ico_sphere_add()
    bpy.context.object.name = "red_ball"
    mat = bpy.data.materials.new('mat_red')
    color = (1, 0, 0, 1)
    mat.diffuse_color = color
    bpy.context.object.data.materials.append(mat)
    bpy.context.object.location = (3,10,0)

    bpy.ops.object.light_add(type='SPOT', radius=1)
    bpy.context.object.data.energy = 20000
    bpy.context.object.location = (0,0,35)

    camera = bpy.data.cameras.new('Camera')
    camera_obj = bpy.data.objects.new('Camera', camera)
    bpy.data.collections["Collection"].objects.link(camera_obj)
    camera.lens = 50  # Focal length in millimeters
    camera.sensor_width = 36  # Sensor width in millimeters
    camera.sensor_height = 24  # Sensor height in millimeters
    camera_obj.location = (0,-5,40)  # X, Y, Z coordinates
    camera_obj.rotation_euler = (0,0,0)
    bpy.context.scene.camera = camera_obj
    bpy.app.handlers.frame_change_pre.clear()
    bpy.app.handlers.frame_change_pre.append(frame_handler)
    
    bpy.ops.mesh.primitive_ico_sphere_add()
    mat = bpy.data.materials.new('mat_text')
    color = (0, 0, 1, 1)
    mat.diffuse_color = color
    obj = bpy.context.object
    obj.data.materials.append(mat)
    obj.location = (-3,-1,0)
    obj.keyframe_insert('location',frame=1)
    obj.location =  (-3,-10,0)
    obj.name = "blue_ball"
    obj.keyframe_insert(data_path="location",frame=10)
    
    bpy.ops.object.text_add()
    bpy.context.object.data.size = 3
    bpy.context.object.name = "blue_text"
    bpy.context.object.location = (-15,0,0)
    mat = bpy.data.materials.new('blue_text')
    color = (0, 0, 0.5, 1)
    mat.diffuse_color = color
    bpy.context.object.data.materials.append(mat)

def render():
    bpy.context.scene.frame_end = 10
    bpy.context.scene.render.resolution_x = 200
    bpy.context.scene.render.resolution_y = 150
    bpy.context.scene.render.engine = 'CYCLES'
    bpy.context.scene.render.filepath = "/tmp/o"
    bpy.ops.render.render(animation=True)

init()
render()
```

### æ¯”è¾ƒé¦–å°¾

- ç¬¬ä¸€å¸§
	- ä¸¤çƒyä½ç½®ç›¸åŒ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240610-1718004910132)

- æœ€åä¸€å¸§
	- ç¬¬åå¸§
	- ä¸¤çƒ yä½ç½®ä¹Ÿç›¸åŒ 

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240610-1718004959587)

- ä½†æ˜¯ä¸­é—´è¿‡ç¨‹å¦‚ä½•å‘¢?

### ä¸­é—´è¿‡ç¨‹

- ä»ç¬¬2å¸§ åˆ° ç¬¬9å¸§
	- ä¸¤çƒçš„yåæ ‡éƒ½ä¸ç›¸åŒ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240610-1718005025527)

- ä¸ºä»€ä¹ˆä¼šè¿™æ ·å‘¢?

### æ€»ç»“ ğŸ¤”

- è¿™æ¬¡æˆ‘ä»¬ç”¨ä»£ç 
	- å®ç°äº†åŠ¨ç”»
- ä»£ç åŠ¨ç”»æœ‰ä¸¤ç§
	1. æ¯æ¬¡è¿›å…¥å¸§çš„æ—¶å€™ è®¡ç®—æ•°å€¼
	2. åœ¨æ—¶é—´è½´ä¸Šæ’å…¥å…³é”®å¸§ 
- æˆ‘ä»¬å®è·µäº†ä¸¤ç§åŠ¨ç”»
	- éƒ½èƒ½ç”¨
	- ä½†æ˜¯å…·ä½“å¸§ä¸Šæ•°å€¼ä¸åŒ
- è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢?ğŸ¤”
- æˆ‘ä»¬ä¸‹æ¬¡å†è¯´ï¼ğŸ‘‹