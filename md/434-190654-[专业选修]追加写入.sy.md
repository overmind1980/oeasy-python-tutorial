---
show: step
version: 1.0
enable_checker: true
---

# è¿½åŠ å†™å…¥

## å›å¿†

- ä¸Šæ¬¡æˆ‘ä»¬æçš„æ˜¯æ–‡ä»¶è¯»å†™çš„é”å®š
- é çš„æ˜¯ fcntl è¿™ä¸ªåŒ…
- å¯ä»¥æœ‰
  - åˆ†äº«é” LOCK_SH
  - ç‹¬äº«é” LOCK_EX
  - é˜»å¡æ ‡å¿— LOCK_NB
  - å–æ¶ˆé” LOCK_UN
- ä¸è¿‡å¾—åˆ°é”äº†ä¹‹å
- ä¹Ÿæ˜¯åœ¨åŸå§‹åŸºç¡€ä¸ŠæŠŠåŸæ¥çš„å†…å®¹æŠ¹æ‰äº†
- æˆ‘æƒ³è¦åŸæ¥çš„éƒ½åœ¨
- æ–°æ¥çš„è¿½åŠ è¿›å»
- å¯ä»¥ä¹ˆï¼Ÿ
- å»å“ªé‡Œæœå‘¢ ğŸ¤”
- é—®ä½ å‘¢ï¼ï¼ï¼

### é—®

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240918-1726670083519)

- ä½¿ç”¨aæ¨¡å¼

### æœç´¢

- å» open é‚£é‡Œæ‰¾æ‰¾æ€è·¯
- help(open)

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210826-1629975180837)

- æ„Ÿè§‰å°±æ˜¯ a
- appending æ¨¡å¼

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210826-1629975158377)

### æ„æ€

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220312-1647092434616)

- çœ‹èµ·æ¥ç¡®å®æ˜¯ append ä¸Šå»äº†
- åŸæ¥çš„ä¸œè¥¿ä¸ä¼š truncate
- ä½†æ˜¯ä¸€ä¼šå„¿ wæˆ–a ä¸€ä¼šå„¿ r
- åˆ‡æ¥åˆ‡å»å¥½éº»çƒ¦
- å¯ä»¥åˆ w åˆ r ä¹ˆï¼Ÿ

### æœç´¢

- help(open)

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210826-1629975180837)

- æ„Ÿè§‰å°±æ˜¯+

### å®éªŒ

- ç»§ç»­ä¹¦å†™
- æœ‰ç§åŠ¿å¦‚ç ´ç«¹çš„æ„Ÿè§‰

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210826-1629975528341)

- a+ å…¶å®å°±æ˜¯append + read
- é‚£æˆ‘å¯ä»¥æŠŠ a å½“åš w æ¥ç”¨ä¹ˆï¼Ÿ

### å°è¯•

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210826-1629975611673)

- æƒ³è¦å…ˆæ¸…ç©º
- ç„¶åå†å†™
- å¥½åƒå¤±è´¥äº†
- ä¸ºä»€ä¹ˆå‘¢
	- æŸ¥è¯¢å‡½æ•°å®šä¹‰

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220404-1649035251696)

- é—®é¢˜æ˜¯æŸ¥ä»€ä¹ˆå‘¢ï¼Ÿ

### æŸ¥æ–‡æ¡£

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221231-1672448394119)

- openå‡½æ•°æœ‰å¸®åŠ©
- å‘Šè¯‰æˆ‘ä»¬è¿”å›4ç§å¯¹è±¡ç±»å‹
| TextIOWrapper | BufferedReader | BufferedWriter | BufferedRandom|
| --- | --- | --- | --- |
| r/wt/rt..| rb | wb | wb+ |
| æ–‡æœ¬å°è£… | äºŒè¿›åˆ¶è¯»ç¼“å­˜ | äºŒè¿›åˆ¶å†™ç¼“å­˜ | äºŒè¿›åˆ¶è¯»å†™ç¼“å­˜

- æˆ‘æŸ¥æŸ¥æ–‡æœ¬çš„TextIOWrapper

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220404-1649035346264)

### seekå‡½æ•°

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220404-1649035540865)

- seekçš„ä½œç”¨æ˜¯æ”¹å˜æµçš„ä½ç½®

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210826-1629975611673)

- åˆšæ‰çš„æµç¨‹æ˜¯
	- å…ˆå†™"o5z"
	- å†æ”¹ä½ç½®å›æœ€åˆ
	- æœ€åå†è¯»
- æˆ‘ä»¬åº”è¯¥å…ˆæ”¹ä½ç½®ï¼Œå†å»å†™

### æ¸…ç©ºä½ç½®

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210826-1629975904653)

- è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥é‡å¤´æ”¹å†™æ–‡æ¡£äº†
	- æ³¨æ„æ˜¯å½»åº•æ”¹å†™
	- åŸæ¥æ–‡æ¡£åé¢çš„"o2z"ä¹‹ç±»çš„éƒ½æ¶ˆå¤±äº†
- æŸ¥è¯¢æ–‡æ¡£çœŸçš„æœ‰ç”¨
	- æˆ‘ä»¬å†æ¥æŸ¥æŸ¥truncateå‡½æ•°


### truncate

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220404-1649036299115)

- truncate æœ¬æ„æ˜¯é”¯æ–­æœ¨å¤´
- è¿™é‡Œä¹Ÿå¯ä»¥é”¯æ–­æ–‡ä»¶

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220404-1649036027947)

### truncate

- truncateåœ¨æ²¡æœ‰å‚æ•°çš„æ—¶å€™å’Œtellä¸€æ ·
	- è¿”å›ç›®å‰é•¿åº¦
- æœ‰å‚æ•°çš„è¯å¯ä»¥æˆªæ–­å­—ç¬¦ä¸²

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220404-1649036091968)

- æˆªæ–­å­—ç¬¦ä¸²æ˜¯æŒ‰ç…§å‚æ•°æ¥æˆªæ–­çš„
	- f.truncate(3) ç•™3ä¸ªå­—èŠ‚
	- f.truncate(2) ç•™2ä¸ªå­—èŠ‚
 	- f.truncate(1) ç•™1ä¸ªå­—èŠ‚
	- f.truncate(0) å½»åº•æ¸…ç©º

### ç”¨aæ¥w

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220404-1649036484737)

- è¿™æ ·æˆ‘ä»¬å°±ç”¨ a å¹²äº† w çš„äº‹æƒ…
- åè¿‡æ¥
	- é‚£æˆ‘ä»¬èƒ½ç”¨ w å¹² a çš„äº‹æƒ…å—ï¼Ÿ

### å°è¯•

- æŠŠåŸæ¥çš„å…ˆè¯»å‡ºæ¥

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220312-1647093212131)

- ç„¶åå…ˆæŠŠå†…å®¹è¯»åˆ°s_original
- wæ¸…ç©ºå
	- å…ˆå†™è¿›s_original
	- å†å†™æ–°çš„
	- è¿™ä¸å°±æ˜¯è¿½åŠ äº†ä¹ˆï¼Ÿ
- å†™å…¥(w)å’Œè¿½åŠ (a)ä¸¤ç§æ¨¡å¼å¯ä»¥ç›¸äº’è½¬åŒ–äº†
- æ— è®ºw+è¿˜æ˜¯a+
	- è¿™ä¸ª+æ¨¡å¼åªæ˜¯è®©å†™å…¥æ¨¡å¼ä¸‹å¢åŠ äº†è¯»(read)çš„åŠŸèƒ½
- é‚£ä¹ˆäºŒè¿›åˆ¶(b)å’Œæ–‡æœ¬(t) ä¸¤ç§æ¨¡å¼å¯ä»¥è½¬åŒ–ä¹ˆï¼Ÿ

### ç”¨äºŒè¿›åˆ¶å†™æ–‡æœ¬

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220404-1649037555426)

- å¯ä»¥å…ˆæŠŠæ–‡æœ¬è½¬åŒ–ä¸ºå­—èŠ‚
- ç„¶åç”¨äºŒè¿›åˆ¶çš„æ–¹å¼å†™å­—èŠ‚
- ç„¶åå†ç”¨æ–‡æœ¬çš„æ–¹å¼è¯»å‡ºæ¥
- ä¸€ç‚¹æ¯›ç—…æ²¡æœ‰

### ç”¨æ–‡æœ¬å†™äºŒè¿›åˆ¶

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220404-1649037577870)

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220404-1649037666269)

- å¯ä»¥æŠŠäºŒè¿›åˆ¶å­—èŠ‚åºåˆ—æ–‡æœ¬åŒ–
- ä½†æ˜¯æœ‰ç‚¹é—®é¢˜
- æœ‰äº›äºŒè¿›åˆ¶å­—èŠ‚æ— æ³•å¯¹åº”å…·ä½“æ–‡æœ¬
	- æ¯”å¦‚`b"\x00"`
	- è¿™å°±æ²¡æœ‰åŠæ³•äº†...

### æ€»ç»“

- è¿™æ¬¡æˆ‘ä»¬ç ”ç©¶è¿½åŠ æ–‡ä»¶
  - è¿½åŠ æ–‡ä»¶å°±æ˜¯æŠŠæ–‡ä»¶æ‰“å¼€
  - ç„¶ååœ¨åé¢å†™ä¸Šè¦å†™çš„å†…å®¹
- è¿˜æœ‰è¯»å†™åŠŸèƒ½+
  - è¿™å¯ä»¥è®©æˆ‘ä»¬æ—¢å¯ä»¥è¯»åˆå¯ä»¥å†™
  - w å’Œ a ä¸æ˜¯å­¤ç«‹çš„
	- è€Œä¸”æ˜¯å¯ä»¥ç›¸äº’è½¬åŒ–çš„
  - b å’Œ t ä¹Ÿä¸æ˜¯å­¤ç«‹çš„
	- ä¹Ÿæ˜¯å¯ä»¥ç›¸äº’è½¬åŒ–çš„  
- æˆ‘è¿˜æƒ³è®©ç¨‹åºå†™ç‚¹å¤æ‚çš„ç¨‹åº
  - ä»æ–‡ä»¶è¯»å–ä¿¡æ¯
  - å®Œæˆä¸ªè®¡ç®—
- å¯ä»¥ä¹ˆï¼ŸğŸ¤”
- ä¸‹æ¬¡å†è¯´ ğŸ‘‹
