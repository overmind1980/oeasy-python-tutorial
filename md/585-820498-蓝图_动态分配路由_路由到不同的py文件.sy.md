---
show: step
version: 1.0
enable_checker: true
---

# flask æœ€å°åº”ç”¨

## å›å¿†ä¸Šæ¬¡

- ä¸Šæ¬¡ äº†è§£åˆ° `è·¯ç”±`
	- ç”¨è£…é¥°å™¨ å£°æ˜url
	- å† å°†è·¯ç”± å°è£…æˆ å‡½æ•°
- url ä¸­ å¯ä»¥åŒ…å«`å˜é‡`
	- å°†`å˜é‡`ä½œä¸º`å‚æ•°` ä¼ å…¥`å¤„ç†å‡½æ•°` 
	- è¿›è¡Œå¤„ç†

|è·¯ç”±ç±»å‹|è·¯ç”±å®šä¹‰è¯­æ³•|åŒ¹é…è§„åˆ™è¯´æ˜|ç¤ºä¾‹ URL åŠå¯¹åº”å¤„ç†é€»è¾‘|
|---|---|---|---|
|å­—ç¬¦ä¸²åœ°å€ï¼ˆæ— çº¦æŸï¼‰|/user/<username>|åŒ¹é…ä»»æ„å­—ç¬¦ä¸²ï¼ˆé™¤ / å¤–  ï¼‰|å¦‚ localhost:5000/user/oeasy ï¼Œusername ä¸º oeasy ï¼Œè¿”å› User oeasy|
|æ•´æ•°ç±»å‹çº¦æŸ|/post/<int:post_id>|ä»…åŒ¹é…æ•´æ•°å½¢å¼å†…å®¹|å¦‚ localhost:5000/post/123 ï¼Œpost_id ä¸º 123 ï¼Œè¿”å› Post 123|
|è·¯å¾„ç±»å‹çº¦æŸ|/path/<path:subpath>|åŒ¹é…åŒ…å« / çš„å®Œæ•´è·¯å¾„ç‰‡æ®µ|å¦‚ localhost:5000/path/a/b/c ï¼Œsubpath ä¸º a/b/c ï¼Œè¿”å› Subpath a/b/c|

- å¤§å‹åº”ç”¨ æœ‰å„ç§ è¦å¤„ç†çš„url
	- éƒ½è¦ æ”¾ app.py é‡Œ
	- èƒ½åˆ†é—¨åˆ«ç±» æ”¾åˆ° ä¸åŒpyæ–‡ä»¶ ä¸­å—ï¼Ÿï¼Ÿ

### åˆ†é—¨åˆ«ç±»

- å°† æ‰€æœ‰çš„è·¯ç”±
	- éƒ½æ”¾åœ¨ `app.py`é‡Œ
- å°±åƒ
	- å°† æ‰€æœ‰çš„ä¸œè¥¿ 
	- éƒ½å †åˆ° `ä¸€ä¸ªç®±å­`é‡Œ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240721-1721526897884)

- å¤æ‚é¡¹ç›®
	- éœ€è¦ åˆ†é—¨åˆ«ç±»

### åˆ†ç±»

- å°†è·¯ç”± åˆ†é—¨åˆ«ç±»
	- åˆ†æµåˆ° å¦ä¸€ä¸ª pyæ–‡ä»¶
	- ä¸“é—¨ è¿›è¡Œå¤„ç† ï¼ŸğŸ¤”

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240721-1721526769405)

- ä¿®æ”¹çš„æ—¶å€™
	- æ¯”è¾ƒå®¹æ˜“æŸ¥æ‰¾

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240721-1721526752185)

- å¦‚ä½•æŠŠ è·¯ç”± åˆ†é—¨åˆ«ç±» å‘¢ï¼Ÿ

### å†æ¬¡æ„é€ ç¯å¢ƒ

- å»ºç«‹ ç½‘ç«™ç›®å½•myproject
	- è¿›å…¥ç›®å½•

```
mkdir myproject
cd myproject
```

- ç¼–è¾‘replyæ–‡ä»¶

```
vi reply.py
```

- æ³¨æ„ä¸æ˜¯`app.py`å“¦

### `reply.py`

- åœ¨ é¡¹ç›®`æ ¹ç›®å½•` ä¸‹
	- å»ºç«‹ reply.py
	- å¤„ç†`/reply`è·¯ç”±

```
from flask import Blueprint

app_reply = Blueprint("reply", __name__)

@app_reply.route('/reply')
def reply():
    return 'oeasy redirects here o'
```

- è¿™ä¸ªä»£ç  æ²¡æœ‰app.run
	- èƒ½è·‘èµ·æ¥å—ï¼ŸğŸ¤”

### è¿è¡Œæƒ…å†µ

```
python3 relpy.py
```

- è¿è¡Œæ˜¯æ²¡æœ‰é—®é¢˜çš„
	- ä½†æ˜¯ æ²¡æœ‰ æœåŠ¡å™¨å¯åŠ¨
	- å› ä¸º app.run æ²¡æœ‰è¢«è°ƒç”¨

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/3584/labs/820498/uid1190679-20250621-1750478198954) 

- é‚£è¿™ä¸ª ä»£ç æœ‰ä»€ä¹ˆæ„ä¹‰å‘¢ï¼Ÿ

### `app.py`

- å¯ä»¥ è¢«ä¸»ç¨‹åºapp.py å¼•ç”¨

```
vi app.py
```

- åœ¨ä¸»ç¨‹åº(app)ä¸­
	- å¼•ç”¨äº† reply.py ä¸­çš„ app_reply

```
from flask import Flask
from markupsafe import escape
from reply import app_reply

app = Flask(__name__)
app.register_blueprint(app_reply)

if __name__ == "__main__":
	print(app.url_map)
    app.run(debug=True,host="0.0.0.0",port=8081)
```

- è¿™å°±æ˜¯ è“å›¾(blue_print)

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/3584/labs/820498/uid1190679-20250623-1750637437593) 

- å°†reply.pyä¸­çš„è·¯ç”±
	- ä½œä¸º è“å›¾ æ³¨å†Œåˆ°äº† 
	- ä¸»ç¨‹åºapp.pyä¸­

### æœ€ç»ˆæ•ˆæœ

- å°è¯•è¿è¡Œ

```
nohup python3 app.py >> flask.log 2>&1 &
```

- ç«ç‹æ‰“å¼€/reply

```
firefox http://localhost:8081/reply &
```

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/3584/labs/820498/uid1190679-20250623-1750637545310) 

- å¯¹/reply è·¯ç”±æˆåŠŸ

### æ•ˆæœ

- è§‚å¯Ÿæ—¥å¿—

```
vi flask.log
```

- ç¡®å®å¯ä»¥è®¿é—®
	- çŠ¶æ€ç  ä¸º 200

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/3584/labs/820498/uid1190679-20250623-1750637525915) 

- ä¸¤ä¸ªå¤„ç†æ–‡ä»¶
	- app.py å’Œ reply.py
	- éƒ½ä½äº é¡¹ç›®æ ¹ç›®å½•
	- è¿˜æ˜¯ æœ‰ç‚¹ä¹±
- å¯ä»¥æ”¾åœ¨ ä¸åŒçš„ æ–‡ä»¶å¤¹ä¸‹ å—ï¼Ÿ

### ä½¿ç”¨è·¯å¾„

- è§‚å¯Ÿç°çŠ¶

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/3584/labs/820498/uid1190679-20250621-1750479581152) 

- å‡†å¤‡ä¿®æ”¹

### ä¿®æ”¹

- åœ¨é¡¹ç›®æ ¹ä¸‹ å»ºç«‹æ–‡ä»¶å¤¹path
	- æŠŠreply.py ç§»åŠ¨è¿›å»

```
mkdir path
mv reply.py path
```

- åˆ·æ–°ç°çŠ¶

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240402-1712045117287)

- ä¿®æ”¹æ–‡ä»¶

### ä¿®æ”¹app.py

```
vi app.py
```

- ä¿®æ”¹app.pyå¦‚ä¸‹å›¾æ‰€ç¤º
	- æŒ‡å®š replyçš„è·¯å¾„ ä¸º path

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/3584/labs/820498/uid1190679-20250623-1750638007207) 

- ä¿å­˜å¹¶é€€å‡º

### è¿è¡Œæ•ˆæœ

- ç«ç‹ å†æµè§ˆ /reply

```
firefox http://localhost:8081/reply &
```

- æµè§ˆå™¨ æœ‰å“åº”

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/3584/labs/820498/uid1190679-20250623-1750638222267) 

-  å† åˆ·æ–°æ—¥å¿—

```
tail -n 10 flask.log
```

- æ—¥å¿— è®°å½•äº† 
	- ä»£ç çš„ ä¿®æ”¹ å’Œ æ›´æ–°
	- æœ¬æ¬¡å“åº”

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/3584/labs/820498/uid1190679-20250623-1750648935991) 

- è·¯ç”±åœ°å›¾å•¥æ ·ï¼Ÿ

### è§‚å¯Ÿæ˜ å°„ è¿‡ç¨‹

- è¾“å‡º è·¯ç”±åœ°å›¾

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230427-1682589890521)

- å­è·¯ç”± ä¹Ÿè¢«æ·»åŠ åˆ°äº† è§„åˆ™ä¸­

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/3584/labs/820498/uid1190679-20250623-1750649012231) 

## æ€»ç»“

- è¿™æ¬¡ å®ç°äº†
	- åŠ¨æ€ åˆ†é…è·¯ç”±çš„ æ•ˆæœ
- å¯ä»¥ æŠŠè·¯ç”±å·¥ä½œ 
	- åŠ¨æ€åœ° åˆ†é…ç»™ä¸åŒçš„æ–‡ä»¶ æ¥å¤„ç†
	- è¿™æ ·å°± å¯ä»¥å®ç° æ¨¡å—å°è£… äº†
		- ä¸åŒæ¨¡å—çš„ pyæ–‡ä»¶
		- æ”¾åˆ°ä¸åŒçš„ æ–‡ä»¶å¤¹
- è·¯ç”±è§„åˆ™ä¸­ 
	- å§‹ç»ˆæœ‰ä¸€ä¸ª
	- æ˜ å°„åˆ°staticæ–‡ä»¶å¤¹çš„
	- è·¯ç”±

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/3584/labs/820498/uid1190679-20250623-1750649036014) 

- è¿™å¦‚ä½•ç†è§£ï¼ŸğŸ¤”
- ä¸‹æ¬¡å†è¯´!ğŸ‘‹