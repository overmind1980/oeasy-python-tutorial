---
show: step
version: 1.0
enable_checker: true
---

# å‡½æ•°è°ƒç”¨(call)æ ˆ(stack)ä¸­çš„å¸§(frame)

## å›å¿†

- ä¸Šä¸€æ¬¡æˆ‘ä»¬ç†è§£äº†å·¥ä¸šåŒ–
	- å·¥ä¸šåŒ–è¿½æ±‚çš„æ˜¯æ•ˆç‡å’Œåˆ©æ¶¦
	- å·¥ä¸šåŒ–ç¡®å®å¯ä»¥å¤§å¹…åº¦æé«˜åˆ©æ¶¦
	- å·¥ä¸šåŒ–æ˜¯æ—¶ä»£å‘å±•è¶‹åŠ¿
- å„è¡Œå„ä¸šéƒ½åœ¨å·¥ä¸šåŒ–
	- åˆ¶é€ ä¸š
	- å»ºç­‘
	- å¨å¸ˆ
- å·¥ä¸šåŒ–ã€ä¿¡æ¯åŒ–å¤§æ½®ä¸‹
	- å¨å¸ˆè¿™ä¸ªå¤è€çš„è¡Œä¸šå¦‚ä½•è‡ªæˆ‘å˜é©
	- é€‚åº”å˜åŒ–
	- ä»¥ä»Šä¹‹é“ä»¥å¾¡ä»Šä¹‹æœ‰
- è¿˜æ˜¯è¦å›ç­”ä¸€ä¸ªé—®é¢˜
- å‡½æ•°ç©¶ç«Ÿæ˜¯å¦‚ä½•å®ç°å±‚å±‚è°ƒç”¨çš„å‘¢ï¼Ÿ

### è°ƒç”¨

- ç»å¸¸å¬è¯´å‡½æ•°è°ƒç”¨æ˜¯ç”¨çš„å¸§æ ˆ
- æˆ‘ä»¬åˆ°ç³»ç»Ÿ(sys)é‡Œé¢æœä¸€ä¸‹å¸§(frame)

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220822-1661152049090)

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220822-1661152056530)

- åœ¨få†…éƒ¨å¯ä»¥æŸ¥çœ‹åˆ°ä¸€ä¸ªå¸§(Frame)å¯¹è±¡
- è¿™ä¸ªå¯¹è±¡æœ‰ä»€ä¹ˆå±æ€§å‘¢ï¼Ÿ

### å¸§çš„å±æ€§

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220822-1661152147294)

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220822-1661152220733)

- å†æœç´¢å±æ€§å

### æ‰¾åˆ°æ‰‹å†Œ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220822-1661152256559)

- è¿™ä¸ªä¸œè¥¿ä¹Ÿæ˜¯å¯ä»¥inspectçš„ä¸€ä¸ªcode object
- å°±åƒ
	- å‡½æ•°(function)
	- æ¨¡å—(module)

### æŸ¥çœ‹å¸§ç»†èŠ‚

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220822-1661152770370)

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220822-1661152777166)

### ä¸Šä¸€å¸§

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220822-1661153462505)

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220822-1661153468142)

- å¯ä»¥çœ‹åˆ°å½“å‰å¸§å¯¹è±¡
	- å¸§ä½äºå°¾å·8dd0
- å½“å‰å¸§çš„ä»£ç å¯¹è±¡(code object)
	- ä½äºå°¾å·cc90
	- å†™äºäºstack.pyçš„ç¬¬2è¡Œ
- å½“å‰å¸§å¯¹è±¡çš„ä»£ç å¯¹è±¡æ˜¯ä¸æ˜¯å°±æ˜¯å‡½æ•°fçš„ä»£ç å¯¹è±¡å‘¢ï¼Ÿ

### éªŒè¯

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220822-1661153580336)

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220822-1661153586520)

- ç¡®å®æ˜¯
- é‚£ä¹ˆæˆ‘å¯ä»¥é€šè¿‡å½“å‰å¸§å¾—åˆ°
	- å‡½æ•°çš„ä»£ç å¯¹è±¡
	- å‡½æ•°ä»£ç å¯¹è±¡çš„å±æ€§

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220822-1661154006495)

### è·å¾—å‡½æ•°å±æ€§

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220822-1661154178185)

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220822-1661154163355)

- è¿™äº›å±æ€§å¯ä»¥é€šè¿‡å¸§å¯¹è±¡ç›´æ¥è·å¾—ä¹ˆï¼Ÿ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220822-1661154276774)

### ç›´æ¥è·å¾—

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220822-1661154527807)

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220822-1661154535985)

- å¯ä»¥ä»å¸§(frame)å¯¹è±¡ä¸Šç›´æ¥è·å¾—å‡½æ•°ä¿¡æ¯
- ç”šè‡³å¯ä»¥è·å¾—å±€éƒ¨(local)å˜é‡çš„å€¼

### ä»£ç ä½ç½®ä¿¡æ¯

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220822-1661155155829)

- è¿™ä¿©å±æ€§æœ‰å•¥åŒºåˆ«

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220822-1661155221139)

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220822-1661155228920)

- linenoæ˜¯æºä»£ç çš„ä½ç½®
- lastiæ˜¯å­—èŠ‚ç æŒ‡ä»¤çš„ç´¢å¼•
- å¦‚ä½•ç†è§£24

### æ±‡ç¼–çº§ç†è§£

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220822-1661155378643)

- ä¸Šæ¬¡çš„ä½ç½®
- å…¶å®å°±åœ¨å½“å‰å¸§è¿™é‡Œ
- æ‰€ä»¥å°±æ˜¯æœ¬å¥çš„ä½ç½®24
- è¿˜æœ‰ä¸ªå±æ€§

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220822-1661155502403)

### è¯•è¯•
![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220822-1661155587098)

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220822-1661155594405)

- è°ƒç”¨f()çš„ä½ç½®
- å¯ä¸å°±æ˜¯ç¬¬7è¡Œä¹ˆ
- è¿˜å¯ä»¥å¾€å‰æ¯ä¹ˆï¼Ÿ

### å¾€å‰æ¯

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220822-1661155696188)

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220822-1661155703342)

- æ¯åˆ°å¤´äº†
- ä¸è¿‡å¯ä»¥ç»§ç»­å¾€æ·±äº†è°ƒç”¨(call)

### ç»“æ„

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220822-1661155996786)

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220822-1661156223440)

- è¿™è°ƒç”¨ç»“æ„åƒä»€ä¹ˆï¼Ÿ

### è°ƒç”¨(call)ç»“æ„

- è¿™ä¸ªè°ƒç”¨ç»“æ„åƒä¸€å±‚å±‚æ‘èµ·æ¥çš„ç›˜å­

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220822-1661156368968)

- æ‰€ä»¥ä¹Ÿå«åšè°ƒç”¨(call)æ ˆ(stack)
- æ ˆæœ‰ä»€ä¹ˆç‰¹ç‚¹å‘¢ï¼Ÿ
	- æ–°æ¥çš„æ”¾ä¸Šé¢
	- æ–°èµ°çš„ä»ä¸Šé¢æ‹¿
	- æœ€å…ˆæ”¾è¿›å»çš„æœ€åæ‹¿å‡ºæ¥
	- First In Last Out
- é‚£ä¹ˆç›˜å­å¯¹åº”ä»€ä¹ˆå‘¢

### å¸§(frame)
- ç›˜å­å¯¹åº”æ ˆ(stack)ä¸Šçš„çš„å¸§(frame)
- ä»€ä¹ˆæ˜¯å¸§(frame)å‘¢ï¼Ÿ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220822-1661159116892)

- ä¸ºå»ºç­‘å‡†å¤‡æœ¨æ
- ä¸€ä¸ªç”»æ¡†å°±æ˜¯ä¸€å¸§
- æ‰€ä»¥ä¹Ÿè¢«æç»˜ä¸ºä¸€å¸§ç”»é¢


### æ ˆ(stack)å¸§(frame)

- è°ƒç”¨(call)æ ˆ(stack)ä¸Šçš„çš„å¸§(frame)
	- åˆ†æˆä¸‰å—
	- å±€éƒ¨å˜é‡
	- è¿”å›åœ°å€
	- å½¢å‚å˜é‡

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220822-1661159173083)

- è“è‰²çš„ç”»çŸ©å½¢å‡½æ•°
- è°ƒç”¨äº†ç»¿è‰²çš„åˆ’çº¿å‡½æ•°
- å…·ä½“è¿”å›åœ°å€å•¥æ„æ€å‘¢ï¼Ÿ

### æ±‡ç¼–

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220822-1661159739970)

- è¾“å‡ºgå‡½æ•°è°ƒç”¨å¸§çš„ä¸Šä¸€å¸§çš„ä¸Šæ¬¡æŒ‡ä»¤ä½ç½®

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220822-1661159697508)

- 20
- è§‚å¯Ÿfå‡½æ•°æŒ‡ä»¤(instructions)

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220822-1661159869468)

- ä¸Šæ¬¡æ‰§è¡Œåˆ°äº†20è¡Œ
- è°ƒç”¨gå‡½æ•°å»äº†
- ç°åœ¨è¿”å›äº†ä¸ªNone
- 22è¡Œå¼¹æ ˆ
- ç„¶å24è¡Œç»§ç»­æ‰“å°

### æ€»ç»“
- æˆ‘ä»¬è¿™æ¬¡ç ”ç©¶äº†è°ƒç”¨(call)æ ˆ(stack)çš„å¸§(frame)
	- è°ƒç”¨å‡½æ•°æ˜¯ä¸€å±‚å±‚è°ƒç”¨çš„
	- å‡½æ•°çš„å¸§(frame)è¢«æ”¾åˆ°äº†ä¸€ä¸ªæ ˆ(stack)ç»“æ„ä¸­
- è°ƒç”¨çš„æ—¶å€™å»ºç«‹ä¸€ä¸ª
	- å‚æ•°(parameter)
	- è¿”å›åœ°å€(return address)
	- å±€éƒ¨(locals)å˜é‡
- æ”¾åœ¨æ ˆä¸Š
- ç„¶åå»æ‰§è¡Œå‡½æ•°çš„ä»£ç å¯¹è±¡
- æ‰§è¡Œå®Œäº†è¿”å›çš„æ—¶å€™
	- å›åˆ°è°ƒç”¨å‡½æ•°(caller)è°ƒç”¨çš„ä½ç½®
	- callerçš„å±€éƒ¨å˜é‡ã€å½¢å¼å‚æ•°(parameter)éƒ½è¿˜åœ¨è‡ªå·±çš„å¸§ä¸Š
	- ç»§ç»­æ‰§è¡Œcallerçš„æŒ‡ä»¤
	- ç›´è‡³ç»“æŸ
- æˆ‘ä»¬å°±æ˜¯è¿™æ ·
	- ä¸€å±‚å±‚åœ°å®ŒæˆæŠ½è±¡å’Œå°è£…
	- ç„¶åå±‚å±‚åµŒå¥—è°ƒç”¨çš„
- ç©¶ç«Ÿåº”è¯¥å¦‚ä½•ç†è§£æŠ½è±¡å’Œå°è£…å‘¢ï¼ŸğŸ¤”

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220808-1659945591290)

- æˆ‘ä»¬ä¸‹æ¬¡å†è¯´ğŸ‘‹

