---
show: step
version: 1.0
enable_checker: true
---

# è¯­æ³• html ç”Ÿæˆ

## å›å¿†

- é¦–å…ˆ å°† å­—ç¬¦ä¸²
	- è½¬åŒ–ä¸º ElementTreeå¯¹è±¡
- ç„¶åæŠŠå‰é¢çš„ requestsçš„ç»“æœ
	- å’Œ etreeç”Ÿæˆ ç»“åˆäº†
- é€šè¿‡ requests 
	- è·å¾—ç½‘é¡µçš„ response
- é€šè¿‡ HTML å‡½æ•°
	- æŠŠ response çš„å­—èŠ‚åºåˆ—
	- è½¬åŒ–ä¸ºä¸€æ£µ etree æ ‘

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221127-1669521450717)

- æµç¨‹ 
	- è·‘é€šäº†
- ä½†æ˜¯ 
	- æ‰¾å…ƒç´  æŒºéº»çƒ¦
	- æœ‰ä»€ä¹ˆ æ›´å¥½çš„æ–¹æ³•å—ï¼ŸğŸ¤”

### æœç´¢

- æœç´¢xpath

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210902-1630547071875)

- ç‚¹å‡»ç¬¬ä¸€ä¸ªå¼€å§‹ç ”ç©¶

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210902-1630547145505)

- xpath 
	- æ˜¯ w3cåˆ¶å®šçš„ æ ‡å‡†
- å…·ä½“æ€ä¹ˆç”¨ï¼Ÿ

### è·¯å¾„è¡¨è¾¾å¼

| è¡¨è¾¾å¼ | æè¿° | 
|--- |--- |
| nodename | åœ¨å½“å‰ä½ç½®é€‰æ‹©æ­¤ç±»èŠ‚ç‚¹ | 
|  / | ä»æ ¹èŠ‚ç‚¹é€‰å– æˆ– è¡¨ç¤ºå±‚çº§å…³ç³» |
| // | åœ¨ä»»æ„å±‚çº§ä¸‹çš„å­å­™è·¯å¾„ä¸‹ |
| . | é€‰å–å½“å‰èŠ‚ç‚¹ |
| .. | é€‰å–å½“å‰èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ | 
| @ | é€‰å–å±æ€§ |


- è¿™äº›ä¸œè¥¿æ€ä¹ˆç†è§£å‘¢ï¼Ÿ
	- å…·ä½“æ¥çœ‹çœ‹

### æ„é€ ç¯å¢ƒ

```
sudo service nginx start
sudo service nginx status
firefox http://localhost &
```

- å³é”® 
	- æŸ¥çœ‹æºä»£ç 
	- view source

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240408-1712539021966)

### æ“ä½œ

- dom æ ‘å¦‚ä¸‹

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221127-1669525619191)

- æˆ‘ä»¬æ¥è¯•ä¸€ä¸‹
	- å„ç§è·¯å¾„è¡¨è¾¾å¼

### ç‚¹(.)

- ç‚¹(.) ä¸ºå½“å‰èŠ‚ç‚¹
- et_ä¸ºç±»å‹å‰ç¼€
	- å«ä¹‰ä¸ºelement_tree_node
	- å…ƒç´ æ ‘èŠ‚ç‚¹

```
import requests
from lxml import etree
response = requests.get("http://localhost")
b_html = response.content
et_html = etree.HTML(b_html)
et_element = et_html.xpath(".")
print(et_element)
```

- xpath å‚æ•°ä¸º .
	- é€‰æ‹©çš„æ˜¯ å½“å‰èŠ‚ç‚¹
	- è¾“å‡ºä¸ºhtmlå…ƒç´ çš„åˆ—è¡¨

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240408-1712539113192)

- ç»“æœ çœŸçš„ 
	- æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Ÿ

### ç¨‹åºéªŒè¯

- è¿½åŠ è¾“å‡º
	- et_elementçš„type

```
print(type(et_element))
```

- å¤åˆ¶æœ€åä¸€å¥
	- è¾“å‡º et_elementçš„type

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240408-1712539218352)

- ç¡®å® xpathå‡½æ•°çš„è¿”å›å€¼ç±»å‹
	- æ˜¯ä¸€ä¸ªåˆ—è¡¨
	- list
- xpath(".")
	- å¾—åˆ°çš„ æ˜¯ 
	- å½“å‰å…ƒç´ html
- htmlä¸‹é¢ 
	- è¿˜æœ‰ä»€ä¹ˆ 
	- å­èŠ‚ç‚¹å‘¢ï¼Ÿ

### è¾“å‡º

- å½“å‰èŠ‚ç‚¹ä¸ºhtml
	- ä¸‹é¢æœ‰headå­èŠ‚ç‚¹

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221127-1669526063986)

- å¯ä»¥è¾“å‡ºheadå…ƒç´ 

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221127-1669526080303)

- å¯ä»¥ å†å¾€æ·±äº†æ‰¾ å—ï¼Ÿ

### å±‚çº§å…³ç³»

- body/p
	- ä½¿ç”¨çš„æ˜¯ç›¸å¯¹è·¯å¾„
	- ä»£è¡¨ç€ å½“å‰å…ƒç´ (et_html)
	- ä¸‹é¢çš„body
	- ä¸‹é¢çš„p
	- è¿™ä½¿ç”¨çš„æ˜¯ç›¸å¯¹è·¯å¾„
- ä¹Ÿå¯ä»¥ä½¿ç”¨ ç»å¯¹è·¯å¾„
	- /html/body/p

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221127-1669526234839)

- å¯ä»¥æ‰¾åˆ°3ä¸ªpå…ƒç´ 
	- éƒ½åœ¨åŒä¸€ä¸ªåˆ—è¡¨é‡Œ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221127-1669526259394)

- æ•ˆæœä¸€æ ·

### å†å‘ä¸‹ä¸€å±‚

|xpath|æè¿°æ–¹å¼|
|---|---|
|body/p/a|å½“å‰èŠ‚ç‚¹ä¸‹çš„<br/>bodyä¸‹çš„<br>pä¸‹çš„<br>aå…ƒç´ |
|/html/body/p/a|æ ¹ä¸‹çš„htmlä¸‹çš„<br>bodyä¸‹çš„<br>pä¸‹çš„<br>aå…ƒç´ |
|/html/body/p[2]/a|æ ¹ä¸‹çš„htmlä¸‹çš„<br>bodyä¸‹çš„<br>ç¬¬2ä¸ªpä¸‹çš„<br>aå…ƒç´ |

- åœ¨æœ¬ä¾‹ä¸­
	- ä¸Šè¿°çš„xpathç­‰ä»·

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221127-1669526419016)

- å› ä¸ºæ‰€æœ‰a
	- éƒ½åœ¨ç¬¬äºŒä¸ªpé‡Œé¢

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221127-1669526455954)

- éƒ½å¯ä»¥æ‰¾åˆ° 
	- æ‰€æœ‰ aå…ƒç´  çš„ åˆ—è¡¨

### ä»»æ„å±‚çº§ä¸‹

- //em
	- ä»»æ„å±‚çº§ä¸‹çš„emå…ƒç´ 

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221127-1669526539230)

- å¯ä»¥æ‰¾åˆ°

### å½“å‰èŠ‚ç‚¹

- å½“å‰èŠ‚ç‚¹
	- ç‚¹(.) 

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221127-1669527130581)

- bodyçš„å½“å‰èŠ‚ç‚¹
	- (è¿˜æ˜¯body)ä¸‹çš„
	- h1å…ƒç´ 

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240408-1712539828012)

### å‘ä¸Šä¸€å±‚

- å‘ä¸Šä¸€å±‚	
	- ä¸¤ä¸ªç‚¹(..)

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221127-1669526663256)


- æ ¹ä¸‹çš„htmlä¸‹çš„
	- bodyçš„
	- ä¸Šä¸€å±‚å…ƒç´ (html)ä¸‹çš„
	- headä¸‹çš„
	- styleå…ƒç´ 
- æˆ‘ä»¬æ€ä¹ˆçŸ¥é“
	- éœ€è¦çš„å…ƒç´ æ˜¯ å“ªä¸ªå­èŠ‚ç‚¹ å‘¢ï¼Ÿ

### é€šè¿‡æµè§ˆå™¨

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221127-1669527325250)

- å³é”®å†…å®¹æ£€æŸ¥å…ƒç´ 

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221127-1669527339987)

- åœ¨å…ƒç´ æŸ¥çœ‹ç•Œé¢
	- å³é”®å¤åˆ¶-xpath
- å°† è¯¥å…ƒç´ çš„xpath
	- å¤åˆ¶åˆ° å‰ªè´´æ¿

### ä½¿ç”¨xpath

- å°†å¤åˆ¶çš„xpath
	- ç²˜è´´åˆ°ä»£ç 

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221127-1669527474403)

- /html/body/p[1]
	- /html
		- æ ¹ä¸‹çš„htmlä¸‹
	- /body
		- htmlä¸‹çš„bodyä¸‹
	- /p[1]
		- body ä¸‹çš„ ç¬¬1ä¸ª p å…ƒç´ 

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221127-1669527566939)

- æ³¨æ„!!!
	- å…ƒç´ æ ‘èŠ‚ç‚¹ä¸‹æ ‡
		- æ˜¯ä»1å¼€å§‹
	- ä¸åˆ—è¡¨
		- ä»0å¼€å§‹
		- `ä¸`åŒ

## æ€»ç»“

- è¿™æ¬¡æ·±å…¥äº† xpath
- xpath 
	- ç”¨æ¥ç­›é€‰ 
	- xml æ–‡ä»¶ä¸­çš„èŠ‚ç‚¹

| è¡¨è¾¾å¼ | æè¿° | 
|--- |--- |
| nodename | åœ¨å½“å‰ä½ç½®é€‰æ‹©æ­¤ç±»èŠ‚ç‚¹ | 
|  / | ä»æ ¹èŠ‚ç‚¹é€‰å– æˆ– è¡¨ç¤ºå±‚çº§å…³ç³» |
| // | åœ¨ä»»æ„å±‚çº§ä¸‹çš„å­å­™è·¯å¾„ä¸‹ |
| . | é€‰å–å½“å‰èŠ‚ç‚¹ |
| .. | é€‰å–å½“å‰èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ | 
| @ | é€‰å–å±æ€§ |

- @é€‰å±æ€§ è¿™ä¸ª 
	- æˆ‘ä»¬è¿˜æ²¡æœ‰è¯•
	- æ€ä¹ˆç”¨å‘¢ï¼ŸğŸ¤”
- ä¸‹æ¬¡å†è¯´ğŸ‘‹
