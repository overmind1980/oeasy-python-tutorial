---
show: step
version: 1.0
enable_checker: true
---

# è¯­æ³• html å±æ€§ text æ–‡æœ¬

## å›å¿†

- äº†è§£ etree ä¸­çš„å…ƒç´ å…³ç³»
  - çˆ¶å­
  - å…„å¼Ÿ
- äº†è§£å…ƒç´ çš„æ ‡ç­¾æˆå‘˜
  - tag
- äº†è§£å…ƒç´ ä¸­çš„å±æ€§ç»„æˆå‘˜
  - attrib
  - å±æ€§å¯¹è±¡æœ¬è´¨æ˜¯ä¸€ä¸ªå­—å…¸
  - å¯ä»¥ç”¨ get å’Œç´¢å¼•çš„æ–¹å¼å¾—åˆ°å…·ä½“çš„å€¼
  - ä½¿ç”¨ get çš„æ–¹å¼æ›´å®‰å…¨
- é™¤äº†æ ‡ç­¾å’Œå±æ€§ç»„æˆå‘˜ä¹‹å¤–
  - å…ƒç´ ç±»è¿˜æœ‰æ–‡æœ¬æˆå‘˜
  - è¿™æ–‡æœ¬æˆå‘˜æ€ä¹ˆç†è§£ï¼ŸğŸ¤”

### æ–‡æœ¬

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210901-1630462348659)

- text æ–‡æœ¬æ˜¯ etree å…ƒç´ çš„ä¸€ä¸ªæˆå‘˜å˜é‡
  - å°±åƒ tag æ˜¯ etree å…ƒç´ çš„ä¸€ä¸ªæˆå‘˜å˜é‡ä¸€æ ·
  - å°±åƒ attrib æ˜¯ etree å…ƒç´ çš„ä¸€ä¸ªæˆå‘˜å˜é‡ä¸€æ ·
  - text æˆå‘˜å˜é‡çš„ç±»å‹æ˜¯å­—ç¬¦ä¸²

### åŠ¨æ‰‹

```
from lxml import etree
html = etree.Element("html")
head = etree.Element("head")
html.append(head)
title = etree.Element("title")
head.append(title)
body = etree.Element("body")
html.append(body)
print(etree.tostring(html,pretty_print=True).decode("utf-8"))
```

- è¿™é‡Œå‡ºç°çš„å››ä¸ªå…ƒç´ éƒ½æ²¡æœ‰textå±æ€§

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220912-1662977673434/wm)

- æˆ‘ä»¬ç»™titleæ·»åŠ textå±æ€§

### text


```
from lxml import etree
html = etree.Element("html")
head = etree.Element("head")
html.append(head)
title = etree.Element("title")
head.append(title)
body = etree.Element("body")
html.append(body)
title.text = "oeasy"
print(etree.tostring(html,pretty_print=True).decode("utf-8"))
```

- å¯ä»¥çœ‹åˆ°è®¾ç½®äº† title å…ƒç´ çš„ text æˆå‘˜
  - æ ‡ç­¾ä¸ä»…ä»…æ˜¯æ ‡ç­¾æœ¬èº«
  - å¼€å§‹ç»“æŸæ ‡ç­¾é‡Œé¢è¿˜æœ‰äº† text æ–‡æœ¬

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220912-1662977765655/wm)

- ç½‘é¡µå°±æœ‰äº†æ ‡é¢˜

### è¿½åŠ 

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210901-1630462571298)

- å¯ä»¥åœ¨å…ƒç´ åé¢è¿½åŠ ä¸ªå°¾å·´ tail
- tail å°±åƒ text
  - ä¹Ÿæ˜¯å…ƒç´ çš„æˆå‘˜å˜é‡
  - ä¹Ÿæ˜¯å­—ç¬¦ä¸²ç±»å‹çš„
  - åªä¸è¿‡åœ¨å…ƒç´ ç»“æŸæ ‡ç­¾çš„åé¢

### åŠ¨æ‰‹

```
from lxml import etree
html = etree.Element("html")
head = etree.Element("head")
html.append(head)
title = etree.Element("title")
head.append(title)
body = etree.Element("body")
html.append(body)
title.text = "oeasy"
h1 = etree.Element("h1")
body.append(h1)
h1.text = "o3z"
h1.tail = "o2z"
print(etree.tostring(html,pretty_print=True).decode("utf-8"))
```

- å¯ä»¥ç”¨ tail æˆå‘˜å†å…ƒç´ åé¢è¿½åŠ æ–‡æœ¬å†…å®¹

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220912-1662977965583/wm)

- ä¹Ÿå¯ä»¥åœ¨ tostring å‡½æ•°ä¸­
  - ç”¨ with_tail=False å‚æ•°æ§åˆ¶ tail æˆå‘˜ä¸æ˜¾ç¤º

- å¯ä»¥æ·»åŠ  tail
- å°±å¯ä»¥å–æ¶ˆ tail

### å–æ¶ˆ

```
from lxml import etree
html = etree.Element("html")
head = etree.Element("head")
html.append(head)
title = etree.Element("title")
head.append(title)
body = etree.Element("body")
html.append(body)
title.text = "oeasy"
h1 = etree.Element("h1")
body.append(h1)
h1.tail =  "o2z"
print(etree.tostring(html,pretty_print=True).decode("utf-8"))
h1.tail = ""
print(etree.tostring(html,pretty_print=True).decode("utf-8"))
```

- h1.tail = ""
- å¯ä»¥è®©è¿™ä¸ª tail æˆå‘˜å˜æˆä¸€ä¸ªç©ºä¸²

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220912-1662978254853/wm)

- é‚£ h1 å…ƒç´ åé¢å°±æ²¡æœ‰é™„åŠ çš„å­—ç¬¦ä¸²äº†
- å¯ä»¥ç›´æ¥æŠŠæ‰€æœ‰çš„æ–‡æœ¬éƒ½ç­›å‡ºæ¥ä¹ˆï¼Ÿ


### è½¬åŒ–ä¸ºæ–‡æœ¬

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210901-1630462753784)

- çœ‹èµ·æ¥è¿™å°±æ˜¯ä¸æ˜¾ç¤ºæ ‡ç­¾
- åªæ˜¾ç¤º text å’Œ tail çš„æ ·å­
- è‡ªå·±åŠ¨æ‰‹è¯•è¯•

### åŠ¨æ‰‹

```
from lxml import etree
html = etree.Element("html")
head = etree.Element("head")
html.append(head)
title = etree.Element("title")
head.append(title)
body = etree.Element("body")
html.append(body)
title.text = "oeasy"
h1 = etree.Element("h1")
body.append(h1)
h1.text = "o3z"
h1.tail = "o2z"
b_text = etree.tostring(html,method="text")
print(b_text)
print(b_text.decode("utf-8"))
```

- ç¡®å®å¦‚æ­¤
  - åœ¨ etree.tostring()å‡½æ•°ä¸­ä½¿ç”¨
  - method = "text" å‚æ•°å¯ä»¥åªè¾“å‡ºæ–‡æœ¬
  - è€Œä¸è¾“å‡ºæ ‡ç­¾

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220912-1662978146602/wm)


## æ€»ç»“

- äº†è§£ etree ä¸­çš„å…ƒç´ çš„æ–‡æœ¬æˆå‘˜å˜é‡
  - text - æ–‡æœ¬ - å­—ç¬¦ä¸²ç±»å‹
  - tail - è¿½åŠ æ–‡æœ¬ - å­—ç¬¦ä¸²ç±»å‹
- å°±åƒåŸæ¥å­¦çš„ etree å…ƒç´ ä¸­çš„æˆå‘˜å˜é‡
  - tag - æ ‡ç­¾ - å­—ç¬¦ä¸²ç±»å‹
  - attrib - å±æ€§ - å­—å…¸ç±»å‹
- etree.tostring() å‡½æ•°æœ‰ä¸€äº›å‚æ•°å¯ä»¥æ§åˆ¶è¾“å‡ºç»“æœ
  - method = "text" å¯ä»¥æ§åˆ¶è¾“å‡ºç»“æœåªåŒ…å« text å’Œ tail
  - with_tail = False å¯ä»¥æ§åˆ¶è¾“å‡ºç»“æœä¸åŒ…å« tail
  - pretty_print = True å¯ä»¥æ§åˆ¶è¾“å‡ºç»“æœåŒ…å«ç¼©è¿›ä¿¡æ¯
- æˆ‘ä»¬å·²ç»åœ¨å†…å­˜æ„å»ºäº†ä¸€æ£µæ ‘äº†
	- ä½†æ˜¯å¦‚ä½•éå†è¿™æ£µæ ‘(etree)å‘¢ï¼ŸğŸ¤”
- ä¸‹æ¬¡å†è¯´
