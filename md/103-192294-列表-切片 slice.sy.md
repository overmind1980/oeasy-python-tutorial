---
show: step
version: 1.0
enable_checker: true
---

# 列表 - 构造

## 回忆

- 这次我们了解了列表的运算
- 赋值运算
  - 本质是把 heap 区中的列表对象地址付给对方
  - 可以用 copy 新建一个浅 copy 再赋给变量
  - 拷贝是明白了
  - 不过浅是什么意思还不清楚
- 加法
  - 加法的本质是在 heap 区中新建列表完成加法
  - =把加法的结果赋给变量
  - 也可以用 extend 在当前列表位置继续添加列表项
- 乘法
  - 乘法的本质是累加
  - 结果也是放在 heap 区
  - 可以被赋值给变量
- 加法乘法都是让列表变长
- 可以让列表变短吗？🤔

### 原始

- 原始的添加是 append
- 而删除是 remove
- 可以从列表中删除列表项
- 可以从列表中删除列表么？

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210829-1630223724710)

- 只能一个个地删除列表项
- 可以截取的方法么？
- 查帮助

### 帮助

- 游乐场的帮助来自于源代码中的注释
- 可以搜索在线帮助
- https://docs.python.org
  - 搜索 list

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210829-1630224275258)

- 前两个是判断
  - x 是否是 s 中的列表项
- 然后是加法和乘法
- 然后是索引
  - 得到第 i 个元素
- 中括号里有冒号是什么意思
- 试试看

### 切片 slice

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210829-1630224473649)

- 切片有两个点
  - 开始
  - 结束
- 前闭后开
  - 开始点是包括的
  - 结束点是不包括的
- 所以是从第 0 个元素到第 2 个元素
  - 第 0 个元素 `o` 是包括的
  - 第 1 个元素 `e` 是包括的
  - 第 2 个元素 `a` 是不包括的
  - 前闭后开么！
  - 所以结果是['o', 'e']
- 如果字符串中出现需要转义的字符应该如何呢？

### 需要转义的字符

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20211128-1638072578460)

- 究竟什么是切片呢？

### 切片词源

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210829-1630225342064)

- 把一个整体切分成一个个切片
- 就像切片面包

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210829-1630225319763)

- 整体是一个列表
- 可以切得厚一点么？

### 切片

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220805-1659704814872)

- 就像吃鱼一样

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220805-1659704882370)

- 切头去尾

### 尝试

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210829-1630240265318)

- 好像最后一片面包就是拿不到？
- 怎么办
- 松手

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210829-1630240308946)

- 后面是一个开区间
- 无论多么努力都是不包含在内的
- 干脆松手
- 反而得到了
- 既然 stop 可以空
- 那么 start 可以空么？

### 空

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210829-1630240411007)

- 前面可以空
- 后面可以空
- 前面后面都可以空
- 空生万有
- 这个切片操作会对原来的列表有影响么？

### 给切片赋值

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210914-1631579164716)

- 影响切片就是在影响整个列表

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210914-1631579235433)

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210914-1631579241729)

- 但如果我把切片信息给一个新的列表呢？

### 用切片赋值

- 观察
- 在堆空间中新分出一块区域
- 然后建立一个新的列表

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210829-1630224691821)

- 切片的结果如果赋值给其他变量
- 就会有一个新列表变量指向他
- 否则就会消失
- 而且 stop 后面还可以跟冒号
- 后面再跟变量
- 怎么玩

### 步长 step

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210829-1630224932111)

- 这三个值是
  - 开始值 包括
  - 结束值 不包括
  - 步长值 递增的大小

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210829-1630225019589)

- 步长可以为 0 么？

### 步长为 0

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210914-1631576294168)

- 出现了 ValueError 切片步长不能为 0
- 那步长可以是负数么？

### 步长为负

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210914-1631577940680)

- 步长为-1 是无法从 1 到 5 的
- 但是步长是-1 可以从 5 到 1
- 前闭后开
- 步长为负可以省略么？

### 省略

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210914-1631578216063)

- 步长为负的话
- 默认开头是最后一个
- 默认结尾是第一个
- 也是前闭后开
- 可以对切片做什么操作么？

### 删除切片

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210829-1630225977700)

- 删除选中的切片
- 切片中的列表项都抽出来
- 删除了
- 删除支持步长么？

### 步长删除

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210829-1630226071101)

- 看样子是支持的
- 字符串也支持切片么？

### 字符串切片

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210829-1630225112883)

- 也支持！
- 从汇编角度如何理解呢？

### 汇编指令

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220801-1659343895282)

- 有一个专门的BUILD_SLICE指令
	- 指令带有三个参数

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220801-1659343903464)

- 字符串切片也能删除么？

### 字符串切片删除

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210829-1630226145924)

- 也支持
- 只要是序列类的容器
- 貌似就支持切片类似的操作

### 字符串切片练习

- 找到一个网页链接的语句
- 然后进行切片
- 把超链接提取出来
- 先找到`http://`的位置
  - 9
- 然后找到`http://`的位置后面的引号的索引
  - 25
- 这样我们就获得了切片的位置

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220414-1649940855107)

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220414-1649940878106)

- 我们也可以把协议和网址分离

### 继续切片

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210914-1631578538762)

- 其中 7 来自 http://
  - 总共 7 个字符
- 这样可以分离出协议 Protocol 和网址 url
- 不止这样
- 所有的字符串都可以通过切片来切分开
- 整个 python 就是通过词法分析器
- 切分为一个个的单词的

### 分词到语法树

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210914-1631578760581)

- array[index] = (index + 4) \* (2 + 6)
- 看起来简单的一个赋值表达式
- 其实也要从单词到语法进行分析
- 才能执行

### find

- find 类似于 index

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210905-1630833189048)

- 好像是一模一样？

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210905-1630833204046)

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210905-1630833234959)

- 功能一模一样
- 出错处理有差别
  - index 找不到子串时抛出 ValueError 错误
  - find 失败后返回 -1
- find 看起来比较温和
- index 看起来更加刚猛一点
- 弥乐佛负责公关，笑迎八方客，于是香火大旺
- 韦陀铁面无私，锱珠必较，则让他负责财务，严格把关

### 总结

- 这次我们了解了切片操作
- 切片和索引有点像
- 索引得到的是一个列表项
- 切片得到的是一个列表
  - 里面有很多列表项
- 切片主要有三个要素
  - 开始 包括在内
  - 结束 不包括在内
  - 步长 递增步长
- 还可以删除切片
  - del
- 列表还有什么操作吗？🤔
- 下次再说 👋
