---
show: step
version: 1.0
enable_checker: true
---

# lxml å…ƒç´  æ ‘å½¢ç»“æ„

## å›å¿†

- å¯¼å…¥äº† requests æ¨¡å—
	- requests å¸®æˆ‘ä»¬ å‘è¯·æ±‚	
- è¿™æ · æˆ‘ä»¬å°±å¯ä»¥
	- å‡è£…è‡ªå·±æ˜¯ä¸€ä¸ªæµè§ˆå™¨
	- å®Œæˆäº† http get çš„è¿‡ç¨‹
	  - å‘å‡ºäº† request
	  - å¾—åˆ°äº† response
	  - çŠ¶æ€ç  200
- ä½†æ˜¯è¯»åˆ°çš„å†…å®¹æ˜¯
  - resposne.content å­—èŠ‚åºåˆ—
  - resposne.text å­—ç¬¦ä¸²åºåˆ—
- å¦‚ä½•è§£æ html è¯­è¨€å‘¢ï¼ŸğŸ¤”

### åˆ†æ

- æƒ³è¦è§£æ html
	- é‚£é¦–å…ˆå°±è¦äº†è§£ html è¯­è¨€çš„ç»“æ„
- `html`å…¨ç§°
	- `h`yper-`t`ext `m`arkup `l`anguage
	- è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€
    - æ˜¯ä¸€é—¨ markup(æ ‡è®°æ€§) çš„è¯­è¨€
- `markup` æ˜¯
	- é  `html` å…ƒç´  
	- å®ç°çš„

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210901-1630451887662)

- å…ƒç´  ä½¿ç”¨çš„ `æ ‡ç­¾(tag)` åŒ…æ‹¬
  - å¼€å§‹æ ‡ç­¾
  - ç»“æŸæ ‡ç­¾
- æ ‡ç­¾æ˜¯æˆå¯¹å„¿å‡ºç°çš„

### å®ä¾‹

- F12 å¯ä»¥æ£€æŸ¥å…ƒç´ 
	- ä¹Ÿå¯ä»¥å³é”®å…¨éƒ¨å±•å¼€
	- è¿™å°±æ˜¯ä¸€æ£µæ ‘

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210901-1630452159874)

- ä¸€æ£µä»€ä¹ˆæ ‘ï¼Ÿ

### Domæ ‘

- ä¸€æ£µ Dom æ ‘

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221119-1668823401607)

- ä»€ä¹ˆæ˜¯ Dom æ ‘å‘¢ï¼Ÿ

### Dom æ ‘

- Document Object Model
  - æ–‡æ¡£å¯¹è±¡æ¨¡å‹

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210901-1630453123602)

- æ ¹èŠ‚ç‚¹ æ˜¯ 
	- htmlå…ƒç´ 
- htmlå…ƒç´  é•¿å‡ºä¸¤ä¸ªåˆ†æ”¯
  - headå…ƒç´ 
  - bodyå…ƒç´ 
- ä»–ä»¬ å„è‡ªåº•ä¸‹
	- è¿˜æœ‰ å­èŠ‚ç‚¹ 

### æ¸²æŸ“è¿‡ç¨‹

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221119-1668824125270)

- response åˆ°è¾¾æµè§ˆå™¨å
  - é¦–å…ˆéœ€è¦åˆ†è¯ parse
  - ç„¶åæ ¹æ®è¯­ä¹‰ semantic
  - å°è¯•ç”Ÿæˆä¸€æ£µ dom è¯­ä¹‰æ ‘
  - ç„¶åå†æ ¹æ® css æ ·å¼è¡¨
  - ä¸€æ­¥æ­¥åœ°è¿›è¡Œæ¸²æŸ“æˆä¸€ä¸ªå¥½çœ‹çš„é¡µé¢

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221119-1668824141134)

- çˆ¬è™«ä¹Ÿéœ€è¦æ¸²æŸ“å—ï¼Ÿ

### çˆ¬è™«

- çˆ¬è™«åªçœ‹å†…å®¹
	- ä¸éœ€è¦æ¸²æŸ“
  - ä½† ä¹Ÿéœ€è¦ ç”Ÿæˆ domæ ‘

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221119-1668824279118)

- æ€ä¹ˆ ç”Ÿæˆ å‘¢ï¼Ÿ
  - å¼•å…¥ä¸€ä¸ªåŒ…

### lxml

- è¿™æ˜¯ç›®å‰åˆ†æ html æœ€å¥½çš„åŒ…
  - lxml
  - æ˜¯ç¬¬ä¸‰æ–¹çš„åŒ…

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210901-1630453359293)

- å“ªé‡ŒæŸ¥è¯¢å¸®åŠ©å‘¢ï¼Ÿ

### æœç´¢

- åœ¨ç™¾åº¦æœç´¢lxml
	- lxmlæ˜¯ä¸€ä¸ªå¼€æºçš„é¡¹ç›® 
    - http://lxml.de
	- github çš„åœ°å€ä¹ŸæŒ‡å‘è¿™é‡Œ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210901-1630453447141)


- lxml æ˜¯ å¤„ç† xml çš„ liberay
  - l çš„æ„æ€æ˜¯ library
  - xml çš„æ„æ€å°±æ˜¯ e`x`tensible `m`arkup `l`anguage

### æ‰“å¼€lxml.de

- lxml 
    - ç”¨ c è¯­è¨€å†™äº†
	- é«˜æ•ˆçš„ libxml2 å’Œ libxslt ä¸¤ä¸ªç±»åº“
	- å¹¶å°è£…æˆçš„ api
  - ä½¿ç”¨ python çš„ç®€æ´è¯­æ³•è°ƒç”¨
  - ç”Ÿæˆè‘—åçš„ ElementTree

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210901-1630453454445)

- ä»–å¯ä»¥è§£æ xml
  - ä¹Ÿå¯ä»¥è§£æ html
  - æ¯•ç«Ÿéƒ½æ˜¯ ml(Markup Language)
  - æ ‘å‹ç»“æ„

### tutorial

- è¿›å…¥æ•™ç¨‹

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210901-1630453747733)

- æœ¬æ¥æƒ³ç€æ˜¯ 
	- è¯»å–ä¸€ä¸ªç½‘é¡µæ–‡ä»¶
	- ç„¶åå†ç”Ÿæˆæ ‘
- ä½†æ˜¯ ç›®å‰çœ‹èµ·æ¥çš„æ€è·¯ æ˜¯
	- åœ¨å†…å­˜é‡Œç›´æ¥ é€šè¿‡è°ƒç”¨å‡½æ•° ç”Ÿæˆæ ‘
	- ç„¶å å† å¤„ç†è¿™æ£µæ ‘
- æ ‘å˜›
	- é¦–å…ˆè¦æœ‰æ ‘æ ¹èŠ‚ç‚¹

### æ‰æ ¹

- etree çš„æ„æ€æ˜¯
  - element tree
  - å…ƒç´ æ ‘
- å…ƒç´ æ ‘æ ‘æ˜¯
	- ç”±å…ƒç´ èŠ‚ç‚¹æ„æˆçš„

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221119-1668824641142)

- å“ªä¸ªå…ƒç´ 
	- æ˜¯æ•´æ£µæ ‘çš„æ ¹å‘¢ï¼Ÿ

### htmlå…ƒç´ 

- è·å¾—èŠ‚ç‚¹çš„æ–¹å¼æ˜¯
  - etree.Element("html")
- æˆ‘ä»¬çŸ¥é“ html å…ƒç´  
	- æ˜¯ç½‘é¡µæ–‡æ¡£çš„æ ¹
    - æ‰€æœ‰å…¶ä»–å…ƒç´ çš„æ ¹
    - ä¹Ÿæ˜¯ ä»æ— åˆ°æœ‰ç”Ÿæˆè¿™æ£µæ ‘çš„æ ¹

```
from lxml import etree
et_html = etree.Element("html")
print("et_html", et_html)
print("et_html.tag", et_html.tag)
```

- å˜é‡åæ˜¯ et_html
  - et ä»£è¡¨ä»–æ˜¯ element_treeèŠ‚ç‚¹ ç±»å‹çš„
  - html ä»£è¡¨ä»–æ˜¯ html æ ¹èŠ‚ç‚¹

### è¿è¡Œç»“æœ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221119-1668824985944)

- è¿è¡Œç»“æœ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221119-1668824997169)

- å…ˆæŠŠ æ ¹æ‰ä¸‹ä¹‹å
  - éœ€è¦ å¼€ææ•£å¶

### å¼€æ

```
from lxml import etree
et_html = etree.Element("html")
et_body = etree.Element("body")
print("et_html:", et_html)
print("et_html.tag:", et_html.tag)
print("et_body:", et_body)
print("et_body.tag:", et_body.tag)
```

- è¿™æ¬¡æœ‰äº†ä¸¤ä¸ªèŠ‚ç‚¹
	- et_html
	- et_body

- ç»“æœ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221119-1668825158114)

- ä½†æ˜¯htmlèŠ‚ç‚¹å’ŒbodyèŠ‚ç‚¹çš„å…³ç³»
	- æ€ä¹ˆä½“ç°å‘¢ï¼Ÿï¼Ÿ

## æ€»ç»“

- äº†è§£äº† html ä¸­çš„ dom æ ‘
- domæ ‘ æ˜¯ ç”±èŠ‚ç‚¹å…ƒç´ ç»„æˆçš„
- èŠ‚ç‚¹å…ƒç´ å¯ä»¥ç”¨ etree.Element()å¾—åˆ°
  - æœ€æ ¹æœ¬çš„ æ˜¯ æ ¹å…ƒç´ 
  - ç½‘é¡µæ–‡ä»¶çš„æ ¹å°±æ˜¯ htmlå…ƒç´ 
- html é‡Œé¢åŒ…æ‹¬å­èŠ‚å…ƒç´ ç‚¹
  - head
  - body

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210901-1630453123602)

- å¦‚ä½•å»ºç«‹èŠ‚ç‚¹ä¹‹é—´çš„çˆ¶å­å…³ç³»å‘¢ï¼ŸğŸ¤”
- ä¸‹æ¬¡å†è¯´
