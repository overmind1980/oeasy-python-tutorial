---
show: step
version: 1.0
enable_checker: true
---

# è¯­æ³• html éå†

## å›å¿†

- äº†è§£ etree ä¸­çš„å…ƒç´ çš„æ–‡æœ¬æˆå‘˜å˜é‡
  - text - å­—ç¬¦ä¸²ç±»å‹
  - tail - å­—ç¬¦ä¸²ç±»å‹
- å°±åƒåŸæ¥å­¦çš„ etree å…ƒç´ ä¸­çš„æˆå‘˜å˜é‡
  - tag - å­—ç¬¦ä¸²ç±»å‹
  - attrib - å­—å…¸ç±»å‹
- è¿˜å¯ä»¥è®¾ç½® etree å…ƒç´ çš„æˆå‘˜å˜é‡ text
- tostring å‡½æ•°æœ‰ä¸€äº›å‚æ•°å¯ä»¥æ§åˆ¶è¾“å‡º
  - method = "text" å¯ä»¥æ§åˆ¶è¾“å‡ºç»“æœåªåŒ…å« text å’Œ tail
  - with_tail = False å¯ä»¥æ§åˆ¶è¾“å‡ºç»“æœä¸åŒ…å« tail
  - pretty_print = True å¯ä»¥æ§åˆ¶è¾“å‡ºç»“æœåŒ…å«ç¼©è¿›ä¿¡æ¯
- æˆ‘ä»¬å·²ç»åœ¨å†…å­˜æ„å»ºäº†ä¸€æ£µæ ‘äº†
- ä½†æ˜¯å¦‚ä½•éå†è¿™æ£µæ ‘å‘¢ï¼ŸğŸ¤”

### xpath

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210901-1630463341760)

- "string()"å¯ä»¥å¾—åˆ°æ ¹èŠ‚ç‚¹çš„æ–‡æœ¬
- "//text()"å¯ä»¥å¾—åˆ°å…ƒç´ æ–‡æœ¬çš„åˆ—è¡¨

### å¾—åˆ°æ–‡æœ¬

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210901-1630463370460)

- çœ‹èµ·æ¥
  - ä¸€ä¸ªå¾—åˆ°çš„æ˜¯æ‹¼æ¥èµ·æ¥çš„å­—ç¬¦ä¸²
  - å¦ä¸€ä¸ªå¾—åˆ°çš„æ˜¯å­—ç¬¦ä¸²åˆ—è¡¨

### éå†æ‰€æœ‰èŠ‚ç‚¹

- etree.Elementå‡½æ•°
	- ä½œç”¨æ˜¯æ„å»ºetreeçš„Element
- etree.SubElementå‡½æ•°
	- ä½œç”¨æ˜¯æ„å»ºetreeçš„Element
	- å¹¶ä¸”æŠŠæ–°å»ºçš„Elementæ·»åŠ åˆ°ç›®å‰å…ƒç´ ä¸‹é¢
	- ä¹Ÿå°±æ˜¯è¯´æ–°å…ƒç´ æ˜¯æŸä¸ªè€å…ƒç´ çš„å­å…ƒç´ 

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210901-1630463450183)

- etree.Element ç±»å¯ä»¥æœ‰å¾ˆå¤š Element å­å¯¹è±¡
- å¯ä»¥ç”¨ for è¯­è¨€æ¥éå† Element çš„å­å¯¹è±¡

### iter()å‡½æ•°éå†æ‰€æœ‰å­å…ƒç´ 

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210901-1630463551258)

- æˆ‘ä»¬ä½¿ç”¨ iter å‡½æ•°
  - é€’å½’åœ°éå†äº†ä¸€éæ ¹å…ƒç´ å’Œå„å­å…ƒç´ èŠ‚ç‚¹
    - ä»æ ¹å¼€å§‹
    - ç„¶åéå†ä¸¤ä¸ªæ ¹çš„å­å…ƒç´ 
    - ç„¶åé€’å½’é€’éå†å­å…ƒç´ é‡Œé¢çš„å­å…ƒç´ 
- è¾“å‡ºå…ƒç´ æ—¶
  - è¾“å‡ºæ ‡ç­¾å
  - è¾“å‡ºæ–‡æœ¬
- è¿™å‡½æ•°çš„è¿”å›å€¼æ˜¯ä»€ä¹ˆç±»å‹çš„å‘¢ï¼Ÿ

### iter()ç±»å‹

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20211106-1636195524938)

- è¿™ä¸ªä¸œè¥¿çš„ç±»å‹æ˜¯ä¸€ä¸ªæ·±åº¦ä¼˜å…ˆè¿­ä»£å™¨
- ä»€ä¹ˆæ˜¯æ·±åº¦ä¼˜å…ˆï¼Ÿ

### æ·±åº¦ä¼˜å…ˆ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210901-1630463551258)

- è§åˆ°èŠ‚ç‚¹å…ˆå¾€æ·±é‡Œèµ°
  - è€Œä¸æ˜¯å…ˆå¾€å¹¿é‡Œèµ°
- å’Œæ·±åº¦ä¼˜å…ˆç›¸å¯¹çš„æ˜¯å¹¿åº¦ä¼˜å…ˆ

### ç­›é€‰æ ‡ç­¾

- iter("child")å¯ä»¥éå†æ‰€æœ‰æ ‡ç­¾æ˜¯ child çš„å­å…ƒç´ 

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210901-1630463660607)

### å¢åŠ ç­›é€‰æ ‡ç­¾

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20211106-1636195307288)

- root.iter("child","another")ç­›é€‰è¿™ä¸¤ä¸ª tag çš„æ‰€æœ‰å…ƒç´ 
  - ç„¶åéå†

### åŠ¨æ‰‹

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210901-1630463683785)

- ä½ èƒ½å¤Ÿæƒ³è±¡å‡º iter æ–¹æ³•çš„å®ç°çš„å…·ä½“ä»£ç å—ï¼Ÿ

### å®ä½“å’Œæ³¨é‡Š

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210901-1630463857945)

- ä¸º root å…ƒç´ å¢åŠ äº†ä¸¤ç±»å¯¹è±¡
  - etree.Entity("#234") å®ä½“
  - etree.Comment("some comment") æ³¨é‡Š
  - è¿˜æœ‰åŸæ¥çš„etree.Element("h1")
- root å…ƒç´ æœ¬èº«æ˜¯ etree.Element å¯¹è±¡
- Entity å’Œ Comment æ˜¯ä¸¤ç±»å¯¹è±¡
  - ä½œä¸º root å…ƒç´ çš„å­å¯¹è±¡
    - å¯ä»¥éå†
  - ä½†æ˜¯ä¸å±äº etree.Element å…ƒç´ ç±»çš„å¯¹è±¡
- iter()å‡½æ•°ä¸­ç”¨å‚æ•° tag=etree.Element å¯ä»¥è¿›è¡Œç­›é€‰
- Entity å…ƒç´ æœ¬èº«åªåŒ…å«
  - text æˆå‘˜
- Comment å…ƒç´ åŒ…å«
  - å¤´å°¾çš„æ³¨é‡Šæ ‡è®°
  - å…·ä½“çš„æ³¨é‡Šå†…å®¹

### æ·»åŠ å®ä½“

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210901-1630463996964)

### éå†å…ƒç´ å’Œå®ä½“

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210901-1630464157409)

- iter()å‡½æ•°çš„å‚æ•°
  - tag=etree.Entity - ç­›é€‰å‡º Entity å®ä½“å¯¹è±¡
  - tag=etree.Element - ç­›é€‰å‡º Element å…ƒç´ å¯¹è±¡
  - tag=etree.Comment - ç­›é€‰å‡º Comment æ³¨é‡Šå¯¹è±¡
- ç°åœ¨å¯ä»¥åœ¨å†…å­˜é‡Œç”Ÿæˆæ“ä½œè¿™é¢— etree æ ‘äº†
- å¯æ˜¯æ€ä¹ˆé€šè¿‡ç½‘ä¸Šçˆ¬åˆ°çš„ html æ–‡ä»¶ç”Ÿæˆ etree æ ‘å‘¢ï¼Ÿ

## æ€»ç»“

- å·²ç»åœ¨å†…å­˜æ„å»ºäº†ä¸€æ£µ etree æ ‘äº†
- æ ‘æ˜¯ç”±èŠ‚ç‚¹ Element æ„æˆçš„
- é™¤äº† etree.Element èŠ‚ç‚¹ä¹‹å¤–ï¼Œè¿˜æœ‰
  - etree.Entity
  - etree.Comment
- Element å…ƒç´ æœ€é‡è¦ï¼Œä»–çš„æˆå‘˜æœ‰:
  - attrib å±æ€§å­—å…¸
  - text å…·ä½“æ–‡æœ¬
  - tail åè·Ÿæ–‡æœ¬
  - tag æ ‡ç­¾
  - iter() è¿­ä»£å™¨å‡½æ•°
    - å¯ä»¥ç”¨ for éå†è¿­ä»£å™¨å‡½æ•°
    - å‚æ•° tag=etee.Element å¯ä»¥ç±»å‹è¿›è¡Œç­›é€‰
- ä½†æ˜¯ç½‘ä¸Šçˆ¬åˆ°çš„ç½‘é¡µæºæ–‡ä»¶çš„ response åªæœ‰å­—èŠ‚åºåˆ—
  - å¦‚ä½•é€šè¿‡å­—èŠ‚åºåˆ—å¾—åˆ°ä¸€æ£µ etree æ ‘å‘¢ï¼ŸğŸ¤”
- ä¸‹æ¬¡å†è¯´
