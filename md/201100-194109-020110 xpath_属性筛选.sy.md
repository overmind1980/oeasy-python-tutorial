---
show: step
version: 1.0
enable_checker: true
---

# è¯­æ³• html ç”Ÿæˆ
## å›å¿†
- ä¸Šæ¬¡æ·±å…¥äº†xpath
- xpathå¯ä»¥ç”¨æ¥ç­›é€‰xmlæ–‡ä»¶ä¸­çš„èŠ‚ç‚¹
- xpathæœ‰ä¸€å¥—è‡ªå·±çš„è¯­æ³•
	- nodename ç›´æ¥å­èŠ‚ç‚¹
	- /åœ¨æœ€å‰é¢æ˜¯æ ¹ä¸‹çš„æ„æ€
	- /åœ¨ä¸­é—´æ˜¯ç›®å½•ä¸‹çš„æ„æ€
	- //å­å­™ç»“ç‚¹
	- . å½“å‰èŠ‚ç‚¹
	- .. å‘ä¸Šä¸€å±‚èŠ‚ç‚¹
	- @ å±æ€§
- è¿™ä¸ªå±æ€§æˆ‘ä»¬è¿˜æ²¡æœ‰è¯•è¯•
- æ€ä¹ˆç”¨å‘¢ï¼ŸğŸ¤”

### ä¿®æ”¹ç½‘é¡µ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210902-1630552088832)


### æ£€æŸ¥å…ƒç´ 

- åœ¨æµè§ˆå™¨ä¸­é€‰ä¸­å…ƒç´ 
- ç„¶åå³é”® `æ£€æŸ¥å…ƒç´ `

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210902-1630552096699)

### ä¿®æ”¹ä»£ç 

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210902-1630552149907)

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210902-1630552158701)

- ç¬¬7è¡Œæ²¡æœ‰é—®é¢˜
- ç¬¬9è¡Œå‡ºç°äº†é—®é¢˜
- xpathèƒ½å¤Ÿæ‰¾åˆ°äº›ä»€ä¹ˆ
- ä½†æ˜¯æ‰¾åˆ°çš„ä¸œè¥¿æ²¡æœ‰tag

### å†æ”¹ä»£ç 

```
import requests
from lxml import etree
response = requests.get("http://localhost/oeasy.html")
s_html = response.content
#print(s_html)
et_html = etree.HTML(s_html)
et_target = et_html.xpath("//@lang")
for value in et_target:
    print(value)
```

- è¿è¡ŒæˆåŠŸ


![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210902-1630552310013)

- æ‰¾åˆ°ç›¸åº”çš„å±æ€§å€¼
- è¿™æ ·æˆ‘ä»¬å°±æˆåŠŸæ‹¿åˆ°äº†Elementå…ƒç´ çš„
- å±æ€§attribçš„
- å…³äºlangè¿™ä¸ªkeyçš„value
- å¯æ˜¯ä»–æ˜¯æ€ä¹ˆæ‹¿åˆ°çš„å‘¢ï¼Ÿ

### ä»£ç åˆ†æ
```
et_target = et_html.xpath("//@lang")
```

- et_htmlæ˜¯æ ¹å…ƒç´ 
- //æ˜¯æ‰¾ä¸‹é¢æ‰€æœ‰å­å­™
- @è¯´æ˜æ‰¾çš„ä¸æ˜¯Elementå…ƒç´ 
- @è¯´æ˜èŠ±aæ‰¾çš„æ˜¯Attributeå±æ€§
- å±æ€§çš„åå­—å«åšlang
- è¿™æ ·æ‰å¾—åˆ°langå±æ€§çš„å€¼
- è¿˜æœ‰ä»€ä¹ˆå¯ä»¥æ‰¾åˆ°çš„ä¸œè¥¿ä¹ˆï¼Ÿ

### è°“è¯­  predicates

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210902-1630552360248)

- æˆ‘ä»¬é’ˆå¯¹ä¸€æ¡æ¡çš„éƒ½è¯•è¯•

### å°è¯•

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210902-1630553027505)

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210902-1630553079798)

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210902-1630553178100)

- et_target = et_html.xpath("//ul/li[1]")
- li[0]æ‰¾ä¸åˆ°
- etreeçš„å­å…ƒç´ ç¼–å·æ˜¯ä»1å¼€å§‹çš„
- li[1]æ‰¾åˆ°ç¬¬ä¸€ä¸ªå…ƒç´ 
- æ³¨æ„è¿™é‡Œè¾“å‡ºçš„æ˜¯text

### æœ€åä¸€ä¸ª
![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210902-1630553027505)

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210902-1630553237854)

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210902-1630553305681)

- et_target = et_html.xpath("//ul/li[last()]")
- å¯ä»¥æ‰¾åˆ°æœ€åä¸€ä¸ªèœ
	- æŠ˜è€³æ ¹

### å€’æ•°ç¬¬äºŒ last()-1
![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210902-1630553027505)

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210902-1630553455827)

- et_target = et_html.xpath("//ul/li[last()-1]")
- å¯ä»¥æ‰¾åˆ°å€’æ•°ç¬¬äºŒä¸ªèœ
	- ç¾Šç˜ªæ±¤

### å‰ä¸¤å position
![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210902-1630553027505)

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210902-1630553841920)

- et_target = et_html.xpath("//ul/li[position()<3]")
- å¯ä»¥æ‰¾åˆ°å‰ä¸¤é¡¹
- å¦‚æœæˆ‘æƒ³æ‰¾åä¸¤é¡¹å‘¢ï¼Ÿ

### åä¸¤é¡¹ é…åˆ
![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210902-1630553027505)

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210902-1630554055572)

- et_target = et_html.xpath("//ul/li[position()>last()-2]")
- å¯ä»¥æ‰¾åˆ°åä¸¤é¡¹ 


### å±æ€§æ˜¯å¦å­˜åœ¨
![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210902-1630553027505)

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210902-1630554130261)

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210902-1630554342781)

- et_target = et_html.xpath("//html[@lang]")
- et_target = et_html.xpath("//ul[@id]")
- et_target = et_html.xpath("//body[@class]")
- éƒ½å¯ä»¥è¯•è¯•ğŸ¤ª

### å±æ€§å†…å®¹
![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210902-1630553027505)

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210902-1630554498481)

- et_target = et_html.xpath("//html[@lang=\"eng\"]")
	- æ‰¾ä¸åˆ°
- et_target = et_html.xpath("//html[@lang=\"zh-cn\"]")
	- å¯ä»¥æ‰¾åˆ°

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210902-1630554794130)

- et_target = et_html.xpath("//ul[@id=\"ulist\"]")
- å¯ä»¥è¯•è¯•

### æ€»ç»“

- è¿™æ¬¡æ·±å…¥äº†xpathä¸­å…³äºå±æ€§çš„é€‰æ‹©
- @ å°±æ˜¯â€a
- å¯¹åº”@ttribute
- å¯ä»¥æ‰¾å‡ºæ˜¯å¦æœ‰è¿™ä¸ªå±æ€§
- ä¹Ÿèƒ½æ‰¾åˆ°å…·ä½“å±æ€§çš„å€¼
- xpathå¯ä»¥@æ¥æ ¹æ®å±æ€§è¿›è¡Œç­›é€‰
	- et_target = et_html.xpath("//ul[@lid=\"ulist\"]")
- xpathçš„æ–‡æ¡£è¿˜æ²¡æœ‰åˆ·å®Œ
- è¿˜æœ‰ä»€ä¹ˆå¥½ç©çš„å‘¢ï¼ŸğŸ¤”
- ä¸‹æ¬¡å†è¯´
