---
show: step
version: 1.0
enable_checker: true
---

# è®¾ç½®æ®µè½

## å›å¿†

- ä¸Šæ¬¡ç ”ç©¶äº†è¡¨æ ¼
	- ä»é›¶å¼€å§‹ ç”Ÿæˆè¡¨æ ¼
	- åœ¨pythonä¸­è¯»å–è¡¨æ ¼
- æœ€å åˆ¶ä½œäº†ä¹ä¹ä¹˜æ³•è¡¨
	- å¹¶ä¸”ä¸ºè¡¨æ ¼è®¾ç½®äº†è¡¨æ ¼æ ·å¼
- ç‚¹å‡»âš™ï¸é½¿è½®
	- é€‰æ‹©æ ·å¼style

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240308-1709877822757)

- å‘ç°å„ç§æ ·å¼styleå¾ˆå¤š
- å¯ä»¥ç”¨python
	- æŠŠæ‰€æœ‰æ ·å¼åˆ—å‡ºæ¥å—ï¼Ÿ

### åˆ—å‡ºæ‰€æœ‰æ ·å¼

```
from docx import Document
document = Document()
print(document.styles)
for style in document.styles:
    print(style)
```


- æœ€åŸºç¡€çš„æ ·å¼
	- å­—ä½“ç±»å‹æ ·å¼
	- CharacterStyle

- å­—ä½“æ ·å¼ åŒ…æ‹¬
	- å¤§å° 
	- é¢œè‰²
	- å­—ä½“
	- ç­‰ç­‰

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240309-1709948408405)

- å­—ä½“æ ·å¼ ä¹‹ä¸Š
	- æ˜¯ æ®µè½ æ ·å¼ç±»å‹

### æ®µè½ æ ·å¼

- é¦–å…ˆå‡ºç°çš„ å°±æ˜¯ 
	- æ®µè½ç±»å‹æ ·å¼
	- Paragraph Style

- æ®µè½æ ·å¼ åŒ…æ‹¬
	- æ®µå‰ æ®µå 
	- æ®µå·¦ æ®µå³
	- è¡Œé—´è·
	- é¦–è¡Œç¼©è¿›
	- ç­‰ç­‰

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240309-1709948364732)

- Normal æ˜¯ é»˜è®¤æ­£æ–‡æ ·å¼
- Header æ˜¯ é»˜è®¤æ ‡é¢˜æ ·å¼

### åˆ—è¡¨ç±»å‹

- åˆ—è¡¨ç±»å‹
	- æœ‰åºåˆ—è¡¨ Ordered List
	- æ— éœ€åˆ—è¡¨ Unordered List

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240309-1709949684591)

- æœ¬è´¨ä¸Šæ˜¯ä¸€ç§ 
	- æ®µè½ç±»å‹æ ·å¼
	- Paragraph Style

### è¡¨æ ¼

- è¡¨æ ¼æ ·å¼
	- Table Paragraph

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240309-1709950100052)

- å¯¹åº”å…·ä½“è¡¨æ ¼æ ·å¼

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240321-1711010364214)

- styleçš„ç±»å‹å¥½å¤šå•Š
	- æ€»å…±åˆ†å‡ ç±»å‘¢ï¼Ÿ

### æ ·å¼çš„åˆ†ç±»

- docx.enum.style.WD_STYLE_TYPE
	- æ˜¯æšä¸¾ç±»å‹
	- enum

```
from docx.enum.style import WD_STYLE_TYPE
print(WD_STYLE_TYPE)
for style in WD_STYLE_TYPE:
    print(style)
```

- æ€»å…±å››ç±»
	- å­—ç¬¦
	- åˆ—è¡¨
	- æ®µè½
	- è¡¨æ ¼

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240309-1709954963524)

- å¦‚ä½•ç”¨ python è®¾ç½®æ ·å¼å‘¢ï¼Ÿ

### è®¾ç½®æ ·å¼

- å°è¯•æ”¹å˜æ ·å¼

```
from docx import Document
document = Document()
paragraph = document.add_paragraph("oeasy")
print("style_name:",paragraph.style.name)
paragraph.style = document.styles['Heading 1']
print("style_name:",paragraph.style.name)
document.save("o.docx")
```

- è¾“å‡ºè¯æ˜
	- ä» Normal (é»˜è®¤æ­£æ–‡æ ·å¼)
	- å˜æˆäº† Heading 1 (æ ‡é¢˜ä¸€æ ·å¼)

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240309-1709955422082)

- Reloadé¡µé¢

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240309-1709955476037)

- ç¡®å®æ ·å¼æ›´æ–°äº†

### æ–°å»ºæ ·å¼

```
from docx.enum.style import WD_STYLE_TYPE
from docx import Document
document =Document()
styles = document.styles
style = styles.add_style('Citation', WD_STYLE_TYPE.PARAGRAPH)
print("style_name:",style.name)
print("style_type:",style.type)
paragraph = document.add_paragraph("oeasy")
paragraph.style = document.styles["Citation"]
document.save("o.docx")
```

- è¾“å‡ºç»“æœ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240309-1709957544152)

- çœŸçš„ä¼šå‡ºç°æ–°æ ·å¼å—ï¼Ÿ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240309-1709957795774)

- è¿™ä¸ªæ ·å¼ç»†èŠ‚å¦‚ä½•å‘¢ï¼Ÿ

### æ ·å¼ç»†èŠ‚

- ç‚¹å‡»å³ä¾§
	- è®¾ç½®âš™
	- é€‰æ‹©Stylesæ ·å¼
		- ï¸é€‰æ‹©æ–°æ ·å¼
		- Citation

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240309-1709957986920)

- è¿™ä¸ªæ ·å¼çš„ç»†èŠ‚å¦‚ä½•å‘¢ï¼Ÿ

### å°è¯•ä¿®æ”¹æ ·å¼

- å³é”®é€‰æ‹©æ–°æ ·å¼
	- Citation
	- é€‰æ‹© ä¿®æ”¹modify

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240309-1709958079750)

- å‡ºç°äº†å¾ˆå¤šé€‰é¡¹å¡

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240309-1709958118869)

- ç›®å‰ Inherit from ä¸º
	- None 
	- æ²¡æœ‰åŸºç¡€æ ·å¼
	- base style
- å¯ä»¥ä»æŸä¸ªå·²æœ‰çš„æ ·å¼
	- æ´¾ç”Ÿå‡ºæ–°æ ·å¼å—ï¼Ÿ

### åŸºç¡€æ ·å¼

```
from docx.enum.style import WD_STYLE_TYPE
from docx import Document
document =Document()
styles = document.styles
style = styles.add_style('Citation', WD_STYLE_TYPE.PARAGRAPH)
style.base_style = styles['Normal']
print("style_name:",style.name)
print("base_style_name:",style.base_style.name)
print("style_type:",style.type)
paragraph = document.add_paragraph("oeasy")
paragraph.style = document.styles["Citation"]
document.save("o.docx")
```

- è¾“å‡ºbase_style

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240309-1709958588704)

- File - Reload ä¹‹å
	- æŸ¥çœ‹æ ·å¼ç»†èŠ‚

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240309-1709958603912)

- Inherit from æ´¾ç”Ÿè‡ª
	- ä» None å•¥éƒ½æ²¡æœ‰
	- åˆ° Default Style é»˜è®¤æ ·å¼
- å¦‚ä½•åˆ é™¤æ ·å¼ï¼ŸğŸ¤”

### åˆ é™¤æ ·å¼

- å°è¯•
	- å…ˆæ·»åŠ  æ ·å¼ 
	- ååˆ é™¤ æ ·å¼

```
from docx.enum.style import WD_STYLE_TYPE
from docx import Document
document =Document()
styles = document.styles
print(len(styles))
style = styles.add_style('Citation', WD_STYLE_TYPE.PARAGRAPH)
print(len(styles))
styles['Citation'].delete()
print(len(styles))
```

- å¯ä»¥çœ‹åˆ° 
	- åŠŸèƒ½å·²ç»å®ç° 

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240309-1709959003580)

- æ€»å…±çœŸçš„æœ‰é‚£ä¹ˆå¤šç§æ ·å¼å—ï¼Ÿ

### è§‚å¯Ÿæ ·å¼çš„æ–¹å¼

- å°†è§‚å¯Ÿæ ·å¼çš„æ–¹å¼
	- ä» Hierarchy å±‚çº§å¼
	- ä¿®æ”¹ä¸º All æ‰€æœ‰æ ·å¼

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240309-1709977562085)

- ä½†æ˜¯å¿«é€Ÿæ ·å¼ä¸­
	- å¥½åƒæ²¡æœ‰é‚£ä¹ˆå¤šï¼Ÿ

### å¿«é€Ÿæ ·å¼

- å¿«é€Ÿæ ·å¼ 
	- è²Œä¼¼æ²¡æœ‰å‡ ç§

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240309-1709977660795)

- å¦‚ä½•è¿›å…¥å¿«é€Ÿæ ·å¼åˆ—è¡¨å‘¢ï¼Ÿ

### å¿«é€Ÿæ ·å¼

```
from docx import Document
document =Document()
styles = document.styles
for style in styles:
	if style.quick_style == True:
		print(style)
```

- å¿«é€Ÿæ ·å¼ 
	- æ˜¯ æ ·å¼ä¸­çš„ä¸€ä¸ªå­é›†

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240309-1709977990760)

- æ ·å¼ æœ‰ä»€ä¹ˆå±æ€§è¡Œä¸ºå‘¢ï¼Ÿ

### æ ·å¼ çš„ å±æ€§è¡Œä¸º

- https://python-docx.readthedocs.io/en/latest/dev/analysis/features/styles/style.html?highlight=style

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240328-1711628083919)

- å¯ä»¥å¯¹æ ·å¼åšé‚£äº›æ“ä½œå‘¢ï¼Ÿ

###  æ“ä½œ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240309-1709979099398)

- å¦‚ä½•æ“ä½œæ ·å¼å‘¢ï¼Ÿ

### å³é”®æ ·å¼

- å³é”®æ ·å¼

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240309-1709979140547)

- å¯ä»¥çš„æ“ä½œ
	- ä»¥ä»–ä¸ºåŸºç¡€æ–°å»ºæ ·å¼
	- ä¿®æ”¹æ ·å¼
	- åˆ é™¤æ ·å¼
	- éšè—æ ·å¼
- å¯ä»¥ç”¨ä»£ç ä¿®æ”¹æ ·å¼å—ï¼Ÿ

### é€šè¿‡æ ·å¼è®¾ç½®å­—ä½“

```
from docx.enum.style import WD_STYLE_TYPE
from docx.shared import Pt
from docx import Document
document =Document()
styles = document.styles
style = styles.add_style('Citation', WD_STYLE_TYPE.PARAGRAPH)
style.base_style = styles['Normal']
font = style.font
font.name = 'Calibri'
font.size = Pt(12)
print("style_font_name:",style.font.name)
print("style_font_size:",style.font.size)
paragraph = document.add_paragraph("oeasy")
paragraph.style = document.styles["Citation"]
document.save("o.docx")
```

- æŸ¥çœ‹è¾“å‡º

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240309-1709959621721)

- åœ¨è½¯ä»¶ä¸­Reload

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240309-1709959645614)

- ç¡®å®å¯ä»¥è®¾ç½®
- å¦‚æœæˆ‘ä»¬è¦
	- æå–docxä¸­æ‰€æœ‰`æ ‡é¢˜ä¸€`æ ·å¼çš„å­—ä½“
	- åº”è¯¥å¦‚ä½•å‘¢ï¼Ÿ

### å‡†å¤‡ç¯å¢ƒ

- ä¸­é—´æ·»åŠ  å›è½¦ åˆ’åˆ†æ®µè½
	- å°† Oeasyè®¾ç½®ä¸ºæ ‡é¢˜ä¸€
	- o2z è®¾ç½®ä¸ºæ­£æ–‡

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240329-1711678446997)

- ä¿å­˜å 
	- å‡†å¤‡è¯»å–

### è¯»å– æŒ‡å®šçš„æ ‡é¢˜

```
from docx import Document

document = Document("o.docx")
for paragraph in document.paragraphs:
    if paragraph.style.name == "Heading 1":
        print(paragraph.text)
document.save("o.docx")
```

- è¾“å‡ºç»“æœ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240329-1711678813178)

- é€šè¿‡è¾“å‡ºé‡å®šå‘
	- å°±å¯ä»¥ ç»™åˆ°æŒ‡å®šçš„æ–‡ä»¶äº†

## æ€»ç»“

- è¿™æ¬¡ç ”ç©¶äº†æ ·å¼
	- æ–°å¢æ ·å¼ add_style
	- åˆ é™¤style.delete()
	- ä¿®æ”¹æ ·å¼ style.font.name = "Calibri"
- å¯ä»¥é€šè¿‡ æ ·å¼ æ¥è®¾ç½®å­—ä½“
	- ä½†æœ‰çš„æ—¶å€™ 
	- ä¹Ÿå¯ä»¥ç›´æ¥è®¾ç½®æ–‡å­—çš„å­—ä½“

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240309-1709979714071)

- åŒä¸€ä¸ªæ®µè½
	- å¯ä»¥æœ‰ä¸åŒçš„å­—ä½“å¤§å°
- è¿™å¦‚ä½•ç†è§£å‘¢ï¼ŸğŸ¤”
- æˆ‘ä»¬ä¸‹æ¬¡å†è¯´ï¼ğŸ‘‹ğŸ»
