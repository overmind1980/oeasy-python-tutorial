---
show: step
version: 1.0
enable_checker: true
---

# è®¾ç½®æ®µè½

## å›å¿†

- ä¸Šæ¬¡æˆ‘ä»¬ç ”ç©¶çš„æ˜¯
	- é¡µçœ‰ header
- é¡µçœ‰
	- ä½äºé¡µé¢çš„ä¸Šæ–¹
	- æ¯ä¸ªé¡µé¢ éƒ½ä¼šå‡ºç°é¡µçœ‰
- é¡µçœ‰ã€é¡µè„š
	- éƒ½éš¶å±äº section
	- ä¸åŒçš„sectionå¯ä»¥è®¾ç½® 
	- ä¸åŒé¡µçœ‰é¡µè„š
- docxè¿˜å¯ä»¥ 
	- åšäº›ä»€ä¹ˆå‘¢ï¼ŸğŸ¤”

### æŸ¥çœ‹æ–‡æ¡£

- https://python-docx.readthedocs.io/en/latest/

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230713-1689222831198)

- æ ¹æ® è¿™ä¸ªä¾‹ç¨‹
	- å°è¯• è‡ªå·±ä¿®æ”¹pyæ–‡ä»¶

### å®Œæ•´demo

- è·å¾—å›¾ç‰‡

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240128-1706433943223)

```
https://doc.shiyanlou.com/courses/uid1190679-20240128-1706433943223
```

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240128-1706434413778)



### è¿è¡Œdemo

```
from docx import Document
from docx.shared import Inches

document = Document()

document.add_heading('Document Title', 0)

p = document.add_paragraph('A plain paragraph having some ')
p.add_run('bold').bold = True
p.add_run(' and some ')
p.add_run('italic.').italic = True

document.add_heading('Heading, level 1', level=1)
document.add_paragraph('Intense quote', style='Intense Quote')

document.add_paragraph(
    'first item in unordered list', style='List Bullet'
)
document.add_paragraph(
    'first item in ordered list', style='List Number'
)

document.add_picture('m.png', width=Inches(1.25))

records = (
    (3, '101', 'Spam'),
    (7, '422', 'Eggs'),
    (4, '631', 'Spam, spam, eggs, and spam')
)

table = document.add_table(rows=1, cols=3)
hdr_cells = table.rows[0].cells
hdr_cells[0].text = 'Qty'
hdr_cells[1].text = 'Id'
hdr_cells[2].text = 'Desc'
for qty, id, desc in records:
    row_cells = table.add_row().cells
    row_cells[0].text = str(qty)
    row_cells[1].text = id
    row_cells[2].text = desc

document.add_page_break()
document.save('oeasy.docx')
```

### è¿è¡Œæ•ˆæœ

- æ‰“å¼€oeasy.docx

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240128-1706434942678)

- æ•ˆæœæ€»ç»“
	- äº§ç”Ÿäº†æ ‡é¢˜ã€æ­£æ–‡ã€å›¾ç‰‡ã€è¡¨æ ¼
	- äº§ç”Ÿäº† æ— ç¬¦å·ã€æœ‰ç¬¦å·åˆ—è¡¨
	- è®¾ç½®äº†å­—ä½“å’Œæ ·å¼
- å¯ä»¥æŠŠå›¾ç‰‡æå–å‡ºæ¥å—ï¼Ÿ

### è§‚å¯Ÿä»£ç 

```
unzip oeasy.docx -d oeasy
cd oeasy/word
firefox document.xml
```

- è§‚å¯Ÿåˆ° å›¾ç‰‡è¢«æ”¾å…¥run
	- runè¢«æ”¾å…¥paragraph

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240501-1714566802584)

- éœ€è¦éå†æ¯ä¸€ä¸ªå›¾ç‰‡
- å¹¶ä¸”æŠŠæ‰€æœ‰çš„å›¾ç‰‡

### æå–docxä¸­çš„å›¾ç‰‡

```
from os. path import basename, dirname, join
from docx import Document, ImagePart
def extract_image (document) :
    for p in document.paragraphs:
        for image in p._element.xpath('.//pic:pic'):
            for img_id in image.xpath('.//a:blip/@r:embed'):
                part = document.part.related_parts[img_id]
                if not isinstance(part, ImagePart) :
                    continue
                save_dir = dirname (__file__)
                save_path = join (save_dir, basename (part. partname))
                with open(save_path, "wb") as f:
                    f.write (part.blob)

if __name__ == '__main__':
    doc = Document("demo.docx")
    extract_image (doc)
```

- ç¡®å®å¯ä»¥æå–å›¾ç‰‡

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240501-1714565539449)

- å¯ä»¥æŠŠå›¾ç‰‡æ’å…¥è¡¨æ ¼å—ï¼Ÿ

### å°è¯•

```
from docx import Document
from docx.shared import Inches

document = Document()

records = (
    (3, '101', 'Spam'),
    (7, '422', 'Eggs'),
    (4, '631', 'Spam, spam, eggs, and spam')
)

table = document.add_table(rows=1, cols=3)
hdr_cells = table.rows[0].cells
hdr_cells[0].text = 'Qty'
hdr_cells[1].text = 'Id'
hdr_cells[2].text = 'Desc'
for qty, id, desc in records:
    row_cells = table.add_row().cells
    row_cells[0].text = str(qty)
    row_cells[1].text = id
    row_cells[2].text = desc
table.cell(1,1).paragraphs[0].add_run().add_picture('m.png',width=Inches(1.25))

document.save('demo.docx')
```

- å°†å›¾ç‰‡ æ’å…¥å•å…ƒæ ¼

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240429-1714380699039)

- å¯ä»¥å°†æ— ç¬¦å·åˆ—è¡¨æ’å…¥å•å…ƒæ ¼å—ï¼Ÿ

### æ— ç¬¦å·åˆ—è¡¨

```
from docx import Document
from docx.shared import Inches

document = Document()

table = document.add_table(rows=2, cols=3)
table.cell(1,1).add_paragraph('first', style='List Bullet')
table.cell(1,1).add_paragraph('second', style='List Bullet')
table.cell(1,1).add_paragraph('third', style='List Bullet')
document.save('demo.docx')
```

- å•å…ƒæ ¼ç›¸å½“äºä¸€ä¸ªdocument

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240429-1714380974897)

- å¯ä»¥æ¥ä¸ªæœ‰åºåˆ—è¡¨å—ï¼Ÿ

### æœ‰åºåˆ—è¡¨

```
from docx import Document
from docx.shared import Inches

document = Document()

table = document.add_table(rows=2, cols=3)
table.cell(1,1).add_paragraph('first', style='List Number')
table.cell(1,1).add_paragraph('second', style='List Number')
table.cell(1,1).add_paragraph('third', style='List Number')
document.save('demo.docx')
```

- æœ‰åº

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240429-1714381088380)

- ä»€ä¹ˆæ—¶å€™ç”¨æœ‰åºåˆ—è¡¨ï¼Ÿ
- ä»€ä¹ˆæ—¶å€™ç”¨æ— åºåˆ—è¡¨å‘¢ï¼Ÿ

### æ— åºåˆ—è¡¨

- æ²¡æœ‰é¡ºåºã€è¯æ–¹ä¸­çš„è¯

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240429-1714381327427)

### æœ‰åºåˆ—è¡¨

- æœ‰æ—¶é—´é¡ºåº æˆ–è€… ä¸»æ¬¡é¡ºåº

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240429-1714382006523)

### èœè°±

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240429-1714382079988)

## æ€»ç»“ğŸ¤”
- è¿™æ¬¡ç»¼åˆè¿ç”¨python
	- ç”Ÿæˆäº†ä¸€ç¯‡æ–‡æ¡£
	- ä½ å¯ä»¥ç”Ÿæˆä¸€ç¯‡ å±äºè‡ªå·±çš„æ–‡æ¡£å—ï¼Ÿ
- å¦‚æœæƒ³è¦è®¾ç½®æ’å…¥å›¾ç‰‡çš„ç‰ˆå¼æ€ä¹ˆåŠå‘¢ï¼Ÿ
- æˆ‘ä»¬ä¸‹æ¬¡å†è¯´ï¼ğŸ‘‹ğŸ»