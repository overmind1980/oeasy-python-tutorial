---
show: step
version: 1.0
enable_checker: true
---

# çˆ¬å–ç™¾åº¦æŒ‡æ•°

## å›å¿†

- ä¸Š
- è¿™ï¼ŸğŸ¤”

### api

```
curl --location --request POST 'https://api.coze.cn/v3/chat' \
--header 'Authorization: Bearer pat_2vqqIkZ84qfje1U1bSsh8iHrQWrzDN8uF8Vb1JQ6pGOaTwRtvyisxkLHhKDZNmFt' \
--header 'Content-Type: application/json' \
--data-raw '{
    "bot_id": "7424459244357173302",
    "user_id": "7338741813303410697",
    "stream": true,
    "auto_save_history": true,
    "additional_messages": [
        {
            "role": "user",
            "content": "2025å¹´æ˜¥èŠ‚æ˜¯å“ªä¸€å¤©",
            "content_type": "text"
        }
    ]
}'
```

### requestæ–¹æ³•

```
import requests
import json
import os

os.system("clear")
# Coze APIçš„åŸºç¡€URLï¼Œéœ€è¦æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´
coze_api_url = "https://api.coze.cn/v3/chat"

# ä¿®æ­£åçš„è¯·æ±‚å¤´ï¼Œç¡®ä¿Content - Typeæ­£ç¡®
headers = {
    "Content-Type": "application/json",
    "Authorization": "Bearer pat_2vqqIkZ84qfje1U1bSsh8iHrQWrzDN8uF8Vb1JQ6pGOaTwRtvyisxkLHhKDZNmFt"  # æ›¿æ¢ä¸ºçœŸå®çš„æˆæƒä»¤ç‰Œ
}

additional_messages = {
    "role": "user",
    "content": "2025æ˜¥èŠ‚æœ‰ä»€ä¹ˆä¸ä¸€æ ·çš„ï¼Œåšæˆä¸€ä¸ªç½‘é¡µ",
    "content_type": "text"
}

# é‡æ–°æ„å»ºè¦å‘é€çš„é—®é¢˜æ•°æ®ï¼Œç¡®ä¿ç¬¦åˆCoze APIè¦æ±‚
question_payload = {
    "bot_id": "7424459244357173302",
    "user_id": "7338741813303410697",  # æ›¿æ¢ä¸ºå®é™…çš„ç”¨æˆ·æ ‡è¯†
    "additional_messages": [additional_messages],
    "stream": True
}

try:
    # å‘é€POSTè¯·æ±‚
    response = requests.post(coze_api_url, headers = headers, json = question_payload, stream = True)
    show = False
    if response.status_code == 200:
        for line in response.iter_lines():
            if line:
                try:
                    line = line.decode("utf-8")
                    if line == "event:conversation.chat.created":
                        print("===å¯¹è¯å¼€å§‹===" + line)
                        continue
                    if line == "event:conversation.chat.in_progress":
                        print("===å¯¹è¯ç»§ç»­===" + line)
                        continue
                    if line == "event:conversation.message.completed":
                        print("===æé—®å®Œæˆ===" + line)
                        continue
                    if line == "event:conversation.message.delta":
                        #print("===ä¸æ–­å›ç­”===" + line)
                        show = True
                        continue
                    if line == "event:conversation.chat.completed":
                        show = False
                        print("===å¯¹è¯å®Œæˆ===" + line)
                        continue
                    if line == "event:done":
                        print("===å¯¹è¯ç»“æŸ===" + line)
                        continue
                    #print(line)
                    if show:
                        line = line.replace("data:","")
                        #print("=====line===")
                        #print(type(line))
                        #print(line)
                        #print("=====line===")
                        data = json.loads(line)
                        print(data["content"],end="")
                        #print("Cozeçš„å›ç­”ï¼ˆæµå¼æ•°æ®å—ï¼‰:", data)
                except Exception as e:
                    print(f"æ— æ³•è§£æè¯¥è¡Œæ•°æ®: {line}")
    else:
        print(f"è¯·æ±‚å¤±è´¥ï¼ŒçŠ¶æ€ç : {response.status_code}ï¼Œé”™è¯¯ä¿¡æ¯: {response.text}")
except requests.RequestException as e:
    print(f"è¯·æ±‚è¿‡ç¨‹ä¸­å‡ºç°å¼‚å¸¸: {e}")




```

### cozepy

```
import requests
import json
import os

os.system("clear")

# Coze APIçš„åŸºç¡€URLï¼Œéœ€è¦æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´
coze_api_url = "https://api.coze.cn/v3/chat"

# ä¿®æ­£åçš„è¯·æ±‚å¤´ï¼Œç¡®ä¿Content - Typeæ­£ç¡®
headers = {
    "Content-Type": "application/json",
    "Authorization": "Bearer pat_2vqqIkZ84qfje1U1bSsh8iHrQWrzDN8uF8Vb1JQ6pGOaTwRtvyisxkLHhKDZNmFt"  # æ›¿æ¢ä¸ºçœŸå®çš„æˆæƒä»¤ç‰Œ
}

additional_messages = {
    "role": "user",
    "content": "1 + 1",
    "content_type": "text"
}

# é‡æ–°æ„å»ºè¦å‘é€çš„é—®é¢˜æ•°æ®ï¼Œç¡®ä¿ç¬¦åˆCoze APIè¦æ±‚
question_payload = {
    "bot_id": "7424459244357173302",
    "user_id": "7338741813303410697",  # æ›¿æ¢ä¸ºå®é™…çš„ç”¨æˆ·æ ‡è¯†
    "additional_messages": [additional_messages],
    "stream": True
}

try:
    # å‘é€POSTè¯·æ±‚
    response = requests.post(coze_api_url, headers = headers, json = question_payload)
    if response.status_code == 200:
        for line in response.iter_lines():
            if line:
                try:
                    print("Cozeçš„å›ç­”ï¼ˆæµå¼æ•°æ®å—ï¼‰:", line.decode())
                    print("=========")
                except exception:
                    print(f"æ— æ³•è§£æè¯¥è¡Œæ•°æ®: {line}")
    else:
        print(f"è¯·æ±‚å¤±è´¥ï¼ŒçŠ¶æ€ç : {response.status_code}ï¼Œé”™è¯¯ä¿¡æ¯: {response.text}")
except requests.RequestException as e:
    print(f"è¯·æ±‚è¿‡ç¨‹ä¸­å‡ºç°å¼‚å¸¸: {e}")
```


### æ€»ç»“
- ä¸‹æ¬¡å†è¯´
