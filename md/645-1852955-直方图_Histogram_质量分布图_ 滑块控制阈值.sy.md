---
show: step
version: 1.0
enable_checker: true
---

# opencv

## å›å¿†

- ä¸Šæ¬¡ç ”ç©¶äº†
	- é˜ˆå€¼
	- threshold
- å¯ä»¥è¯´æ˜¯åˆ†ç•Œç‚¹
	- å°±åƒäºŒæç®¡ä¸€æ ·
	- ä¸€åˆ†ä¸ºäºŒ 
	- åŒºåˆ†ä¸¤ç§çŠ¶æ€
		- å¯æ„ŸçŸ¥çš„åˆºæ¿€
		- é˜ˆä¸‹åˆºæ¿€

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240114-1705196223327)

- å›¾åƒçš„é˜ˆå€¼æ—¶æ ¹æ®äº®åº¦åˆ’åˆ†çš„
	- å¯ä»¥æ˜¯å…·ä½“å€¼
	- ä¹Ÿå¯ä»¥æ ¹æ®å›¾åƒç”»é¢çš„å‡å€¼
- å¯ä»¥æ ¹æ®ä¸€ä¸ªå˜åŒ–çš„æ•°å€¼æ¥è§‚çœ‹å—ï¼Ÿ

### photoshopä¸­çš„ç›´æ–¹å›¾

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240115-1705291680062)

- https://helpx.adobe.com/photoshop/using/viewing-histograms-pixel-values.html

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240115-1705291688015)

- ä¸åŒçš„å›¾åƒä¼šæœ‰ä¸åŒçš„ç›´æ–¹å›¾

### åˆ†æå›¾åƒ

- äº®åº¦ä¿¡æ¯ 
	- é™¤äº†å¹³å‡å€¼å’Œæ–¹å·®ä¹‹å¤–
	- è¿˜å¯ä»¥ä½¿ç”¨æŸ±å½¢å›¾

```
import numpy as np
from matplotlib import pyplot as plt
import cv2 as cv

def custom_hist(gray):
    h, w = gray.shape
    hist = np.zeros([256], dtype=np.int32)
    for row in range(h):
        for col in range(w):
            pv = gray[row, col]
            hist[pv] += 1

    y_pos = np.arange(0, 256, 1, dtype=np.int32)
    plt.bar(y_pos, hist, align='center', color='r', alpha=0.5)
    plt.xticks(y_pos, y_pos)
    plt.ylabel('Frequency')
    plt.title('Histogram')
    plt.show()

src = cv.imread("gear.jpg")
gray = cv.cvtColor(src, cv.COLOR_BGR2GRAY)
plt.show()
custom_hist(gray)
cv.waitKey(0)
cv.destroyAllWindows()
```

- æŒ‰ç…§[0,255]æ€»å…±256ä¸ªæ¡£ä½
	- å°†æ‰€æœ‰åƒç´ çš„äº®åº¦è¿›è¡Œç»Ÿè®¡
	- å¾—åˆ°ç›´æ–¹å›¾

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240114-1705197286404)

- ç›´æ–¹å›¾ æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿ

### ç›´æ–¹å›¾

- ç›´æ–¹å›¾å°±æ˜¯
	- Histogram
	- è´¨é‡åˆ†å¸ƒå›¾

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240114-1705197537562)

- ä¸Šå›¾çš„ è´¨é‡ 
	- æŒ‡çš„æ˜¯ äº®åº¦

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240114-1705197587335)

- å½“ç„¶ä¹Ÿå¯ä»¥æŒ‡ä»£å¹´é¾„
- å›¾åƒä¸­æŒ‡ä»£ä»€ä¹ˆæ¥ç€ï¼Ÿ

### ç›¸æœºä¸­çš„ç›´æ–¹å›¾

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240114-1705198178513)

- ç›´æ–¹å›¾ä¸­å°±æœ‰ä¸€äº›æœ¯è¯­

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240114-1705198196572)

| è‹±æ–‡ | ä¸­æ–‡ |
|--- | ---|
| Shadows | é˜´å½± æš—éƒ¨ |
| Midtones | ä¸­é—´è°ƒå­ |
| Highlights | é«˜å…‰ äº®éƒ¨ |

### è½å®åˆ° ç»˜ç”»é¢†åŸŸ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240114-1705198551373)

### æ›´å¤šç»†èŠ‚

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240114-1705198596001)

### æ‘„å½±é¢†åŸŸ

- æ›å…‰è¿‡åº¦å’Œä¸è¶³

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240114-1705199118177)

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240114-1705199128528)

### åå·®è¿‡åº¦å’Œä¸è¶³

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240114-1705199135830)

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240114-1705199142890)

### æ»‘å—æ•ˆæœ
```
import cv2 
import numpy as np

def callback(value):
    print(value)
 
image = cv2.imread("/home/shiyanlou/gear.jpg")
cv2.namedWindow("canvas",cv2.WINDOW_NORMAL)
cv2.createTrackbar("T","canvas",0,255,callback)	
while True:
    t = cv2.getTrackbarPos("T","canvas")
    t1, dst1 = cv2.threshold(image,t,255,cv2.THRESH_BINARY)
    cv2.imshow("canvas",dst1)
    key = cv2.waitKey(1)
    if key & 0xFF == ord("q"):     
        break
cv2.destroyAllWindows()
```

- è¿è¡Œæ•ˆæœ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240114-1705200521359)

- è°ƒæ•´æ•ˆæœ
	- å¥½åƒæŒºé€‚åˆæ‰’çº¿ç¨¿

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240114-1705200532727)

### åå‘é˜ˆå€¼

- è°ƒæ•´é˜ˆå€¼æ¨¡å¼ä¸ºTHRESH_BINARY_INV

```
import cv2 
import numpy as np
 
def callback(value):
    print(value)
 
image = cv2.imread("/home/shiyanlou/gear.jpg")
cv2.namedWindow("canvas",cv2.WINDOW_NORMAL)
cv2.createTrackbar("T","canvas",0,255,callback)	
while True:
    t = cv2.getTrackbarPos("T","canvas")
    t1, dst1 = cv2.threshold(image,t,255,cv2.THRESH_BINARY_INV)
    cv2.imshow("canvas",dst1)
    key = cv2.waitKey(1)
    if key & 0xFF == ord("q"): 
        break
cv2.destroyAllWindows()
```

- è¿è¡Œæ•ˆæœ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240114-1705200692146)

- è°ƒæ•´æ•ˆæœ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240114-1705200705347)

### ä½äºé˜ˆå€¼é›¶å¤„ç†

- è°ƒæ•´é˜ˆå€¼æ¨¡å¼ä¸ºTHRESH_TOZERO

```
import cv2 
import numpy as np
 
def callback(value):
    print(value)
 
image = cv2.imread("/home/shiyanlou/gear.jpg")
cv2.namedWindow("canvas",cv2.WINDOW_NORMAL)
cv2.createTrackbar("T","canvas",0,255,callback)	
while True:
    t = cv2.getTrackbarPos("T","canvas")
    t1, dst1 = cv2.threshold(image,t,255,cv2.THRESH_TOZERO)
    cv2.imshow("canvas",dst1)
    key = cv2.waitKey(1)
    if key & 0xFF == ord("q"): 
        break
cv2.destroyAllWindows()
```


- è°ƒæ•´æ•ˆæœ
	- ä½äºé˜ˆå€¼çš„åƒç´  
	- è½¬åŒ–ä¸ºçº¯é»‘

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240114-1705200848823)

- å½©è‰²å›¾ç‰‡å¯ä»¥ä½¿ç”¨é˜ˆå€¼å—ï¼Ÿ

### è½¬åŒ–

- å…ˆè½¬æˆç°åº¦
	- ç„¶åæ ¹æ®æ»‘å—æ§åˆ¶é˜ˆå€¼

```
import cv2
import numpy as np

def callback(value):
    print(value)

image = cv2.imread("/home/shiyanlou/kun1.png",cv2.IMREAD_GRAYSCALE)
cv2.namedWindow("canvas",cv2.WINDOW_NORMAL)
cv2.createTrackbar("T","canvas",0,255,callback)
while True:
    t = cv2.getTrackbarPos("T","canvas")
    t1, dst1 = cv2.threshold(image,t,255,cv2.THRESH_BINARY)
    cv2.imshow("canvas",dst1)
    key = cv2.waitKey(1)
    if key & 0xFF == ord("q"):
        break
cv2.destroyAllWindows()
```

- æ•ˆæœ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240114-1705201756797)

### æ€»ç»“ 
- è¿™æ¬¡ç ”ç©¶äº†
	- ç›´æ–¹å›¾
	- Histogram
- å°†æ‰€æœ‰çš„åƒç´ ç‚¹
	- æŒ‰ç…§äº®åº¦å€¼åˆ†ç±»
	- å½¢æˆçš„æŸ±å½¢å›¾ å°±æ˜¯ ç›´æ–¹å›¾
- å¯ä»¥æ ¹æ®ç›´æ–¹å›¾ 
	- åŠ¨æ€è®¾ç½®é˜ˆå€¼
	- ç”Ÿæˆå„ç§å›¾å½¢çš„æ¡ˆä¾‹ğŸ¤”
- ä¸‹æ¬¡å†è¯´ğŸ‘‹