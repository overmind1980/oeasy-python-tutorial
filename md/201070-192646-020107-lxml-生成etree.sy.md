---
show: step
version: 1.0
enable_checker: true
---

# è¯­æ³• html ç”Ÿæˆ
## å›å¿†

- ä¸Šå·²ç»åœ¨å†…å­˜æ„å»ºäº†ä¸€æ£µetreeæ ‘äº†
- è€Œä¸”å¯ä»¥ç”¨xpathçš„æ–¹å¼è®¿é—®ä»–
- è€Œä¸”å¯ä»¥éå†ä»–
- ä½†æ˜¯æˆ‘ä»¬çš„ç´ ææ˜¯ç½‘ä¸Šçˆ¬å–çš„ç½‘é¡µæºæ–‡ä»¶
- å¦‚ä½•é€šè¿‡ç½‘é¡µæºæ–‡ä»¶å¾—åˆ°ä¸€æ£µæ ‘å‘¢ï¼ŸğŸ¤”


### ä»å­—ç¬¦ä¸²ç”Ÿæˆ

```
some_xml_data = "<root>data</root>"
root = etree.fromstring(some_xml_data)
print(root.tag)
etree.tostring(root)
```

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210901-1630503765091)

### ç”Ÿæˆ

- å¯ä»¥çœ‹åˆ°etreeå¯ä»¥ç›´æ¥é€šè¿‡å­—ç¬¦ä¸²ç”Ÿæˆ
- ç»™ä»–ä¸€ä¸ªå­—ç¬¦ä¸²
- ä»–ç»™ä½ ä¸€ä¸ªetreeèŠ‚ç‚¹
- èŠ‚ç‚¹çš„æ ¹ç›®å½•æ ‡ç­¾
- å–å†³äºå­—ç¬¦ä¸²æœ€å¤–å±‚çš„æ ‡ç­¾

### ç”Ÿæˆetree

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210901-1630466004301)

```
root = etree.XML('<html><head/><body><p>Hello<br/>World</p></body></html>')
etree.tostring(root) # default: method = 'xml'
etree.tostring(root, method='xml') # same as above
etree.tostring(root, method='html')
print(etree.tostring(root, method='html', pretty_print=True))
etree.tostring(root, method='text')
```

### æ“ä½œ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210901-1630466164563)


### ä¿®æ”¹

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210901-1630466274184)

```
br = next(root.iter('br'))  # get first result of iteration
br.tail = u'W\xf6rld'
etree.tostring(root, method='text')  # doctest: +ELLIPSIS
etree.tostring(root, method='text', encoding="UTF-8")
```

### æ“ä½œ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210901-1630466681160)

- æˆ‘ä»¬å¯ä»¥ä»æ ‘ä¸Šæ‰¾åˆ°brè¿™ä¸ªèŠ‚ç‚¹
- ç„¶åè®¾ç½®ä»–çš„å°¾å·´
- è¿™ä¸ªå°¾å·´ä¸æ˜¯ä¸€èˆ¬çš„asciiå­—ç¬¦

### utf-8

- è¿™ä¸ªå­—ç¬¦çš„unicodeç¼–ç æ˜¯`\xf6`
- ç¼–ç ä¸ºutf-8æ–¹å¼å
- å æ®ä¸¤ä¸ªå­—èŠ‚
- ä¸º`\xc3\xb6`

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210901-1630466672155)

### ç”Ÿæˆhtml

```
root = etree.HTML("<p>data</p>")
etree.tostring(root)
```

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210901-1630504602875)

- è¿™æ¬¡åº”è¯¥æ˜¯å¯ä»¥ç”Ÿæˆhtmlå…ƒç´ 

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210901-1630504739828)

- è¯­æ³•åˆ†æå™¨ä¼šåˆ†æå‡ºç›®å‰çš„æ ‡ç­¾æƒ…å†µ
- è€Œä¸”æŠŠä»–æ”¾åˆ°htmlä¸‹é¢çš„bodyåº•ä¸‹

### ç§»é™¤ç©ºæ ¼

```
parser = etree.HTMLParser(remove_blank_text=True)
root = etree.HTML("<root>  <a/>   <b>  </b>     </root>", parser)
etree.tostring(root)
```

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210901-1630504914540)

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210901-1630505103633)

- å¯ä»¥çœ‹åˆ°ä¸¤è¾¹çš„ç©ºæ ¼åˆ é™¤æ‰äº†

### æ§åˆ¶ç¼©è¿›
```
etree.indent(root, space="    ")
print(etree.tostring(root))
etree.indent(root, space="\t")
etree.tostring(root)
```

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210901-1630505528348)

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210901-1630505481176)

## æ€»ç»“

- å¯ä»¥é€šè¿‡å­—ç¬¦ä¸²æ„å»ºä¸€æ£µetreeäº†
- è¿™æ£µæ ‘å¯ä»¥åˆ é™¤ç©ºæ ¼
- å¯ä»¥æ§åˆ¶è¾“å‡ºçš„ç¼©è¿›
- æˆ‘èƒ½å¤ŸæŠŠå‰é¢çš„requestså’Œè¿™ä¸ªetreeç»“åˆèµ·æ¥å—
	- é€šè¿‡requestè·å¾—ç½‘é¡µ
	- é€šè¿‡etreeæŠŠä»–è½¬åŒ–ä¸ºä¸€æ£µetreeæ ‘
- å¯ä»¥ä¹ˆï¼ŸğŸ¤”
- ä¸‹æ¬¡å†è¯´
