---
show: step
version: 1.0
enable_checker: true
---

# å¯¼å…¥ request åŒ…

## æ–°çš„å¼€å§‹

- ä¸Šæ¬¡äº†è§£äº†æµè§ˆå™¨çš„å„ç§çŠ¶æ€ç 
	- 200çš„æ˜¯æˆåŠŸ
	- 304æ˜¯ç”¨ç¼“å­˜
	- 404æ˜¯æ‰¾ä¸åˆ°

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221118-1668757714896)

- rfc2612å®šä¹‰äº†æœ€åˆçš„ç½‘é¡µè¯·æ±‚ä¸å“åº”çš„çŠ¶æ€ç 
- è¯·æ±‚ä¸­æœ‰å¾ˆå¤šè¯·æ±‚å¤´
	- å„æœ‰å„çš„ä½œç”¨
	- æ¯”å¦‚ä¸Šæ¬¡ä¿®æ”¹æ—¶é—´
	- å¯ä»¥è®©æœåŠ¡å™¨å†³å®šæ˜¯å¦ä½¿ç”¨æµè§ˆå™¨çš„ç¼“å­˜

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220912-1662951986226)


- åˆ°æ­¤ä¸ºæ­¢æˆ‘ä»¬è¿˜æ²¡æœ‰çˆ¬è™«
- çˆ¬è™«åˆ°åº•æ€ä¹ˆçˆ¬å‘¢ï¼ŸğŸ¤£

### è¿‡ç¨‹

- æµè§ˆçš„è¿‡ç¨‹æ˜¯
  - æµè§ˆå™¨åœ¨å®¢æˆ·æœºä¸Šå‘å‡ºè¯·æ±‚ request
  - æœåŠ¡å™¨æ¥æ”¶è¯·æ±‚è¿”å› response
  - æµè§ˆå™¨æ‰“å¼€ response å¹¶æ¸²æŸ“æˆé¡µé¢

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210831-1630412050376)

- çˆ¬è™«å°±å‡è£…è‡ªå·±æ˜¯ä¸€ä¸ªæµè§ˆå™¨
	- ç”¨ä»£ç å®Œæˆè¿™æ ·ä¸€ä¸ª http è¿‡ç¨‹
	- å®¢æˆ·æœºæ—¢ç„¶èƒ½è®©æµè§ˆå™¨å‘è¯·æ±‚
	- å°±èƒ½è®©çˆ¬è™«å‘è¯·æ±‚
	- åæ­£éƒ½æ˜¯ 0101 çš„ä»£ç 
- é‚£æˆ‘åº”è¯¥å¦‚ä½•å‘é€è¯·æ±‚å‘¢ï¼Ÿ
	- å…ˆè¦ä¸‹è½½ä¸€ä¸ªrequestsåŒ…

### è¯·æ±‚ requests

- https://requests.readthedocs.io/en/latest/

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220207-1644195421084)

- å…ˆä» requests å¼€å§‹
	- å¯¼å…¥è¿™ä¸ªåŒ…

### ä¸‹è½½åŒ…

- å¦‚æœæ²¡æœ‰çš„è¯è¦å…ˆä¸‹è½½
  - pip3 install requests

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20231015-1697374954551)

### å¯¼å…¥åŒ…

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210831-1630412431769)

-  æŸ¥çœ‹å¸®åŠ©

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210831-1630404683669)

- æ ¹æ®è¿™ä¸ªå¸®åŠ©

### å°è¯•å¤åˆ¶

- æˆ‘ä»¬æ¥è¯•è¯•
	- ç…§çŒ«ç”»è™

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221118-1668761027794)

### ç…§çŒ«ç”»è™

```
import requests
response = requests.get("http://localhost/")
```

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210831-1630412591560)

- å¥½åƒè¿”å›äº† 200 çš„çŠ¶æ€ç 
- è¿™ä¸ª r åˆ°åº•æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ

### Response å“åº”

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210831-1630412645897)

- åŸæ¥æ˜¯ä¸€ä¸ª Response ç±»çš„å¯¹è±¡
	- help(r)

### Response

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210831-1630412922346)

- Response å¯¹è±¡ åŒ…æ‹¬äº†ä¸€ä¸ª http è¯·æ±‚çš„è¿”å›ç»“æœ
	- requests.models.Response

### åªè¯»å¯¹è±¡

- response è¿™ä¸ªè¿”å›å¯¹è±¡é‡Œé¢æœ‰å¾ˆå¤šå±æ€§
	- content å°±æ˜¯å¯ä»¥è¯»å‡ºæ¥çš„å†…å®¹
	 - è¿”å›çš„æ˜¯å­—èŠ‚åºåˆ—

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210831-1630412969842)

- å¦‚æœæˆ‘åªè¦çº¯æ–‡æœ¬æ€ä¹ˆåŠå‘¢ï¼Ÿ

### æ–‡æœ¬

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20211015-1634305462282)

- æ¥çœ‹çœ‹ r.text

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20211015-1634305478003)

- r.content å’Œ r.text
	- éƒ½æ˜¯ä»€ä¹ˆç±»å‹çš„å‘¢ï¼Ÿ

### å¯¹æ¯”

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20211016-1634396395638)

- content å’Œ text
  - content æ˜¯ å­—èŠ‚åºåˆ—
  - text æ˜¯ å­—ç¬¦ä¸²åºåˆ—

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210831-1630413092545)

### æ˜ç¡®

- é€šè¿‡å˜é‡åçš„å‰ç¼€
	- æ˜ç¡®è¿™ä¸¤ä¸ªå˜é‡ç±»å‹

```
import requests
response = requests.get("http://localhost/")
b_html = response.content
s_html = response.text
```

- é‚£è¿™r.contentå’Œr.textä¹‹é—´
	- å¯ä»¥ç›¸äº’è½¬åŒ–ä¹ˆï¼Ÿ

### è½¬åŒ–

- å­—èŠ‚åºåˆ—å’Œå­—ç¬¦ä¸²çš„è½¬åŒ–
	- å°±æ˜¯å­—ç¬¦ä¸²çš„ç¼–ç å’Œè§£ç 

- å­—èŠ‚åºåˆ—
	- è§£ç  decode ä¹‹å
		- å¾—åˆ°å­—ç¬¦ä¸²

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20211016-1634396452318)

- å­—ç¬¦ä¸² 
	- encode ç¼–ç ä¹‹å
		- å¾—åˆ°å­—èŠ‚åºåˆ—

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20211016-1634396459875)

- ç¼–ç å’Œè§£ç 
	- äº’ä¸ºé€†æ–¹æ³•

## æ€»ç»“

- å¯¼å…¥äº† requests æ¨¡å—
- requestå¯ä»¥å¸®æˆ‘ä»¬å‘é€httpè¯·æ±‚	
	- è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å‡è£…è‡ªå·±æ˜¯ä¸€ä¸ªæµè§ˆå™¨
	- å®Œæˆäº† http get çš„è¿‡ç¨‹
	  - å‘å‡ºäº† request
	  - å¾—åˆ°äº† response
	  - çŠ¶æ€ç  200
- ä½†æ˜¯è¯»åˆ°çš„å†…å®¹æ˜¯
  - r.content å­—èŠ‚åºåˆ—
  - r.text å­—ç¬¦ä¸²åºåˆ—
- å¦‚ä½•è§£æ html è¯­è¨€å‘¢ï¼ŸğŸ¤”
- ä¸‹æ¬¡å†è¯´
