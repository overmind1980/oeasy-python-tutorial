---
show: step
version: 1.0
enable_checker: true
---

# äºŒé‡å¾ªç¯

## å›å¿†

- ä¸Šæ¬¡ç ”ç©¶äº†é›‰å…”åŒç¬¼
- å…¶å®æˆ‘ä»¬å¾ˆå®¹æ˜“
	- é™·å…¥å¾ªç¯
	- é™·å…¥æ¦‚å¿µ
	- é™·å…¥æŠ½è±¡æ•°å­—çš„é™·é˜±

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221106-1667709560030)

- æ€ä¹ˆæ ·è·³å‡ºå¾ªç¯
- ç›´å‡»æœ¬è´¨
- ç¡®å®æ˜¯å¾ˆéš¾çš„äº‹æƒ…
- è®¡ç®—æœºç¨‹åºä¸æ€•å¾ªç¯
- è®¡ç®—æœºæ–‡ä»¶éå†ä¹Ÿä¾èµ–å¾ªç¯
- å¦‚ä½•å†™ç¨‹åºå»éå†æ–‡ä»¶ï¼Ÿï¼ŸğŸ¤”

### å®šä¹‰

- æˆ‘ä»¬æ˜¯æ€ä¹ˆå¾—åˆ°æ–‡ä»¶çš„å‘¢ï¼Ÿ
- æˆ‘ä»¬é¦–å…ˆè¯»ä¸€ä¸ªæ–‡ä»¶
- ç„¶åçœ‹çœ‹è¿™ä¸ªæ–‡ä»¶å…·ä½“æ˜¯ä»€ä¹ˆ type çš„

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20211011-1633956068396)

- ä»€ä¹ˆæ˜¯ TextIOWrapper å‘¢ï¼Ÿ

### TextIOWrapper

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20211011-1633957157884)

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20211011-1633957166532)

- ç»§ç»­å¾€åç¿»

### iter æ–¹æ³•

- æˆ‘æ‰¾åˆ°äº†è¿™ä¸ª

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20211011-1633957201999)

- è¿™è¯´æ˜ TextIOWrapper æ˜¯ä¸€ä¸ªå¯è¿­ä»£çš„å¯¹è±¡
	- å¯ä»¥ç”¨ for æ¥éå†ä»–

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230511-1683802629606)

- å…ˆå‡†å¤‡è¿™æ ·ä¸€ä¸ªwuxing.txtæ–‡ä»¶

### éå†

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20211011-1633957276251)

- éå†å¾ˆå¥½ç”¨
- æˆ‘ä»¬å¯ä»¥ç»™ä»–åŠ ä¸€ä¸ªç¼–å·ä¹ˆï¼Ÿ

### ç¼–å·

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20211011-1633957376053)

- enumerate å°±æ˜¯ç»™å¯è¿­ä»£å˜é‡ç¼åˆä¸€ä¸ªç¼–å·
- é‚£ä¹ˆæˆ‘å¯ä»¥æŠŠçºµå‘çš„åˆ—ç¼åˆåˆ°ä¸€èµ·ä¹ˆï¼Ÿ

### å‡†å¤‡ç¼åˆ zip

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20211011-1633958241633)

- é¦–å…ˆæŠŠæ–‡ä»¶åˆ¶ä½œä¸ºäºŒä½æ•°ç»„
- ç„¶åæƒ³åŠæ³•ç¼åˆåŒä¸€ä½ç½®çš„å…ƒç´ 
- å…¶å®æ˜¯è½¬ç½®

### ç¼åˆ zip

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20211011-1633958317886)

- è¿™æ ·åŒå£°ç›¸åº” åŒæ°”ç›¸æ±‚
- åŒæ ·ç±»å‹çš„ä¸œè¥¿å°±æ˜ å°„åˆ°ä¸€èµ·äº†

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20211011-1633958585440)

### 
 ![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/3584/labs/234372/uid1190679-20250309-1741528873406/wm) 


```
import os
import shutil
import exifread
from datetime import datetime
from pathlib import Path


def get_capture_date(file_path):
    """ä¸¥æ ¼æ¨¡å¼ï¼šä»…ä½¿ç”¨EXIFæ—¥æœŸï¼Œä¸è‡ªåŠ¨å›é€€åˆ°ä¿®æ”¹æ—¶é—´"""
    try:
        with open(file_path, 'rb') as f:
            tags = exifread.process_file(f, stop_tag='DateTimeOriginal')
            if 'EXIF DateTimeOriginal' in tags:
                date_str = str(tags['EXIF DateTimeOriginal'])
                return datetime.strptime(date_str, '%Y:%m:%d %H:%M:%S')
    except Exception as e:
        print(f"EXIFè¯»å–å¤±è´¥ {file_path}: {str(e)}")
    return None  # ä¸¥æ ¼æ¨¡å¼ä¸è‡ªåŠ¨ä½¿ç”¨ä¿®æ”¹æ—¶é—´


def organize_photos(source_dir, output_base):
    """æ•´ç†ç…§ç‰‡ä¸»å‡½æ•°ï¼ˆæ–°å¢æ— æ—¥æœŸåˆ†ç±»ï¼‰"""
    image_exts = {'.jpg', '.jpeg', '.png', '.cr2', '.nef', '.dng'}

    for file_path in Path(source_dir).rglob('*'):
        if file_path.suffix.lower() not in image_exts:
            continue

        try:
            # è·å–æ‹æ‘„æ—¥æœŸ
            capture_date = get_capture_date(file_path)

            # ç¡®å®šç›®æ ‡è·¯å¾„
            if capture_date:  # æœ‰EXIFæ—¥æœŸçš„æƒ…å†µ
                date_folder = capture_date.strftime("%Y/%m/%d")
                dest_dir = Path(output_base) / date_folder
            else:  # æ— æ—¥æœŸä¿¡æ¯çš„æƒ…å†µ
                dest_dir = Path(output_base) / "æ— æ—¥æœŸä¿¡æ¯"

            # åˆ›å»ºç›®å½•å¹¶å¤„ç†é‡å
            dest_dir.mkdir(parents=True, exist_ok=True)
            dest_path = dest_dir / file_path.name
            counter = 1
            while dest_path.exists():
                dest_path = dest_dir / f"{file_path.stem}_{counter}{file_path.suffix}"
                counter += 1

            # ç§»åŠ¨æ–‡ä»¶
            shutil.move(str(file_path), str(dest_path))
            status = "æ— æ—¥æœŸ" if not capture_date else capture_date.strftime("%Y-%m-%d")
            print(f"Moved [{status}]: {file_path.name}")

        except Exception as e:
            print(f"å¤„ç†å¤±è´¥ {file_path.name}: {str(e)}")


if __name__ == "__main__":
    sd_card_path = "/media/your_sd_card"
    output_directory = "/photo_collection"

    organize_photos(sd_card_path, output_directory)


```

### æ€»ç»“

- è¿™æ¬¡ç ”ç©¶äº†æ–‡ä»¶æµå¯¹è±¡çš„éå†
- æ–‡ä»¶æµæ˜¯ä¸€ä¸ª iterable çš„å¯¹è±¡
- å¯ä»¥ç”¨ for æ¥éå†ä»–çš„æ¯ä¸€è¡Œ
- for æˆ‘ä»¬å·²ç»å­¦äº†ä¸å°‘ä¸œè¥¿
- åœ¨å®˜æ–¹å¸®åŠ©é‡Œé¢æ€ä¹ˆæè¿°ï¼ŸğŸ¤”
- ä¸‹æ¬¡å†è¯´ ğŸ‘‹
