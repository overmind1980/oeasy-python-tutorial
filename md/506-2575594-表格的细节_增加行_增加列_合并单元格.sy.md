---
show: step
version: 1.0
enable_checker: true
---

#  è¡¨æ ¼çš„ç»†èŠ‚

## å›å¿†

- ä¸Šæ¬¡æˆ‘ä»¬ç ”ç©¶äº†è¡¨æ ¼
	- ä»é›¶å¼€å§‹ ç”Ÿæˆè¡¨æ ¼
	- åœ¨pythonä¸­è¯»å–è¡¨æ ¼
- è¡¨æ ¼è¿˜å¯ä»¥æ€ä¹ˆç©å‘¢ï¼Ÿ

### æ’å…¥è¡¨æ ¼

```
from docx import Document
document = Document()
table = document.add_table(2,2)
for i in range(2):
    for j in range(2):
        table.cell(i,j).text = str(i+1) + "*" + str(j+1) + "=" + str((i+1)*(j+1))
document.save("o.docx")
```

- ç»“æœ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240429-1714376583346)

- æƒ³è¦æ·±å…¥äº†è§£ç»†èŠ‚

### è§‚å¯ŸåŒ…

```
pip3 show python-docx
```

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240429-1714378577516)

- æ‰¾åˆ°æºç ç›®å½•ä½ç½®

### è¿›å…¥æºç ç›®å½•

```
cd  /home/shiyanlou/.local/lib/python3.8/site-packages
```

- è§‚å¯Ÿ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240429-1714378627098)

- æ‰¾åˆ°table.py

```
vi table.py
```

- ç›¸å…³å‡½æ•°ã€ç»†èŠ‚å°±åœ¨é‡Œé¢
- å¦‚ä½•ç†è§£text

### è§‚å¯Ÿ

- /text(
	- æ‰¾åˆ°å‡½æ•°ä½ç½®

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240429-1714378982771)

- åŸæ¥textå±æ€§æ˜¯
	- å°†cellä¸­æ‰€æœ‰çš„paragraphä¸­çš„text
	- æ’¸åˆ°ä¸€èµ·
- å°è¯•åœ¨cellä¸­
	- æ’å…¥paragraphs

### æ’å…¥æ®µè½

```
from docx import Document
document = Document()
table = document.add_table(2,2)
for i in range(2):
    for j in range(2):
        table.cell(i,j).text = str(i+1) + "*" + str(j+1) + "=" + str((i+1)*(j+1))
table.cell(0,0).add_paragraph("p1")
table.cell(0,0).add_paragraph("p2")
print(table.cell(0,0).text)
document.save("o.docx")
```

- ç»“æœ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240429-1714380029337)

- å¯ä»¥åˆå¹¶å•å…ƒæ ¼å—ï¼Ÿ

### æŸ¥è¯¢æ–‡æ¡£

- åœ¨table.pyä¸­
	- /class 
	- æ‰¾åˆ°æ‰€æœ‰çš„ç±»

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240429-1714400502925)

- è¯•è¯•è¿™ä¸ªå‡½æ•°

### merge

```
from docx import Document
document = Document()
table = document.add_table(2,2)
for i in range(2):
    for j in range(2):
        table.cell(i,j).text = str(i+1) + "*" + str(j+1) + "=" + str((i+1)*(j+1))
table.cell(0,0).merge(table.cell(0,1))
document.save("o.docx")
```

- åˆå¹¶å

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240429-1714400697486)

- å°è¯•å¢åŠ è¡Œ

### å¢åŠ è¡Œ

```
from docx import Document
document = Document()
table = document.add_table(2,2)
for i in range(2):
    for j in range(2):
        table.cell(i,j).text = str(i+1) + "*" + str(j+1) + "=" + str((i+1)*(j+1))
table.add_row()
table.cell(2,0).text = "new row"
document.save("o.docx")
```

- ç»“æœ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240429-1714377059700)

- æƒ³è¦æ–°å»ºä¸€ä¸ªåˆ—
	- column 
	- åº”è¯¥å¦‚ä½•å‘¢ï¼Ÿ

### æ·»åŠ åˆ—

```
from docx import Document
from docx.shared import Mm
document = Document()
table = document.add_table(2,2)
for i in range(2):
    for j in range(2):
        table.cell(i,j).text = str(i+1) + "*" + str(j+1) + "=" + str((i+1)*(j+1))
table.add_column(Mm(50))
table.cell(0,2).text = "new column"
document.save("o.docx")
```

- ç»“æœ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240429-1714377709751)

- å¯ä»¥æ§åˆ¶ å·²æœ‰æ‰€æœ‰åˆ—çš„å®½åº¦å—ï¼Ÿ

### æ§åˆ¶åˆ—å®½

```
from docx import Document
from docx.shared import Mm
document = Document()
table = document.add_table(2,2)
for i in range(2):
    for j in range(2):
        table.cell(i,j).text = str(i+1) + "*" + str(j+1) + "=" + str((i+1)*(j+1))
        table.columns[j].width = Mm(50)
table.add_column(Mm(50))
table.cell(0,2).text = "new column"
document.save("o.docx")
```

- æ—¢ç„¶åˆ—å¯ä»¥è®¾ç½®å®½åº¦
- è¡Œå¯ä»¥æ§åˆ¶é«˜åº¦å—ï¼Ÿ

### è¡Œé«˜æ§åˆ¶

```
from docx import Document
from docx.shared import Mm
document = Document()
table = document.add_table(2,2)
for i in range(2):
    table.rows[i].height = Mm(10)
    for j in range(2):
        table.cell(i,j).text = str(i+1) + "*" + str(j+1) + "=" + str((i+1)*(j+1))
        table.columns[j].width = Mm(50)
table.add_column(Mm(50))
table.cell(0,2).text = "new column"
table.add_row()
table.rows[2].height = Mm(50)
table.cell(2,0).text = "new row"
document.save("o.docx")
```

- è¡Œé«˜æ§åˆ¶

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240429-1714401266251)

-  å°è¯•ä¿®æ”¹æ ·å¼styles

### ä¿®æ”¹æ ·å¼

```
from docx import Document
document = Document()
table = document.add_table(9,9)
for i in range(9):
    for j in range(9):
        if i >= j:
            table.cell(i,j).text = str(i+1) + "*" + str(j+1) + "=" + str((i+1)*(j+1))
table.style = document.styles["Light Shading"]
document.save("o.docx")
```

- æ•ˆæœ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240307-1709813760893)

- å¯ä»¥æŠŠæ‰€æœ‰çš„æ ·å¼åˆ—å‡ºæ¥å—ï¼Ÿ

### åˆ—å‡ºæ‰€æœ‰çš„æ ·å¼

```
from docx import Document
document = Document()
print(document.styles)
for style in document.styles:
    print(style)
```

- ç»“æœ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240307-1709813821810)

- çœŸçš„æœ‰å¾ˆå¤šæ ·å¼å•Šï¼
- å¯ä»¥æ‰¾åˆ°Light Shadingè¿™ä¸ªæ ·å¼å—ï¼Ÿ

### æ‰¾åˆ°æ ·å¼

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240429-1714402328417)

- å¯ä»¥æ‰¾åˆ° 
	- çœ‹èµ·æ¥åƒæ˜¯ä¸€ä¸ª
	- è¡¨æ ¼æ ·å¼
	- _TableStyle

## æ€»ç»“ğŸ¤”
- æœ€å åˆ¶ä½œäº†ä¹ä¹ä¹˜æ³•è¡¨
	- å¹¶ä¸”ä¸ºè¡¨æ ¼è®¾ç½®äº†è¡¨æ ¼æ ·å¼
- ç‚¹å‡»âš™ï¸é½¿è½®
	- é€‰æ‹©æ ·å¼style

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240308-1709877822757)

- å‘ç°å„ç§æ ·å¼styleå¾ˆå¤š
- æ ·å¼style åˆ°åº•æ€ä¹ˆç©å‘¢ï¼Ÿ
- æˆ‘ä»¬ä¸‹æ¬¡å†è¯´ï¼ğŸ‘‹ğŸ»