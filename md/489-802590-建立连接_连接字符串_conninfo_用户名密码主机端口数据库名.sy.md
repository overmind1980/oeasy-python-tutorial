---
show: step
version: 1.0
enable_checker: true
---

# psycopg3

## å›å¿†

- ä¸Šæ¬¡å®‰è£…äº†
	- postgresæ•°æ®åº“
	- psycopg3 é€‚é…å™¨ 

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221229-1672308400769)

- psycopg3 
	- å¦‚ä½•é€‚é… postgres å‘¢?

### ç›´æ¥psqlè¿æ¥

- æˆ‘ä»¬å…ˆçœ‹çœ‹ å®¢æˆ·ç«¯psql æ˜¯å¦‚ä½•è¿æ¥æ•°æ®åº“çš„

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221229-1672308861162)

- æ„é€ è¿æ¥å­—ç¬¦ä¸²

### å­—ç¬¦ä¸²

```shell
psql -d oeasydb -h localhost -p 5432 -U postgres -W 
```

- å¯†ç ä¸å¯¹
	- éœ€è¦å»pgé‡Œé¢æ”¹å¯†ç 

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221229-1672309154434)

### ä¿®æ”¹å¯†ç 

- å…ˆè¿›å…¥pg

```
ALTER USER 
    postgres 
WITH PASSWORD 
    'oeasypg'
;
```

- ä¿®æ”¹å®Œæˆ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240524-1716536873655)

### å°è¯•ç™»é™†

- ä¿®æ”¹postgreså¯†ç å
	- é€€å‡ºpg
	- å†å°è¯•ç™»å½•

```zsh
psql -d oeasydb -h localhost -p 5432 -U postgres -W 
```

- è¾“å…¥åˆšæ‰ä¿®æ”¹çš„å¯†ç oeasypg
	- æ³¨æ„è¾“å…¥å¯†ç æ—¶
		- ç»ˆç«¯ä¸æ˜¾ç¤ºä»»ä½•å­—ç¬¦

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240524-1716536935267)

- ç¡®å®å¯ä»¥è¿æ¥åˆ°æŒ‡å®šåº“oeasydb
- å°è¯•ç”¨psycopg3

### æŸ¥çœ‹æ–‡æ¡£

- https://www.psycopg.org/psycopg3/docs/basic/usage.html

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221229-1672319733771)

- æœ‰å…³äºconnectå‡½æ•°çš„è¯´æ˜

### connect

- https://www.psycopg.org/psycopg3/docs/api/connections.html#psycopg.Connection

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221229-1672319913490)

- conninfoå¾ˆé‡è¦

### conninfo

- https://www.postgresql.org/docs/current/libpq-connect.html#LIBPQ-CONNSTRING

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221229-1672320149228)

- å°è¯•åšä¸€ä¸ª

### ç…§çŒ«ç”»è™

- å…·ä½“ä»£ç  åŒ…æ‹¬
	- ç”¨æˆ·å
	- å¯†ç 
	- ä¸»æœºåœ°å€
	- ç«¯å£å·
	- æ•°æ®åº“å

```
import psycopg
conninfo = "postgres://postgres:oeasypg@localhost:5432/oeasydb"
with psycopg.connect(conninfo) as conn:
    print("connect!")
```

- ç‚¹å‡»å³ä¸Šè§’å¤åˆ¶æŒ‰é’®å
- é”®å…¥ vi c.py
- ä¾æ¬¡æŒ‰ä¸‹ "*p ä¸‰ä¸ªæŒ‰é”®

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230123-1674441091796)

- è¿è¡Œç»“æœ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221229-1672320357814)

- å¯ä»¥è¿åˆ°åº“é‡Œé¢
	- ç›´æ¥æŸ¥è¯¢å—ï¼Ÿ

### æ€»ç»“

- è¿™æ¬¡ç ”ç©¶äº†psycopgè¿™ä¸ªåŒ…
	- pgæœ€æµè¡Œçš„pythoné€‚é…å™¨
	- æœ‰äº†ä»–å°±å¯ä»¥ç”¨pythonå¯¹æ•°æ®åº“è¯»å†™ï¼

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221229-1672309582787)

- å…·ä½“æ€ä¹ˆè¯»å†™å‘¢ï¼ŸğŸ¤”
- ä¸‹æ¬¡å†è¯´ï¼ğŸ‘‹