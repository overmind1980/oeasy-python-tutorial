---
show: step
version: 1.0
enable_checker: true
---

# è®¾ç½®æ®µè½

## å›å¿†

- ä¸Šæ¬¡äº†è§£äº†
	- é¡µè„šå…ƒç´ 
	- footer
- footer ä¼šå‡ºç°åœ¨ 
	- å½“å‰sectionä¸­
	- æ¯ä¸€é¡µçš„ä¸‹æ–¹
	- ä¸€èˆ¬ç”¨æ¥æ”¾ç½®é¡µç 
- é¡µç  
	- å¯ä»¥æ ‡è®°é¡µæ•°
	- è®© ä¹¦ç±æ›´æœ‰æ•ˆ
- å¯ä»¥é¡µè„šfooteråœ¨ä¸‹é¢
	- ä¸Šé¢ å¯ä»¥æœ‰ ä»€ä¹ˆå…ƒç´ å—ï¼ŸğŸ¤”

### é¡µçœ‰å…ƒç´ 

```
import docx
from docx import Document
from docx.shared import Pt

document = Document() # æ–°å»ºdocxæ–‡æ¡£
section = document.sections[0]
header = section.header
paragraph = header.paragraphs[0]
paragraph.text = "I am header"
document.save('header.docx')
```

- æŸ¥çœ‹æ•ˆæœ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240406-1712395781701)

- åª’ä½“æ·»åŠ åˆ†é¡µç¬¦å
	- éƒ½ä¼šå‡ºç°åœ¨é¡µé¢ä¸Šæ–¹
- é¡µçœ‰ä¸€åŠæ”¾ç‚¹ä»€ä¹ˆå‘¢ï¼Ÿ

### ç« èŠ‚åŸŸ

- å…ˆæŠŠ
	- æ ‡é¢˜åŸŸ
	- Chapter Field
	- æ’å…¥åˆ°æ­£æ–‡

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240406-1712393312597)

- æ ¹æ®å¤§çº²çº§åˆ«(outline lever)çš„ä¸åŒ
	- å¯ä»¥æœ‰ ä¸¤ç§æ ‡é¢˜åŸŸ
	- 1çº§ ç« æ ‡é¢˜ - å¤è¯—ä¸¤é¦–
	- 2çº§ èŠ‚æ ‡é¢˜ - å’é¹…

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240406-1712393482997)

- ç¬¬ä¸€é¡µ 
	- æ²¡æœ‰ èŠ‚æ ‡é¢˜
	- éƒ½æ˜¯ ç« æ ‡é¢˜

- å¯ä»¥æŠŠæ ‡é¢˜
	- æ·»åŠ åœ¨é¡µçœ‰å—ï¼Ÿ

### æ’å…¥é¡µçœ‰

- å°†chapterè¿™ä¸ªåŸŸæ’å…¥æ ‡é¢˜å
	- å†è§£å‹docx
	- å¾—åˆ°header.xml

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240406-1712396694147)

- è¿™ä¸ªç»“æ„ è·Ÿé¡µè„šå¾ˆåƒ
- éƒ½æ˜¯ ç¬¬ä¸€ä¸ªæ®µè½é‡Œ æ’å…¥ä¸€ä¸ªåŸŸ

### ä»£ç å®ç°

```python
import docx
from docx.oxml.ns import qn
from docx.oxml import OxmlElement
from docx import Document
from docx.enum.section import WD_ORIENTATION, WD_SECTION_START
from docx.shared import Pt
from docx.enum.text import WD_PARAGRAPH_ALIGNMENT

document = Document() # æ–°å»ºdocxæ–‡æ¡£
document.add_heading("å¤è¯—ä¸¤é¦–")
section = document.sections[0]
section = document.add_section(start_type=WD_SECTION_START.NEW_PAGE) # æ·»åŠ è¿ç»­çš„èŠ‚
document.add_heading("æ‚¯å†œ",2)
document.add_paragraph("é”„ç¦¾æ—¥å½“åˆ")
document.add_paragraph("æ±—æ»´ç¦¾ä¸‹åœŸ")
document.add_paragraph("è°çŸ¥ç›˜ä¸­é¤")
document.add_paragraph("ç²’ç²’çš†è¾›è‹¦")
section = document.add_section(start_type=WD_SECTION_START.NEW_PAGE) # æ·»åŠ è¿ç»­çš„èŠ‚
document.add_heading("å’é¹…",2)
document.add_paragraph("é¹…é¹…é¹…")
document.add_paragraph("æ›²é¡¹å‘å¤©æ­Œ")
document.add_paragraph("ç™½æ¯›æµ®ç»¿æ°´")
document.add_paragraph("çº¢æŒæ‹¨æ¸…æ³¢")
for section in document.sections:
    heading = ""
    for paragraph in section.iter_inner_content():
        if paragraph.style.name == "Heading 1":
            heading = paragraph.text
            break
    header = section.header
    paragraph = header.paragraphs[0]
    paragraph.alignment = WD_PARAGRAPH_ALIGNMENT.CENTER  # è®¾ç½®å±…ä¸­å¯¹é½
    run2 = paragraph.add_run('')
    fldChar2 = OxmlElement('w:fldChar')
    fldChar2.set(qn('w:fldCharType'), 'begin')
    run2._element.append(fldChar2)
    run3 = paragraph.add_run('')
    fldChar3 = OxmlElement('w:instrText')
    fldChar3.text = r'STYLEREF 1 \* MERGEFORMAT'
    run3._element.append(fldChar3)
    run4 = paragraph.add_run('')
    fldChar4 = OxmlElement('w:fldChar')
    fldChar4.set(qn('w:fldCharType'), 'separate')
    run4._element.append(fldChar4)
    run5 = paragraph.add_run(heading)
    run6 = paragraph.add_run('')
    fldChar5 = OxmlElement('w:fldChar')
    fldChar5.set(qn('w:fldCharType'), 'end')
    run6._element.append(fldChar5)
footer = section.footer
paragraph = footer.paragraphs[0]
paragraph.alignment = WD_PARAGRAPH_ALIGNMENT.CENTER  # è®¾ç½®å±…ä¸­å¯¹é½
run2 = paragraph.add_run('')
fldChar2 = OxmlElement('w:fldChar')
fldChar2.set(qn('w:fldCharType'), 'begin')
run2._element.append(fldChar2)
run3 = paragraph.add_run('')
fldChar3 = OxmlElement('w:instrText')
fldChar3.text = 'PAGE'
run3._element.append(fldChar3)
run4 = paragraph.add_run('')
fldChar4 = OxmlElement('w:fldChar')
fldChar4.set(qn('w:fldCharType'), 'separate')
run4._element.append(fldChar4)
run5 = paragraph.add_run('')
fldChar5 = OxmlElement('w:fldChar')
fldChar5.set(qn('w:fldCharType'), 'end')
run5._element.append(fldChar5)
document.save('oeasy.docx')
```

### ç”Ÿæˆæ•ˆæœ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240406-1712397974069)

- é¡µçœ‰éƒ¨åˆ† æ’å…¥äº† åŸŸ

### ç”Ÿæˆç›®å½•

- èœå• Insert- Table of Contents and Index
	- æ’å…¥ è¡¨æ ¼å†…å®¹å’Œç´¢å¼•

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240406-1712376935495)

- é€‰æ‹© æ ¹æ®ç´¢å¼•ç”Ÿæˆç›®å½•

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240406-1712376994117)

### ç»“æœ

- å¯ä»¥ç”Ÿæˆ ç›®å½•
	- è¿˜å¯ä»¥ç‚¹å‡»é¡µç è·³è½¬

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240406-1712377024776)

## æ€»ç»“ğŸ¤”
- è¿™æ¬¡æˆ‘ä»¬ç ”ç©¶çš„æ˜¯
	- é¡µçœ‰ header
- é¡µçœ‰
	- ä½äºé¡µé¢çš„ä¸Šæ–¹
	- æ¯ä¸ªé¡µé¢ éƒ½ä¼šå‡ºç°é¡µçœ‰
- é¡µçœ‰ã€é¡µè„š
	- éƒ½éš¶å±äº section
	- ä¸åŒçš„sectionå¯ä»¥è®¾ç½® 
	- ä¸åŒé¡µçœ‰é¡µè„š
- docxè¿˜å¯ä»¥ 
	- åšäº›ä»€ä¹ˆå‘¢ï¼ŸğŸ¤”
- æˆ‘ä»¬ä¸‹æ¬¡å†è¯´ï¼ğŸ‘‹ğŸ»