---
show: step
version: 1.0
enable_checker: true
---

# è®¾ç½®æ®µè½

## å›å¿†

- ä¸Šæ¬¡ç ”ç©¶äº†å‘æ–‡æ¡£æ·»åŠ å¯¹è±¡çš„æ–¹æ³•
	- add_paragraph
	- add_heading
	- add_page_break
- å¹¶ä¸”ç†è§£äº†æ ¼å¼çš„ä½œç”¨
	- æ ‡é¢˜ä¸€
	- æ ‡é¢˜äºŒ
	- æ­£æ–‡
- å¦‚ä½•é€šè¿‡pythonè®¾ç½®å­—ä½“æ ¼å¼å‘¢ï¼Ÿ

### æ„é€ åŸºç¡€

```
from docx import Document
document = Document()
document.add_paragraph("oeasy")
document.save("o.docx")
```

- å¾—åˆ°æ–‡æ¡£å
	- æ‰“å¼€ å¹¶ä¿®æ”¹

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240321-1710992249572)

- å°†oçš„å­—ä½“å¤§å°æ”¹æˆ28
	- ç„¶åä¿å­˜

### å†æ¬¡æ‰“å¼€

- å°è¯•ç”¨pythonæ‰“å¼€

```
from docx import Document
document = Document("o.docx")
for paragraph in document.paragraphs:
	print(paragraph.text)
```

- å¯æ˜¯
	- çœ‹ä¸å‡ºä»€ä¹ˆç»†èŠ‚

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240321-1710992360101)

- ç°åœ¨åº”è¯¥æ·±å…¥paragraph

### æ·±å…¥pragraph

- :!python3 
	- è¿›å…¥æ¸¸ä¹åœº

```
from docx import Document
document = Document("o.docx")
p = document.paragraphs[0]
print(p)
```

- æ‰¾åˆ°è¿™ä¸ªparagraph

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240321-1710992592177)

- p.
	- æŒ‰ä¸‹ <kbd>tab</kbd>

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240321-1710992688574)

- å‘ç° runs

### è§‚å¯Ÿruns

```
print(p.runs)
```

- runsæ˜¯ä¸€ä¸ªåˆ—è¡¨
	- é‡Œé¢æœ‰ä¸¤ä¸ªå…ƒç´ ï¼ï¼ï¼

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240321-1710992759540)

- runsé‡Œé¢æœ‰ä»€ä¹ˆå‘¢ï¼Ÿ

```
r = p.runs[0]
```

- p.
	- æŒ‰ä¸‹ <kbd>tab</kbd>
	- æ²¡æœ‰æç¤º
- runæ˜¯ä»€ä¹ˆç±»å‹çš„å‘¢ï¼Ÿ

### è§‚å¯Ÿrun

```
type(paragraph.runs[0])
import docx
help(docx.text.run.Run)
```

- æŸ¥çœ‹æ•ˆæœ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240310-1710039503280)

- æœ‰ä»€ä¹ˆ æˆå‘˜å‡½æ•°å’Œå±æ€§ å‘¢ï¼Ÿ

### æŸ¥çœ‹å‡½æ•°

- å¯ä»¥æ·»åŠ å„ç§å¯¹è±¡
	- åˆ†éš”ç¬¦
	- å›¾ç‰‡
	- åˆ¶è¡¨ç¬¦
	- æ–‡å­—

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240310-1710039776500)

- å…·ä½“è¿˜æœ‰ä»€ä¹ˆå±æ€§å‘¢ï¼Ÿ

### æŸ¥çœ‹æ›´å¤š

- å„ç§å±æ€§
	- æ–œä½“
	- æ ·å¼
	- æ–‡æœ¬
	- ä¸‹åˆ’çº¿

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240310-1710039823329)

- è¿™ä¸ªrunçš„textç©¶ç«Ÿæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ

### éå†runs

```
for run in p.runs:
	print(run.text)
```

- ç»“æœ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240321-1710993182938)

- é€‰ä¸­å­—æ¯oå 
	- ä¿®æ”¹å­—ä½“å¤§å°
	- å°†ä¸€ä¸ªæ®µè½åˆ†æˆä¸¤æ®µ
	- æ˜¯ä¸æ˜¯è¿™æ ·å‘¢ï¼Ÿ

### ç¨‹åºåˆ¤æ–­

- é€€å‡ºæ¸¸ä¹åœº
	- å›åˆ°vim

```
from docx import Document
document = Document()
paragraph = document.add_paragraph("oeasy")
print(len(paragraph.runs))
```

- ç»“æœä¸º1

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240321-1710993293355)

- ç»“æœéªŒè¯äº†åˆ¤æ–­
	- é€‰æ‹©æ–‡å­— ä¿®æ”¹å­—ä½“å¤§å°
	- å°†paragraphä¸­çš„
	- runs ä¸­çš„å…ƒç´ 
	- ä» 1ä¸ª å˜ 2ä¸ª

### æ®µè½çš„æ„æˆ

```
from docx import Document
document = Document()
paragraph = document.add_paragraph("oeasy")
print(paragraph.runs)
paragraph.add_run("o2z")
print(paragraph.runs[0].text)
print(paragraph.runs[1].text)
print(paragraph.text)
```

- è¿è¡Œç»“æœ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240310-1710040906401)

- Documentæ–‡æ¡£ æ˜¯ é¡¶çº§å…ƒç´ 
	- æ–‡æ¡£ä¸­åŒ…å«ç€ Paragraphæ®µè½
		- Paragraphæ®µè½ ä¸­åŒ…å«ç€ runæ–‡æœ¬
- å¯ä»¥å†™è¿›docxæ–‡ä»¶ä¸­è§‚å¯Ÿå—ï¼Ÿ

### å†™å…¥æ–‡ä»¶

```
from docx import Document
document = Document()
paragraph = document.add_paragraph("oeasy")
print(paragraph.runs)
paragraph.add_run("o2z")
print(paragraph.runs[0].text)
print(paragraph.runs[1].text)
print(paragraph.text)
document.save("o.docx")
```

- æ•´ä½“ä¸Š æ˜¯ 
	- ä¸€æ®µæ–‡å­—
	- 1 Paragraph

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240310-1710041102443)

- å®é™…ä¸Š
	- åˆ†åˆ«å±äº
	- ä¸¤ä¸ªä¸åŒçš„run
- ä¸åŒçš„run
	- å¯ä»¥æœ‰ä¸åŒçš„å­—ä½“å’Œå¤§å°
- è¯•è¯• è¿›è¡Œè®¾ç½®

### è®¾ç½® ç²—ä½“ å’Œ æ–œä½“

```
from docx import Document
document = Document()
paragraph = document.add_paragraph("oeasy")
run = paragraph.add_run("o2z")
run.bold = True
run.italic = True
document.save("o.docx")
```

- è®¾ç½®ç²—ä½“å’Œæ–œä½“

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240313-1710335759727)

- bold å’Œ italic éƒ½æ˜¯ run çš„ä¸‰å€¼å±æ€§
	- True
	- False
	- None

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240313-1710336114390)

- å¯ä»¥è®¾ç½®æ›´å¤šæ ¼å¼å—ï¼Ÿ

### ç»§ç»­æŸ¥æ‰¾å¸®åŠ©

```
import docx
help(docx.text.run.Run)
```

- æ‰¾åˆ°ä¸€ä¸ªå±æ€§
	- ä¸‹åˆ’çº¿
	- underline

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240321-1711008497971)

- è¿™ä¸ªå±æ€§ å¯ä»¥æœ‰å››ç§å€¼
	- True
	- False
	- None
	- WdUnderline
- å…ˆè¯•è¯•True

### è¯•è¯•ä¸‹åˆ’çº¿

```
from docx import Document
document = Document()
paragraph = document.add_paragraph("oeasy")
run = paragraph.add_run("o2z")
run.underline = True
document.save("o.docx")
```

- ç¡®å®æœ‰äº†ä¸‹åˆ’çº¿

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240321-1711008904948)

### æœç´¢

- å»å®˜ç½‘æœç´¢underline
	- https://python-docx.readthedocs.io/en/latest/api/enum/WdUnderline.html#wdunderline

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240321-1711009133368)

- å’Œwordä¸­çš„ç±»å‹æ˜¯ä¸€è‡´çš„

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240321-1711009361097)

- è¯•è¯• WAVY_DOUBLE
- ä¿å­˜æ–‡ä»¶

### ä¸‹åˆ’çº¿æ ·å¼

```
from docx import Document
document = Document("o.docx")
p = document.paragragp[0]
r = p.run[0]
print(r.underline)
help(r.underline)
```

- æŸ¥çœ‹ç±»å‹

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240321-1711009948379)

### è§‚å¯Ÿæ¥æº

- https://learn.microsoft.com/zh-cn/office/vba/api/Word.WdUnderline

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240321-1711010107424)

- æˆ‘å¦‚ä½•ä½¿ç”¨pythonæ¥è¿›è¡Œè®¾å®šå‘¢ï¼Ÿ

### è¿½æ ¹æº¯æº

- åœ¨æ¸¸ä¹åœº

```
import docx
docx.enum
```

- ç”¨ <kbd>tab</kbd> 
	- è§‚å¯Ÿ ç»†èŠ‚

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240321-1711010911046)

- WD_UNDERLINE
	- å±äº docx.enum.textè¿™ä¸ªmodule

### ç¼–å†™ç¨‹åº

```
from docx import Document
from docx.enum.text import WD_UNDERLINE
document = Document()
paragraph = document.add_paragraph("oeasy")
run = paragraph.add_run("o2z")
run.underline = WD_UNDERLINE.DOTTED
document.save("o.docx")
```

- ä¸‹åˆ’çº¿

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240321-1711011381262)

- ç¡®å®è®¾ç½®äº†ç‚¹åˆ’çº¿



## æ€»ç»“

- è¿™æ¬¡äº†è§£äº†wordæ–‡ä»¶çš„ç»“æ„
	1. é¡¶çº§å…ƒç´  ä¸º æ–‡æ¡£(document)
	2. æ–‡æ¡£(document) ä¸‹é¢ä¸º æ®µè½(paragraph)
	3. æ®µè½(paragraph) ä¸‹é¢ä¸º è¡Œå†…æ–‡å­—(run)

- run æœ‰ä¸€äº›å±æ€§
	- åŠ ç²— Bold
	- åŠ æ–œ Italic
	- ä¸‹åˆ’çº¿ underline
	- å…¶ä¸­ä¸‹åˆ’çº¿ å¯é€‰æ‹©ç±»å‹
- è¿˜å¯ä»¥å¾€documenté‡Œé¢addä¸€äº›ä»€ä¹ˆå‘¢ï¼ŸğŸ¤”
- æˆ‘ä»¬ä¸‹æ¬¡å†è¯´ï¼ğŸ‘‹ğŸ»
