---
show: step
version: 1.0
enable_checker: true
---

# è¯­æ³• html ç”Ÿæˆ

## å›å¿†

- æŠŠå‰é¢çš„ requests å’Œæœ€è¿‘çš„ etree ç»“åˆäº†
  - é€šè¿‡ request è·å¾—ç½‘é¡µçš„ response
  - etree é€šè¿‡ HTML å‡½æ•°æŠŠä»–è½¬åŒ–ä¸ºä¸€æ£µ etree æ ‘

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221127-1669521450717)

- æµç¨‹è·‘èµ·æ¥äº†
- ä½†æ˜¯å…ƒç´ ç­›é€‰æœ‰ç‚¹éº»çƒ¦
- æœ‰ä»€ä¹ˆå¿«é€Ÿç­›é€‰å…ƒç´ çš„æ–¹æ³•å—ï¼ŸğŸ¤”

### æœç´¢

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210902-1630547071875)

- ç‚¹å‡»ç¬¬ä¸€ä¸ªå¼€å§‹ç ”ç©¶

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210902-1630547145505)

- xpath 
	- æ˜¯ w3c åˆ¶å®šçš„æ ‡å‡†
	- æ˜¯ xslt æ ‡å‡†çš„ä¸»è¦å…ƒç´ 

### è·¯å¾„è¡¨è¾¾å¼

| è¡¨è¾¾å¼ | æè¿° | 
|--- |--- |
| . | é€‰å–å½“å‰èŠ‚ç‚¹ |
|  / | ä»æ ¹èŠ‚ç‚¹é€‰å– æˆ– è¡¨ç¤ºå±‚çº§å…³ç³» |
| nodename | åœ¨å½“å‰ä½ç½®é€‰æ‹©æ­¤ç±»èŠ‚ç‚¹ | 
| // | åœ¨ä»»æ„æ›¾è®°å¾—å­å­™è·¯å¾„ä¸‹ |
| .. | é€‰å–å½“å‰èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ | 
| @ | é€‰å–å±æ€§ |


![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210902-1630547289914)

- è¿™äº›ä¸œè¥¿æ€ä¹ˆç†è§£å‘¢ï¼Ÿ
- å…·ä½“æ¥çœ‹çœ‹

### æ“ä½œ

- dom æ ‘å¦‚ä¸‹

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221127-1669525619191)

- æˆ‘ä»¬æ¥è¯•ä¸€ä¸‹å„ç§è·¯å¾„è¡¨è¾¾å¼

### nodename

```
import requests
from lxml import etree
response = requests.get("http://localhost")
b_html = response.content
et_html = etree.HTML(b_html)
et_element = et_html.xpath(".")
print(et_element)
```

- . ä¸ºå½“å‰èŠ‚ç‚¹
- è¾“å‡ºä¸ºhtmlå…ƒç´ çš„åˆ—è¡¨
- htmlä¸‹é¢æœ‰ä»€ä¹ˆå‘¢ï¼Ÿ

### è¾“å‡º

- å½“å‰èŠ‚ç‚¹ä¸ºhtml
	- ä¸‹é¢æœ‰head

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221127-1669526063986)

- å¯ä»¥è¾“å‡º

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221127-1669526080303)

### å±‚çº§å…³ç³»

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221127-1669526234839)

- å¯ä»¥è¾“å‡ºpå…ƒç´ åˆ—è¡¨

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221127-1669526259394)

###  å†å‘ä¸‹ä¸€å±‚

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221127-1669526419016)

- æ‰¾åˆ° a å…ƒç´ åˆ—è¡¨

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221127-1669526455954)

### ä»»æ„å±‚çº§ä¸‹

- ä»»æ„å±‚çº§ä¸‹çš„emå…ƒç´ 

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221127-1669526539230)

- å¯ä»¥æ‰¾åˆ°

### å½“å‰èŠ‚ç‚¹

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221127-1669527130581)

- å½“å‰èŠ‚ç‚¹
	- .

### å‘ä¸Šä¸€å±‚

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221127-1669526663256)

- å‘ä¸Šä¸€å±‚	
	- ..

- ä»€ä¹ˆéƒ½è¾“å‡ºä¸å‡º
- å…·ä½“å®é™…æ˜¯æ€ä¹ˆç”¨xpathçš„å‘¢ï¼Ÿ

### é€šè¿‡æµè§ˆå™¨

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221127-1669527325250)

- å³é”®å†…å®¹æ£€æŸ¥å…ƒç´ 

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221127-1669527339987)

- åœ¨å…ƒç´ æŸ¥çœ‹ç•Œé¢å³é”®å¤åˆ¶-xpath
- å°†è¯¥å…ƒç´ çš„xpathå¤åˆ¶åˆ°å‰ªè´´æ¿

### ä½¿ç”¨xpath

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221127-1669527474403)

- /html/body/p[1]
	- /html
		- æ ¹ä¸‹çš„htmlä¸‹
	- /body
		- htmlä¸‹çš„bodyä¸‹
	- /p[1]
		- body ä¸‹çš„ ç¬¬1ä¸ª p å…ƒç´ 
		- æ³¨æ„è¿™é‡Œå¹¶ä¸æ˜¯ä»0å¼€å§‹
		- è€Œæ˜¯ä»1å¼€å§‹

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221127-1669527566939)

- å¯ä»¥æ‰¾åˆ°è¿™ä¸ªå…ƒç´ 

## æ€»ç»“

- è¿™æ¬¡æ·±å…¥äº† xpath
- xpath å¯ä»¥ç”¨æ¥ç­›é€‰ xml æ–‡ä»¶ä¸­çš„èŠ‚ç‚¹
- xpath æœ‰ä¸€å¥—è‡ªå·±çš„è¯­æ³•

| ç¬¦å· | ä½œç”¨ |
|--- |--- |
| . | é€‰å–å½“å‰èŠ‚ç‚¹ |
|  / | ä»æ ¹èŠ‚ç‚¹é€‰å– æˆ– è¡¨ç¤ºå±‚çº§å…³ç³» |
| nodename | åœ¨å½“å‰ä½ç½®é€‰æ‹©æ­¤ç±»èŠ‚ç‚¹ | 
| // | åœ¨ä»»æ„å±‚çº§è·¯å¾„ä¸‹ |
| .. | é€‰å–å½“å‰èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ | 
| @ | é€‰å–å±æ€§ |

- è¿™ä¸ª@é€‰å±æ€§æˆ‘ä»¬è¿˜æ²¡æœ‰è¯•è¯•
- æ€ä¹ˆç”¨å‘¢ï¼ŸğŸ¤”
- ä¸‹æ¬¡å†è¯´ğŸ‘‹
