---
show: step
version: 1.0
enable_checker: true
---

# åˆ—è¡¨ - æ·±æ‹·è´ deepcopy

## å›å¿†

- ä¸Šæ¬¡æˆ‘ä»¬äº†è§£äº†åˆ—è¡¨çš„åµŒå¥—(embedded)
	- åˆ—è¡¨é¡¹ä¹Ÿå¯ä»¥æ˜¯åˆ—è¡¨
	- å¯ä»¥æ— é™åµŒå¥—ä¸‹å»

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221129-1669708577034)

- èµ‹å€¼å’Œæ‹·è´çš„æ—¶å€™éœ€è¦æ³¨æ„äº›ä»€ä¹ˆå‘¢ï¼Ÿï¼ŸğŸ¤”

### ç›´æ¥èµ‹å€¼

```python3
a = 5
print(a)
```

- è¿è¡Œç»“æœ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20231230-1703902381939)

- å¦‚æœç›´æ¥
	- print(a = 5) å‘¢ï¼Ÿ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20231230-1703902418279)

### :=

```
print(a:=5)
```

- è¿è¡Œç»“æœ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20231230-1703902480902)

- := æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿ

### æµ·è±¹è¿ç®—ç¬¦

- := çœ‹èµ·æ¥å¾ˆåƒæµ·è±¹
	- ä¹Ÿå«æµ·è±¹è¿ç®—ç¬¦
	- æ˜¯python3.8ä¹‹åçš„ç‰¹æ€§

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20231230-1703902503309)

- æµ·è±¹è¿ç®—ç¬¦çš„ä½œç”¨æ˜¯èµ‹å€¼
	- å†å°†èµ‹å€¼ç»“æœä½œä¸ºæ•´ä¸ªè¿ç®—ç¬¦çš„è¿”å›å€¼
- åˆ—è¡¨ä¹Ÿå¯ä»¥ç”¨æµ·è±¹è¿ç®—ç¬¦å—ï¼Ÿ

### æµ·è±¹

```python3 
print(l := [1, 2, 3])
```

- ç»“æœ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20231230-1703902787654)

- åˆ—è¡¨ä¹Ÿå¯ä»¥ä½¿ç”¨æµ·è±¡è¿ç®—ç¬¦
- åˆ—è¡¨åœ¨èµ‹å€¼çš„æ—¶å€™å’Œæ•´å½¢æ•°å­—æœ‰ä»€ä¹ˆåŒºåˆ«å—ï¼Ÿ

### ç´¢å¼•åµŒå¥—å…ƒç´ 

- https://pythontutor.com/visualize.html#mode=edit

```python3
l1 = ["oeasy",[165,70]]
l2 = l1
l1[0] = "o2z"
print(l2)
l2[0] = "o3z"
print(l1)
```

- è¿è¡Œç»“æœ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20231205-1701783726639)

- è¿™ä¸¤ä¸ªåˆ—è¡¨ä¸­çš„åå­—
	- ä¸€æ”¹å…¨æ”¹

- èƒ½å¦ç”¨ åˆ—è¡¨çš„copyæ–¹æ³• ä»£æ›¿ç›´æ¥èµ‹å€¼ å‘¢ï¼Ÿ

### copy()

- ä½¿ç”¨copyæ–¹æ³•

```
l1 = ["oeasy",[165,70]]
l2 = l1.copy()
l1[0] = "o2z"
print(l2)
l2[0] = "o3z"
print(l1)
```

- åå­—å´æ˜¯èƒ½å¤Ÿç‹¬ç«‹ä¿®æ”¹äº†

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20231205-1701784441172)

- ä½†æ˜¯èº«é«˜ä½“é‡çœ‹èµ·æ¥è¿˜æ˜¯æŒ‡å‘åŒä¸€ä¸ªåœ°å€
- ä¼šæœ‰ä»€ä¹ˆåæœå—ï¼Ÿ

### å¤šç»´åˆ—è¡¨

- æ‹·è´ åªèƒ½ è®©åˆ—è¡¨ä¸­ ç›´æ¥åˆ—è¡¨é¡¹
	- æ‰¾åœ°å€ é‡æ–° æ„å»º

```
l1 = ["oeasy",[165,70]]
l2 = l1.copy()
l1[1][0] = 190
print(l2)
l2[1][1] = 180
print(l1)
```

- åˆ—è¡¨ä¸­çš„åˆ—è¡¨è¿˜æ˜¯æŒ‡å‘åŒä¸€ä¸ªåœ°å€
- è¿™ä¼šå¯¼è‡´ä»€ä¹ˆé—®é¢˜å‘¢ï¼Ÿ

### é—®é¢˜

- åˆ—è¡¨ä¸­çš„åˆ—è¡¨ä¸€æ”¹å…¨æ”¹

```
l1 = ["oeasy",[165,70]]
l2 = l1.copy()
l1[1].append(20)
print(l2)
l2[1].remove(70)
print(l1)
```

- æ·±å¤„çš„åˆ—è¡¨æ ¹æœ¬åˆ†ä¸å¼€
- ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿ

### id

- ä¸è®ºæ˜¯l1è¿˜æ˜¯l2
	- ç¬¬äºŒä¸ªå…ƒç´ éƒ½æ˜¯åˆ—è¡¨
	- ç¬¬äºŒä¸ªå…ƒç´ çš„ä½ç½®å­˜å‚¨çš„æ˜¯åˆ—è¡¨çš„åœ°å€

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20231205-1701784964511)

```
l1 = ["oeasy",[165,70]]
l2 = l1.copy()
l1[1].append(20)
print(id(l2[1]))
l2[1].remove(70)
print(id(l1[1]))
```

- è§‚å¯Ÿåœ°å€ç¡®å®æ˜¯ä¸€ä¸ªä½ç½®
- è¿™ä¸ªé—®é¢˜è§£å†³ä¸äº†å—ï¼Ÿ

### é€ä¸ªæ’å…¥

- éå†l1ä¸­æ‰€æœ‰å…ƒç´ 
	- å¦‚æœä¸æ˜¯åˆ—è¡¨ 
		- å°±ç›´æ¥è¿½åŠ appendåˆ°æ–°åˆ—è¡¨
	- å¦‚æœæ˜¯åˆ—è¡¨
		- å°±è¿½åŠ å…ƒç´ çš„æ‹·è´copyåˆ°æ–°åˆ—è¡¨

```
l1 = ["oeasy",[165,70]]
l2 = []
for item in l1:
    if type(item) != list:
        l2.append(item)
    if type(item) == list:
        l2.append(item.copy())
l1[1].append(20)
print(id(l2[1]))
l2[1].remove(70)
print(id(l1[1]))
```

- ç»“æœ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20231205-1701785653867)

- ç¡®å®å¯ä»¥å½»åº•åˆ†å¼€åˆ†å¼€

- ä¸è¿‡è¿™ä¹Ÿä»…ä»…é™äºäºŒç»´åˆ—è¡¨çš„æƒ…å†µ
- ä¸‰ç»´åˆ—è¡¨ ä¼šå¦‚ä½•å‘¢ï¼Ÿ

### ä¸‰ç»´åˆ—è¡¨

```
l1 = [["oeasy",[165,70]],["o2z",[170,100]]]
l2 = []
for item in l1:
    if type(item) != list:
        l2.append(item)
    if type(item) == list:
        l2.append(item.copy())
l1[0][1][0] = 150
```

- ç›´æ¥éå†è§£å†³ä¸äº†æœ€æ·±çš„é‚£ä¸€å±‚

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20231205-1701785949757)

- è¿˜éœ€è¦æ›´æ·±å±‚æ¬¡çš„éå†

### æ€»ç»“

- èµ‹å€¼çš„æ—¶å€™æ³¨æ„æœ‰ä¸¤ç§æƒ…å†µ
  - = 
	- ç›´æ¥å¤åˆ¶å˜é‡å¼•ç”¨çš„åœ°å€
  - æ‹·è´ 
	- æ–°å»ºåˆ—è¡¨
	- å¤åˆ¶åˆ—è¡¨é¡¹çš„å¼•ç”¨åœ°å€	
	- ä½†å¦‚æœåˆ—è¡¨é¡¹æ˜¯åˆ—è¡¨
		- å°±åŸæ ·å¤åˆ¶åˆ—è¡¨åœ°å€
		- ä¸€æ”¹å…¨æ”¹

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221129-1669730371125)

- å¯ä»¥åšä¸€ä¸ªçœŸæ­£äº’ä¸å½±å“çš„å‰¯æœ¬å—ï¼Ÿ
	- æ— è®ºåˆ—è¡¨ç»´åº¦å¦‚ä½•
	- éƒ½ä¸äº’ç›¸å½±å“
- ä¸‹æ¬¡å†è¯´ ğŸ‘‹