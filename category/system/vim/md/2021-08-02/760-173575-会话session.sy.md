---
show: step
version: 1.0
enable_checker: true
---

# æ˜ å°„map

## å›å¿†ç»„åˆé”®æ˜ å°„çš„ç»†èŠ‚

- è¿™æ¬¡æˆ‘ä»¬å®šä¹‰äº†ä¸€ç³»åˆ—çš„å¤åˆé”®
- ä¸»è¦æ˜¯å’ŒCtrlé”®ä¸€èµ·
- å¿«é€Ÿè·³è½¬windowçª—å£
	- `map <C-j> <C-W>j`
	- `map <C-k> <C-W>k`
	- `map <C-h> <C-W>h`
	- `map <C-l> <C-W>l`
- å¿«é€Ÿè·³è½¬tabé€‰é¡¹å¡
	- `map <C-LEFT> :tabn`
	- `map <C-RIGHT> :tabp`
- è¿˜å¯ä»¥æµæ°´ä½œä¸š
	- `map <C-s> :s/5.1/5.2/<CR>:wnext<CR>`
- æœ€åè¦æ³¨æ„æ³¨é‡Šè¯´æ˜çš„å°ç»†èŠ‚
	- `:unmap a|"unmap a`
- ç»„åˆé”®å’ŒåŠŸèƒ½é”®Fnä¸€æ ·ï¼Œéƒ½å¯ä»¥åšå„ç§æ˜ å°„map
- æ˜ å°„mapå’Œç¼©å†™abbreviateå’ŒæŠ˜å ã€æœ¬åœ°optionsä¸€æ ·
- éƒ½å¯ä»¥é€šè¿‡`:mkview`ã€`:loadview`æ¥ä¿å­˜è¯»å–
- ä½†æ˜¯å¦‚æœæˆ‘çš„ç¯å¢ƒé‡Œé¢æœ‰tabé€‰é¡¹å¡
- tabé€‰é¡¹å¡é‡Œé¢è¿˜æœ‰å„ç§åˆ‡åˆ†å¥½çš„å„ä¸ªçª—å£
- ä¸€è§‰é†’æ¥è¿˜å¾—é‡æ–°åˆ‡åˆ†
- è¿˜å¾—é‡æ–°`:tabnew`
- sshæ–­å¼€äº†å°±å•¥éƒ½æ²¡æœ‰ï¼Œå…¨é‡æ¥ï¼Ÿï¼Ÿï¼Ÿ
- æˆ‘æƒ³æŠŠè¿™ä¸ªçŠ¶æ€æ•´ä¸ªå­˜å‚¨èµ·æ¥
- å¯èƒ½ä¹ˆï¼ŸğŸ¤”

### å¯»æ‰¾è¿‡ç¨‹
- å¦‚æœæœ‰è¿™ä¸ªåŠŸèƒ½çš„è¯
- ä¸€å®šæ˜¯åœ¨`:mkview`é™„è¿‘
- æˆ‘ä»¬å…ˆå»ç°åœºè½¬è½¬
- `:h mkview`

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210726-1627259063917)

- viewé‡Œé¢çš„å¯ä»¥åŒ…æ‹¬
	- å‚æ•°åˆ—è¡¨`:args`
	- å½“å‰æ–‡ä»¶
	- `viewoptions`
		- æ˜ å°„ map
		- ç¼©å†™ abbreivate
		- options
	- æŠ˜å 
	- æ»šåŠ¨ä½ç½®å’Œå…‰æ ‡ä½ç½®
	- å½“å‰æ–‡ä»¶å¤¹
- å’Œ`viewoption`ç›¸å…³çš„æœ‰ä¸€ä¸ª`sessionoptions`
-  <C-]> è¿›å»çœ‹çœ‹

### `sessionoptions`ä¼šè¯é€‰é¡¹

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210726-1627259362755)

- è¿™ä¸ªä¼šè¯`session`å°±åŒ…æ‹¬ä¸‹åˆ—é€‰é¡¹options
	- blnak ç©ºç™½çª—å£
	- buffers æ‰€æœ‰ç¼“å­˜
	- curdir å½“å‰ç›®å½•
	- folds æŠ˜å 
	- globals å…¨å±€å˜é‡
	- localoptions æœ¬åœ°é€‰é¡¹
- è¿˜å®¶ä¼™ï¼Œè¿™ä¸åŸºæœ¬å°±æŠŠ`:mkview`çš„æ´»å„¿éƒ½å¹²äº†ä¹ˆ
- åªè¦`sessionoptions`æœ‰ä»¥ä¸Šè¿™äº›`:mksession`å°±å¯ä»¥å®Œæˆ`:mkview`çš„å·¥ä½œ
- é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰

### `sessionoptions`ä¼šè¯é€‰é¡¹
- å¯ä»¥ç»™sessionoptionsæ·»åŠ æ›´å¤šé€‰é¡¹
	- `:set sessionoptions+=resize`
- options æ‰€æœ‰çš„é€‰é¡¹optionå’Œæ˜ å°„map
- resize çª—å£çš„è¡Œå’Œåˆ—
- sesdir sessionä¼šè¯æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•
	- è¿™ä¸ªæ–‡ä»¶å¤¹ä¼šæˆä¸ºå½“å‰ç›®å½•curdir
	- å¦‚æœsesdirã€curdiréƒ½æ²¡æœ‰çš„è¯ï¼Œä¼šä½¿ç”¨ç»å¯¹è·¯å¾„absolute path
- slashã€unix æ–‡ä»¶åé‡Œé¢çš„åæ–œæ ä¼šå˜æˆæ–œæ ï¼Œåœ¨ä»windowsåˆ°unixlikeæœ‰ç”¨
- tabpages é€‰é¡¹å¡é¡µé¢
- terminal ç»ˆç«¯å­˜å‚¨çš„å‘½ä»¤
- winposã€winsize çª—å£windowçš„å¤§å°å’Œä½ç½®

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210726-1627259525384)

- è¿™å•¥éƒ½æœ‰äº†
- ä»tabsåˆ°window
- å®Œå…¨æ»¡è¶³éœ€æ±‚

### ä¿å­˜ä¼šè¯`:mksession`

- `:mksession` ä¿å­˜ä¼šè¯
- å­˜åˆ°å“ªé‡Œäº†å‘¢ï¼Ÿ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210726-1627260565153)

- `:echo this_session`
- å›ç­”æ˜¯ä¿å­˜åœ¨äº†å½“å‰ç›®å½•
- å«åš`session.vim`
- è¿™ä¸ªå°±å¾ˆåƒåœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¿å­˜äº†ä¸€ä¸ªå·¥ä½œåŒº
- æˆ‘ä»¬å»çœ‹çœ‹è¿™ä¸ªä¸œè¥¿æ˜¯ä»€ä¹ˆï¼Ÿ

### ä¼šè¯å†…å®¹Session

```
   git clone http://github.com/overmind1980/vimtutorial.git`
   vi -o oeasy.java oeasy.css oeasy.html
```

- ç„¶åå†å»ºç«‹ä¸€äº›tabs
- `:mks[ession]`


![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210726-1627261579850)

- å¯ä»¥çœ‹åˆ°è¿™ä¸ªåœ¨SessionOptioné‡Œé¢çš„
	- tab
	- window
	- buffers
	- å…¨éƒ½æœ‰
- æ€»å…±1000+è¡Œ
- æŠŠå½“å‰çš„çŠ¶æ€å…¨ä¿å­˜èµ·æ¥äº†
- æƒ³æ¢å¤çš„æ—¶å€™åªè¦
	- `:so[urce] session.vim`
	- å°±éƒ½æ¢å¤äº†

### åˆ‡æ¢é¡¹ç›®å·¥ä½œåŒº

- ç„¶åæŠŠå¤vimtutoråˆ¶å‡ºæ¥å«oeasy
	- vimtutorialæ˜¯æˆ‘ä»¬ä¸æƒ³åšçš„ä»»åŠ¡
	- oeasyæ˜¯æˆ‘ä»¬æƒ³åšçš„ä»»åŠ¡
- å¯ä»¥å»ºç«‹ä¸¤ä¸ªsession

```
   cd ..
   cp vimtutorial oeasy
   cd oeasy
   vi -o oeasy.java oeasy.css oeasy.html
```

- ç„¶åå†åŠ ä¸Šä¸€äº›tabé€‰é¡¹å¡ä¹‹ç±»
- å†`:mksession`
- è¿™æ¬¡åœ¨oeasyè¿™ä¸ªå·¥ç¨‹æ–‡ä»¶å¤¹åº•ä¸‹å»ºç«‹äº†`Session.vim`
- æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™ä¸¤ä¸ªé¡¹ç›®
- å„æœ‰å„çš„å·¥ç¨‹æ–‡ä»¶
- ä¹Ÿå°±æ˜¯å„æœ‰å„çš„è“å¸ƒæ£‰é—¨å¸˜
- ç”šè‡³å¯ä»¥æŠŠè¿™ä¸ªå·¥ä½œåŒºçŠ¶æ€åˆ†äº«åˆ°ç½‘ä¸Š
- åˆ«äººå°±ç”¨ä½ çš„å¸ƒå±€æ–¹å¼æ‰“å¼€è¿™ä¸ªå·¥ç¨‹
	- `vim -S Session.vim`
	- æˆ–è€…è¿›å…¥vimå
	- `:source Session.vim`
- ä¹Ÿå¯ä»¥ç»™åŒä¸€ä¸ªå·¥ç¨‹åˆ¶ä½œä¸åŒæ–¹é¢çš„åˆ‡é¢ä¼šè¯

### é¡¹ç›®å·¥ä½œåŒºæ–‡ä»¶å¤¹`./sessions`

- `:mks ~/sessions/oeasy.session` 
	- å¯ä»¥åœ¨æŒ‡å®šä½ç½®`~/session`ä¸‹å»ºç«‹å·¥ç¨‹ç›®å½•
	- æ‰€æœ‰çš„å·¥ç¨‹æ–‡ä»¶éƒ½å­˜åœ¨å·¥ç¨‹ç›®å½•é‡Œ
		- `~/sessions/oeasy.session` 
		- `~/sessions/o2z.session` 
		- `~/sessions/o3z.session` 
	- è¿™æ ·çš„è¯æˆ‘å¯ä»¥ç›´æ¥å»å·¥ç¨‹ç›®å½•é‡Œé¢æ‰¾å·¥ç¨‹
		- `ls ~/sessions/`
		- `vim -S ~/sessions/oeasy.session`
- ä¼˜ç‚¹
	- å·¥ç¨‹é›†ä¸­ç®¡ç†
	- é¿å…å‡ºç°åœ¨å·¥ç¨‹ç›®å½•é‡Œé¢
	- å¯èƒ½è¿›å…¥git
		- å½“ç„¶ç”¨.gitignoreå¯è§£å†³è¿™ä¸ªé—®é¢˜
- ç¼ºç‚¹
	- åˆ é™¤ä¸€ä¸ªå·¥ç¨‹è¦åœ¨ä¸¤ä¸ªåœ°æ–¹åˆ é™¤
	- å·¥ç¨‹ç¨‹åºç´ æå’Œå·¥ç¨‹å·¥ä½œåŒºä¸åœ¨ä¸€èµ·å¤åˆ¶ç²˜è´´éº»çƒ¦

### åŠŸèƒ½é”®æ˜ å°„

- æˆ‘æƒ³è®©<kbd>F2</kbd>èƒ½æ‰§è¡Œ`:mksession`çš„ä»»åŠ¡
	- `:map <F2> :mks<CR>`
- æˆ‘æƒ³å…ˆä¿å­˜æ–‡ä»¶å†ä¿å­˜å·¥ä½œåŒº
	- `:map <F2> :wa<Bar>exe "mksession!"`
- æˆ‘æƒ³å…ˆä¿å­˜æ–‡ä»¶å†ä¿å­˜å·¥ä½œåŒºåˆ°å½“å‰sessionæ–‡ä»¶
	- `:map <F2> :wa<Bar>exe "mksession! " . v:this_session<CR>`

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210726-1627264878773)


- æƒ³è¦åŠ è½½sessionçš„æ—¶å€™
	- `:map <F3> :source ~/oeasy/oeasy.vim<CR>`

- å½“<kbd>F2</kbd>çš„æ—¶å€™ï¼Œè¿™ä¼šè¯sessionå°±è¢«ä¿å­˜ä½äº†
- è€Œè¿™ä¸¤ä¸ªæ˜ å°„ä¹Ÿå°±ä¿å­˜åˆ°äº†è¿™ä¸ªsessioné‡Œé¢

### viewå’Œsession

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210725-1627209002514)

- å…ˆåæ¬¡åº
	- vimè‚¯å®šæ˜¯å…ˆæœ‰çš„`:mkview` ä¿å­˜çª—å£è§†å›¾
	- åæœ‰çš„`:mksession` ä¿å­˜æ•´ä¸ªç»˜ç”»
	- è¿™è¯´æ˜vimåŠŸèƒ½å˜çš„æ›´å¼ºå¤§ï¼Œæ›´é€‚åˆå¤šçº¿ç¨‹å¹¶å‘çš„ç¯å¢ƒ
- ä¸¤è€…å…³ç³»
	- å•tabé€‰é¡¹å¡å•windowçª—å£çš„å·¥ç¨‹å¯ä»¥ç”¨`:mkview`
	- å¤štabé€‰é¡¹å¡å¤šwindowçª—å£çš„å·¥ç¨‹æœ€å¥½ç”¨`:mksession`
	- `:mksession`å¯æ›¿ä»£`:mkview`
- ä¸è¿‡æœ€åä¸€æ®µä»–è¯´
	- `view` å’Œ `session`éƒ½æ˜¯`viminfo`çš„æœ‰ç›Šè¡¥å……ï¼Ÿï¼Ÿï¼
	- å‡ ä¸ªæ„æ€ï¼Ÿ
- æˆ‘ä»¬è¿˜æ˜¯å…ˆæ€»ç»“ä¸€ä¸‹Session

## æ€»ç»“

- è¿™æ¬¡æˆ‘ä»¬å®šä¹‰äº†`session`
	- `:mks`
- è¿˜å¯ä»¥åŠ è½½ä¼šè¯`session`
	- `:source Session.vim`
	- `vim -S Session.vim`
- åŸºæœ¬ä¸Šç¡®ç«‹`:mks`å¯ä»¥æ›¿ä»£`:mkview`
- è°çŸ¥åˆå‡ºæ¥ä¸€ä¸ª`viminfo`
- ä¸Šé¢è¿™å“¥ä¿©å„¿éƒ½æˆäº†æœ‰ç›Šè¡¥å……ï¼Ÿ
- ä»€ä¹ˆæƒ…å†µï¼ŸğŸ¤”
- ä¸‹æ¬¡å†è¯´ï¼





